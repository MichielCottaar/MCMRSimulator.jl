<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · MCMRSimulator.jl</title><meta name="title" content="API · MCMRSimulator.jl"/><meta property="og:title" content="API · MCMRSimulator.jl"/><meta property="twitter:title" content="API · MCMRSimulator.jl"/><meta name="description" content="Documentation for MCMRSimulator.jl: a Monte Carlo MRI simulator in Julia"/><meta property="og:description" content="Documentation for MCMRSimulator.jl: a Monte Carlo MRI simulator in Julia"/><meta property="twitter:description" content="Documentation for MCMRSimulator.jl: a Monte Carlo MRI simulator in Julia"/><meta property="og:url" content="https://open.win.ox.ac.uk/pages/ndcn0236/mcmrsimulator.jl/stable/api/"/><meta property="twitter:url" content="https://open.win.ox.ac.uk/pages/ndcn0236/mcmrsimulator.jl/stable/api/"/><link rel="canonical" href="https://open.win.ox.ac.uk/pages/ndcn0236/mcmrsimulator.jl/stable/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MCMRSimulator.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../tutorial_julia/">Tutorial (Julia)</a></li><li><a class="tocitem" href="../tutorial_cli/">Tutorial (CLI)</a></li><li><a class="tocitem" href="../geometry/">Geometry</a></li><li><a class="tocitem" href="../properties/">MRI/collision properties</a></li><li class="is-active"><a class="tocitem" href>API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl" title="View the repository"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">Repository</span></a><a class="docs-navbar-link" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/main/docs/src/api.md" title="Edit source"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="api"><a class="docs-heading-anchor" href="#api">MCMRSimulator.jl API</a><a id="api-1"></a><a class="docs-heading-anchor-permalink" href="#api" title="Permalink"></a></h1><p>This is the API for <a href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl">MCMRSimulator</a>. For a more user-friendly introduction, click <a href="../#Introduction">here</a>.</p><ul><li><a href="#MCMRSimulator.CLI"><code>MCMRSimulator.CLI</code></a></li><li><a href="#MCMRSimulator.CLI.Geometry"><code>MCMRSimulator.CLI.Geometry</code></a></li><li><a href="#MCMRSimulator.CLI.Run"><code>MCMRSimulator.CLI.Run</code></a></li><li><a href="#MCMRSimulator.Evolve"><code>MCMRSimulator.Evolve</code></a></li><li><a href="#MCMRSimulator.Geometries"><code>MCMRSimulator.Geometries</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal"><code>MCMRSimulator.Geometries.Internal</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups"><code>MCMRSimulator.Geometries.Internal.FixedObstructionGroups</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions"><code>MCMRSimulator.Geometries.Internal.Obstructions</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections"><code>MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Properties"><code>MCMRSimulator.Geometries.Internal.Properties</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.RayGridIntersection"><code>MCMRSimulator.Geometries.Internal.RayGridIntersection</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Reflections"><code>MCMRSimulator.Geometries.Internal.Reflections</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Base</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Triangle"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Triangle</code></a></li><li><a href="#MCMRSimulator.Geometries.User"><code>MCMRSimulator.Geometries.User</code></a></li><li><a href="#MCMRSimulator.Geometries.User.JSON"><code>MCMRSimulator.Geometries.User.JSON</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes"><code>MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes</code></a></li><li><a href="#MCMRSimulator.Geometries.User.SplitMesh"><code>MCMRSimulator.Geometries.User.SplitMesh</code></a></li><li><a href="#MCMRSimulator.Geometries.User.ToMesh"><code>MCMRSimulator.Geometries.User.ToMesh</code></a></li><li><a href="#MCMRSimulator.MCMRSimulator"><code>MCMRSimulator.MCMRSimulator</code></a></li><li><a href="#MCMRSimulator.Methods"><code>MCMRSimulator.Methods</code></a></li><li><a href="#MCMRSimulator.Plot"><code>MCMRSimulator.Plot</code></a></li><li><a href="#MCMRSimulator.Properties"><code>MCMRSimulator.Properties</code></a></li><li><a href="#MCMRSimulator.Spins"><code>MCMRSimulator.Spins</code></a></li><li><a href="#MCMRSimulator.Subsets"><code>MCMRSimulator.Subsets</code></a></li><li><a href="#MCMRSimulator.Constants.gyromagnetic_ratio"><code>MCMRSimulator.Constants.gyromagnetic_ratio</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.empty_obstruction_intersections"><code>MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.empty_obstruction_intersections</code></a></li><li><a href="#MCMRSimulator.Evolve.FillerAccumulator"><code>MCMRSimulator.Evolve.FillerAccumulator</code></a></li><li><a href="#MCMRSimulator.Evolve.GridAccumulator"><code>MCMRSimulator.Evolve.GridAccumulator</code></a></li><li><a href="#MCMRSimulator.Evolve.ReadoutAccumulator"><code>MCMRSimulator.Evolve.ReadoutAccumulator</code></a></li><li><a href="#MCMRSimulator.Evolve.SnapshotAccumulator"><code>MCMRSimulator.Evolve.SnapshotAccumulator</code></a></li><li><a href="#MCMRSimulator.Evolve.TotalSignalAccumulator"><code>MCMRSimulator.Evolve.TotalSignalAccumulator</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox-Union{Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}}, Tuple{N}} where N"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup"><code>MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.HitGrids.HitGrid"><code>MCMRSimulator.Geometries.Internal.HitGrids.HitGrid</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.HitGrids.HitGridNoRepeat"><code>MCMRSimulator.Geometries.Internal.HitGrids.HitGridNoRepeat</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.HitGrids.HitGridRepeat"><code>MCMRSimulator.Geometries.Internal.HitGrids.HitGridRepeat</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.ObstructionIntersection"><code>MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.ObstructionIntersection</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.Shifts.Shift"><code>MCMRSimulator.Geometries.Internal.Obstructions.Shifts.Shift</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Properties.MRIProperties"><code>MCMRSimulator.Geometries.Internal.Properties.MRIProperties</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Reflections.Reflection-Tuple{Any}"><code>MCMRSimulator.Geometries.Internal.Reflections.Reflection</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Reflections.Reflection"><code>MCMRSimulator.Geometries.Internal.Reflections.Reflection</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Annulus.AnnulusSusceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Annulus.AnnulusSusceptibility</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base.BaseSusceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Base.BaseSusceptibility</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Cylinder.CylinderSusceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Cylinder.CylinderSusceptibility</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.AnisotropicSusceptibilityGridElement"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.AnisotropicSusceptibilityGridElement</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.FixedSusceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.FixedSusceptibility</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.IsotropicSusceptibilityGridElement"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.IsotropicSusceptibilityGridElement</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGrid"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGrid</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridElement"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridElement</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridNoRepeat"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridNoRepeat</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridRepeat"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridRepeat</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.AnisotropicTriangleSusceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.AnisotropicTriangleSusceptibility</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.IsotropicTriangleSusceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.IsotropicTriangleSusceptibility</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.TriangleSusceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.TriangleSusceptibility</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Obstructions.Annuli"><code>MCMRSimulator.Geometries.User.Obstructions.Annuli</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Obstructions.BendyCylinder"><code>MCMRSimulator.Geometries.User.Obstructions.BendyCylinder</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Obstructions.BendyCylinder-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.IndexedObstruction{:Cylinders}}"><code>MCMRSimulator.Geometries.User.Obstructions.BendyCylinder</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Obstructions.Cylinders"><code>MCMRSimulator.Geometries.User.Obstructions.Cylinders</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Obstructions.Fields.Field"><code>MCMRSimulator.Geometries.User.Obstructions.Fields.Field</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Obstructions.Fields.FieldValue"><code>MCMRSimulator.Geometries.User.Obstructions.Fields.FieldValue</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Obstructions.Mesh-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:BendyCylinder}}"><code>MCMRSimulator.Geometries.User.Obstructions.Mesh</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Obstructions.Mesh"><code>MCMRSimulator.Geometries.User.Obstructions.Mesh</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes.ObstructionType"><code>MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes.ObstructionType</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Obstructions.Spheres"><code>MCMRSimulator.Geometries.User.Obstructions.Spheres</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Obstructions.Walls"><code>MCMRSimulator.Geometries.User.Obstructions.Walls</code></a></li><li><a href="#MCMRSimulator.Plot.PlotPlane"><code>MCMRSimulator.Plot.PlotPlane</code></a></li><li><a href="#MCMRSimulator.Properties.GlobalProperties"><code>MCMRSimulator.Properties.GlobalProperties</code></a></li><li><a href="#MCMRSimulator.SequenceParts.ConstantPulse"><code>MCMRSimulator.SequenceParts.ConstantPulse</code></a></li><li><a href="#MCMRSimulator.SequenceParts.IndexedReadout"><code>MCMRSimulator.SequenceParts.IndexedReadout</code></a></li><li><a href="#MCMRSimulator.SequenceParts.InstantSequencePart"><code>MCMRSimulator.SequenceParts.InstantSequencePart</code></a></li><li><a href="#MCMRSimulator.SequenceParts.MultSequencePart"><code>MCMRSimulator.SequenceParts.MultSequencePart</code></a></li><li><a href="#MCMRSimulator.SequenceParts.SequencePart"><code>MCMRSimulator.SequenceParts.SequencePart</code></a></li><li><a href="#MCMRSimulator.Simulations.Simulation"><code>MCMRSimulator.Simulations.Simulation</code></a></li><li><a href="#MCMRSimulator.Spins.FixedXoshiro"><code>MCMRSimulator.Spins.FixedXoshiro</code></a></li><li><a href="#MCMRSimulator.Spins.Snapshot"><code>MCMRSimulator.Spins.Snapshot</code></a></li><li><a href="#MCMRSimulator.Spins.Spin"><code>MCMRSimulator.Spins.Spin</code></a></li><li><a href="#MCMRSimulator.Spins.SpinOrientation"><code>MCMRSimulator.Spins.SpinOrientation</code></a></li><li><a href="#MCMRSimulator.Spins.SpinOrientationSum"><code>MCMRSimulator.Spins.SpinOrientationSum</code></a></li><li><a href="#MCMRSimulator.Subsets.Subset"><code>MCMRSimulator.Subsets.Subset</code></a></li><li><a href="#MCMRSimulator.TimeSteps.TimeStep"><code>MCMRSimulator.TimeSteps.TimeStep</code></a></li><li><a href="#MCMRSimulator.CLI.Geometry.get_parser-Tuple{}"><code>MCMRSimulator.CLI.Geometry.get_parser</code></a></li><li><a href="#MCMRSimulator.CLI.Geometry.parse_user_argument-Tuple{Any, Any}"><code>MCMRSimulator.CLI.Geometry.parse_user_argument</code></a></li><li><a href="#MCMRSimulator.CLI.Geometry.run_main"><code>MCMRSimulator.CLI.Geometry.run_main</code></a></li><li><a href="#MCMRSimulator.CLI.Run.add_init_flags!-Tuple{Any}"><code>MCMRSimulator.CLI.Run.add_init_flags!</code></a></li><li><a href="#MCMRSimulator.CLI.Run.add_output_flags!-Tuple{Any}"><code>MCMRSimulator.CLI.Run.add_output_flags!</code></a></li><li><a href="#MCMRSimulator.CLI.Run.add_readout_flags!-Tuple{Any}"><code>MCMRSimulator.CLI.Run.add_readout_flags!</code></a></li><li><a href="#MCMRSimulator.CLI.Run.add_simulation_definition!-Tuple{Any}"><code>MCMRSimulator.CLI.Run.add_simulation_definition!</code></a></li><li><a href="#MCMRSimulator.CLI.Run.get_parser-Tuple{}"><code>MCMRSimulator.CLI.Run.get_parser</code></a></li><li><a href="#MCMRSimulator.CLI.Run.read_bvecs-Tuple{Any}"><code>MCMRSimulator.CLI.Run.read_bvecs</code></a></li><li><a href="#MCMRSimulator.CLI.Run.run_main"><code>MCMRSimulator.CLI.Run.run_main</code></a></li><li><a href="#MCMRSimulator.CLI.install_cli-Tuple{}"><code>MCMRSimulator.CLI.install_cli</code></a></li><li><a href="#MCMRSimulator.CLI.run_main"><code>MCMRSimulator.CLI.run_main</code></a></li><li><a href="#MCMRSimulator.CLI.run_main_docs-Tuple{AbstractString}"><code>MCMRSimulator.CLI.run_main_docs</code></a></li><li><a href="#MCMRSimulator.CLI.run_main_test-Tuple{AbstractString}"><code>MCMRSimulator.CLI.run_main_test</code></a></li><li><a href="#MCMRSimulator.Evolve.apply_instants!-Union{Tuple{N}, Tuple{Array{Spin{N}, 1}, MCMRSimulator.SequenceParts.InstantSequencePart{N, T, ST} where {T, ST&lt;:StaticArraysCore.StaticArray{Tuple{N}, T, 1}}, MCMRSimulator.Evolve.GridAccumulator}} where N"><code>MCMRSimulator.Evolve.apply_instants!</code></a></li><li><a href="#MCMRSimulator.Evolve.draw_step!-Union{Tuple{N}, Tuple{Array{Spin{N}, 1}, Simulation{N, NG} where NG, MCMRSimulator.SequenceParts.MultSequencePart{N, T, ST} where {T&lt;:MCMRSimulator.SequenceParts.SequencePart, ST&lt;:StaticArraysCore.StaticArray{Tuple{N}, T, 1}}, StaticArraysCore.StaticArray{Tuple{N}, Float64, 1}}} where N"><code>MCMRSimulator.Evolve.draw_step!</code></a></li><li><a href="#MCMRSimulator.Evolve.evolve-Union{Tuple{N}, Tuple{Any, Simulation{N, NG} where NG, Any}} where N"><code>MCMRSimulator.Evolve.evolve</code></a></li><li><a href="#MCMRSimulator.Evolve.fix_accumulator-Tuple{MCMRSimulator.Evolve.GridAccumulator}"><code>MCMRSimulator.Evolve.fix_accumulator</code></a></li><li><a href="#MCMRSimulator.Evolve.fix_accumulator-Tuple{MCMRSimulator.Evolve.TotalSignalAccumulator}"><code>MCMRSimulator.Evolve.fix_accumulator</code></a></li><li><a href="#MCMRSimulator.Evolve.has_nwrite-Tuple{MCMRSimulator.Evolve.SingleAccumulator, Int64}"><code>MCMRSimulator.Evolve.has_nwrite</code></a></li><li><a href="#MCMRSimulator.Evolve.readout"><code>MCMRSimulator.Evolve.readout</code></a></li><li><a href="#MCMRSimulator.Evolve.readout!-Tuple{MCMRSimulator.Evolve.TotalSignalAccumulator, Vector{Spin{1}}}"><code>MCMRSimulator.Evolve.readout!</code></a></li><li><a href="#MCMRSimulator.Evolve.readout!-Union{Tuple{N}, Tuple{MCMRSimulator.Evolve.GridAccumulator, Array{Spin{N}, 1}, Int64, MCMRSimulator.SequenceParts.IndexedReadout}} where N"><code>MCMRSimulator.Evolve.readout!</code></a></li><li><a href="#MCMRSimulator.Evolve.run_readout!-Union{Tuple{N}, Tuple{Snapshot{N}, Simulation{N, NG} where NG, MCMRSimulator.Evolve.GridAccumulator, Val}} where N"><code>MCMRSimulator.Evolve.run_readout!</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.could_intersect-Tuple{BoundingBox{1}, AbstractVector, AbstractVector}"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.could_intersect</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N}, StaticArraysCore.SVector{N, Float64}, Int32, Bool, NamedTuple}} where N"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside-Tuple{Any, AbstractVector}"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, AbstractVector, Vararg{Any}}} where N"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.detect_intersection-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup{N, R, O, G} where {R&lt;:Union{Nothing, StaticArraysCore.SVector{N, Float64}}, O&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, G&lt;:MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N, O}}, StaticArraysCore.SVector{3}, StaticArraysCore.SVector{3}}, Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup{N, R, O, G} where {R&lt;:Union{Nothing, StaticArraysCore.SVector{N, Float64}}, O&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, G&lt;:MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N, O}}, StaticArraysCore.SVector{3}, StaticArraysCore.SVector{3}, Tuple{Int64, Int64, Bool}}} where N"><code>MCMRSimulator.Geometries.Internal.FixedObstructionGroups.detect_intersection</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.prepare_isinside!-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup}"><code>MCMRSimulator.Geometries.Internal.FixedObstructionGroups.prepare_isinside!</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.HitGrids.detect_intersection_grid-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N}, StaticArraysCore.SVector{N, Float64}, StaticArraysCore.SVector{N, Float64}, Int32, Bool, NamedTuple}} where N"><code>MCMRSimulator.Geometries.Internal.HitGrids.detect_intersection_grid</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.HitGrids.find_hits-Union{Tuple{N}, Tuple{BoundingBox{N}, Any, Any, Any}} where N"><code>MCMRSimulator.Geometries.Internal.HitGrids.find_hits</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.HitGrids.obstructions-Union{Tuple{MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N, O}}, Tuple{O}, Tuple{N}} where {N, O}"><code>MCMRSimulator.Geometries.Internal.HitGrids.obstructions</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.detect_intersection-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, StaticArraysCore.SVector{N}, StaticArraysCore.SVector{N}, NamedTuple, Union{Nothing, Bool}}} where N"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.detect_intersection</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.has_inside"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.has_inside</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.obstruction_type-Union{Tuple{Type{O}}, Tuple{O}} where O&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.obstruction_type</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.radius"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.radius</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.random_surface_positions-Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction, NamedTuple, Number}"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.random_surface_positions</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.random_surface_positions-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup{N, R, O, G} where {R&lt;:Union{Nothing, StaticArraysCore.SVector{N, Float64}}, O&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, G&lt;:MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N, O}}, BoundingBox{3}, Number}} where N"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.random_surface_positions</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.size_scale-Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction}"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.size_scale</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.has_intersection-Tuple{MCMRSimulator.Geometries.Internal.Reflections.Reflection}"><code>MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.has_intersection</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.has_intersection-Tuple{MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.ObstructionIntersection}"><code>MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.has_intersection</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.Triangles.curvature-NTuple{4, Any}"><code>MCMRSimulator.Geometries.Internal.Obstructions.Triangles.curvature</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.Triangles.detect_intersection_partial-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.Triangles.FullTriangle, StaticArraysCore.SVector{N}, StaticArraysCore.SVector{N}}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.Triangles.FullTriangle, StaticArraysCore.SVector{N}, StaticArraysCore.SVector{N}, Any}} where N"><code>MCMRSimulator.Geometries.Internal.Obstructions.Triangles.detect_intersection_partial</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.Triangles.neighbours-Tuple{AbstractVector}"><code>MCMRSimulator.Geometries.Internal.Obstructions.Triangles.neighbours</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.Triangles.normal-Tuple{AbstractVector, AbstractVector, AbstractVector}"><code>MCMRSimulator.Geometries.Internal.Obstructions.Triangles.normal</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.Triangles.triangle_size-Tuple{MCMRSimulator.Geometries.Internal.Obstructions.Triangles.FullTriangle}"><code>MCMRSimulator.Geometries.Internal.Obstructions.Triangles.triangle_size</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Properties.dwell_time-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup, Int64}"><code>MCMRSimulator.Geometries.Internal.Properties.dwell_time</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Properties.max_permeability_non_inf-Tuple{NTuple{N, MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup} where N}"><code>MCMRSimulator.Geometries.Internal.Properties.max_permeability_non_inf</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Properties.max_surface_relaxation-Tuple{NTuple{N, MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup} where N}"><code>MCMRSimulator.Geometries.Internal.Properties.max_surface_relaxation</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Properties.max_timestep_sticking-Tuple{NTuple{N, MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup} where N, Number, Any}"><code>MCMRSimulator.Geometries.Internal.Properties.max_timestep_sticking</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Properties.min_dwell_time-Tuple{NTuple{N, MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup} where N}"><code>MCMRSimulator.Geometries.Internal.Properties.min_dwell_time</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Properties.permeability-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup, Int64}"><code>MCMRSimulator.Geometries.Internal.Properties.permeability</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Properties.surface_density-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup, Int64}"><code>MCMRSimulator.Geometries.Internal.Properties.surface_density</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Properties.surface_relaxation-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup, Int64}"><code>MCMRSimulator.Geometries.Internal.Properties.surface_relaxation</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.RayGridIntersection.ray_grid_intersections-Union{Tuple{N}, Tuple{StaticArraysCore.SVector{N, Float64}, StaticArraysCore.SVector{N, Float64}}} where N"><code>MCMRSimulator.Geometries.Internal.RayGridIntersection.ray_grid_intersections</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Reflections.direction-Tuple{MCMRSimulator.Geometries.Internal.Reflections.Reflection, Any, Any}"><code>MCMRSimulator.Geometries.Internal.Reflections.direction</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Reflections.has_hit-Tuple{MCMRSimulator.Geometries.Internal.Reflections.Reflection}"><code>MCMRSimulator.Geometries.Internal.Reflections.has_hit</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Reflections.previous_hit-Tuple{MCMRSimulator.Geometries.Internal.Reflections.Reflection}"><code>MCMRSimulator.Geometries.Internal.Reflections.previous_hit</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility-Tuple{MCMRSimulator.Geometries.Internal.Susceptibility.Annulus.AnnulusSusceptibility, AbstractVector, Number, Union{Nothing, Bool}, StaticArraysCore.SVector{2, Float64}}"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility-Tuple{MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.TriangleSusceptibility, AbstractVector, Number, Union{Nothing, Bool}, StaticArraysCore.SVector{3, Float64}}"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility-Tuple{MCMRSimulator.Geometries.Internal.Susceptibility.Cylinder.CylinderSusceptibility, AbstractVector, Number, Union{Nothing, Bool}, StaticArraysCore.SVector{2, Float64}}"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility_gradient"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility_gradient</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.dipole_approximation-Tuple{Float64, StaticArraysCore.SVector{3, Float64}, Float64, StaticArraysCore.SVector{3, Float64}}"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.dipole_approximation</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.element_susceptibility-Tuple{MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridElement, Int32, MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGrid, AbstractVector, Union{Nothing, Bool}}"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.element_susceptibility</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.off_resonance_gradient-Tuple{MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGrid, Any}"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.off_resonance_gradient</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.susceptibility_off_resonance"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.susceptibility_off_resonance</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.susceptibility_off_resonance-Tuple{Simulation, Spin}"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.susceptibility_off_resonance</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.right_angle_triangle_field-Tuple{Number, Number, Number}"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.right_angle_triangle_field</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Fix.apply_properties-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup, Vector{&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction}, Int64, Int64}"><code>MCMRSimulator.Geometries.User.Fix.apply_properties</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Fix.fix-Tuple{AbstractVector}"><code>MCMRSimulator.Geometries.User.Fix.fix</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Fix.fix_type"><code>MCMRSimulator.Geometries.User.Fix.fix_type</code></a></li><li><a href="#MCMRSimulator.Geometries.User.FixSusceptibility.fix_susceptibility-Tuple{AbstractVector}"><code>MCMRSimulator.Geometries.User.FixSusceptibility.fix_susceptibility</code></a></li><li><a href="#MCMRSimulator.Geometries.User.JSON.read_geometry-Tuple{IO}"><code>MCMRSimulator.Geometries.User.JSON.read_geometry</code></a></li><li><a href="#MCMRSimulator.Geometries.User.JSON.write_geometry-Tuple{Any}"><code>MCMRSimulator.Geometries.User.JSON.write_geometry</code></a></li><li><a href="#MCMRSimulator.Geometries.User.LoadMesh.load_mesh-Tuple{IO}"><code>MCMRSimulator.Geometries.User.LoadMesh.load_mesh</code></a></li><li><a href="#MCMRSimulator.Geometries.User.LoadMesh.ply_from_mesh-Tuple{Any}"><code>MCMRSimulator.Geometries.User.LoadMesh.ply_from_mesh</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Obstructions.Fields.convert_value-Union{Tuple{T}, Tuple{Type{T}, Any}} where T"><code>MCMRSimulator.Geometries.User.Obstructions.Fields.convert_value</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.nvolumes-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup}"><code>MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.nvolumes</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes.key_value_pairs"><code>MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes.key_value_pairs</code></a></li><li><a href="#MCMRSimulator.Geometries.User.RandomDistribution.random_positions_radii-Tuple{Any, Real, Int64}"><code>MCMRSimulator.Geometries.User.RandomDistribution.random_positions_radii</code></a></li><li><a href="#MCMRSimulator.Geometries.User.SizeScales.size_scale-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup}"><code>MCMRSimulator.Geometries.User.SizeScales.size_scale</code></a></li><li><a href="#MCMRSimulator.Geometries.User.SplitMesh.components-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:Mesh}}"><code>MCMRSimulator.Geometries.User.SplitMesh.components</code></a></li><li><a href="#MCMRSimulator.Geometries.User.SplitMesh.connected_indices-Tuple{AbstractVector}"><code>MCMRSimulator.Geometries.User.SplitMesh.connected_indices</code></a></li><li><a href="#MCMRSimulator.Geometries.User.SplitMesh.connectivity_matrix-Tuple{Any}"><code>MCMRSimulator.Geometries.User.SplitMesh.connectivity_matrix</code></a></li><li><a href="#MCMRSimulator.Geometries.User.SplitMesh.fix_mesh-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:Mesh}}"><code>MCMRSimulator.Geometries.User.SplitMesh.fix_mesh</code></a></li><li><a href="#MCMRSimulator.Geometries.User.SplitMesh.make_normals_consistent!-Tuple{AbstractVector}"><code>MCMRSimulator.Geometries.User.SplitMesh.make_normals_consistent!</code></a></li><li><a href="#MCMRSimulator.Geometries.User.ToMesh.icosahedron-Tuple{}"><code>MCMRSimulator.Geometries.User.ToMesh.icosahedron</code></a></li><li><a href="#MCMRSimulator.Methods.B0"><code>MCMRSimulator.Methods.B0</code></a></li><li><a href="#MCMRSimulator.Methods.get_rotation-Tuple{Rotations.Rotation, Int64}"><code>MCMRSimulator.Methods.get_rotation</code></a></li><li><a href="#MCMRSimulator.Methods.get_time"><code>MCMRSimulator.Methods.get_time</code></a></li><li><a href="#MCMRSimulator.Methods.norm_angle-Tuple{Any}"><code>MCMRSimulator.Methods.norm_angle</code></a></li><li><a href="#MCMRSimulator.Methods.phase"><code>MCMRSimulator.Methods.phase</code></a></li><li><a href="#MCMRSimulator.Plot.plot_geometry-Tuple"><code>MCMRSimulator.Plot.plot_geometry</code></a></li><li><a href="#MCMRSimulator.Plot.plot_off_resonance-Tuple"><code>MCMRSimulator.Plot.plot_off_resonance</code></a></li><li><a href="#MCMRSimulator.Plot.plot_sequence-Tuple"><code>MCMRSimulator.Plot.plot_sequence</code></a></li><li><a href="#MCMRSimulator.Plot.plot_snapshot-Tuple"><code>MCMRSimulator.Plot.plot_snapshot</code></a></li><li><a href="#MCMRSimulator.Plot.plot_trajectory-Tuple"><code>MCMRSimulator.Plot.plot_trajectory</code></a></li><li><a href="#MCMRSimulator.Plot.project_on_grid-Tuple{PlotPlane, Snapshot{1}, Int64}"><code>MCMRSimulator.Plot.project_on_grid</code></a></li><li><a href="#MCMRSimulator.Plot.simulator_movie"><code>MCMRSimulator.Plot.simulator_movie</code></a></li><li><a href="#MCMRSimulator.Properties.R1"><code>MCMRSimulator.Properties.R1</code></a></li><li><a href="#MCMRSimulator.Properties.R2"><code>MCMRSimulator.Properties.R2</code></a></li><li><a href="#MCMRSimulator.Properties.off_resonance"><code>MCMRSimulator.Properties.off_resonance</code></a></li><li><a href="#MCMRSimulator.Properties.stick_probability-NTuple{4, Number}"><code>MCMRSimulator.Properties.stick_probability</code></a></li><li><a href="#MCMRSimulator.Relax.relax!-Union{Tuple{N}, Tuple{Spin{N}, Union{Nothing, Bool, StaticArraysCore.SVector{3, Float64}}, Simulation{N, NG} where NG, MCMRSimulator.SequenceParts.MultSequencePart{N, T, ST} where {T&lt;:MCMRSimulator.SequenceParts.SequencePart, ST&lt;:StaticArraysCore.StaticArray{Tuple{N}, T, 1}}, Float64, Float64, StaticArraysCore.StaticArray{Tuple{N}, Float64, 1}}} where N"><code>MCMRSimulator.Relax.relax!</code></a></li><li><a href="#MCMRSimulator.SequenceParts.get_readouts-Tuple{MRIBuilder.Containers.BaseSequences.BaseSequence, Number}"><code>MCMRSimulator.SequenceParts.get_readouts</code></a></li><li><a href="#MCMRSimulator.Spins.get_sequence-Tuple{Spin, Any}"><code>MCMRSimulator.Spins.get_sequence</code></a></li><li><a href="#MCMRSimulator.Spins.longitudinal"><code>MCMRSimulator.Spins.longitudinal</code></a></li><li><a href="#MCMRSimulator.Spins.orientation"><code>MCMRSimulator.Spins.orientation</code></a></li><li><a href="#MCMRSimulator.Spins.position-Tuple{Snapshot}"><code>MCMRSimulator.Spins.position</code></a></li><li><a href="#MCMRSimulator.Spins.position-Tuple{Spin}"><code>MCMRSimulator.Spins.position</code></a></li><li><a href="#MCMRSimulator.Spins.stuck-Tuple{Spin}"><code>MCMRSimulator.Spins.stuck</code></a></li><li><a href="#MCMRSimulator.Spins.stuck_to-Tuple{Spin}"><code>MCMRSimulator.Spins.stuck_to</code></a></li><li><a href="#MCMRSimulator.Spins.stuck_to-Tuple{Spin, Any}"><code>MCMRSimulator.Spins.stuck_to</code></a></li><li><a href="#MCMRSimulator.Spins.transverse"><code>MCMRSimulator.Spins.transverse</code></a></li><li><a href="#MCMRSimulator.Subsets.get_subset-Tuple{AbstractVector{&lt;:Spin}, Vararg{Any}}"><code>MCMRSimulator.Subsets.get_subset</code></a></li><li><a href="#MCMRSimulator.TimeSteps.max_timestep_permeability-Tuple{Any, Any}"><code>MCMRSimulator.TimeSteps.max_timestep_permeability</code></a></li><li><a href="#MCMRSimulator.TimeSteps.max_timestep_surface_relaxation-Tuple{Any, Any}"><code>MCMRSimulator.TimeSteps.max_timestep_surface_relaxation</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.MCMRSimulator" href="#MCMRSimulator.MCMRSimulator"><code>MCMRSimulator.MCMRSimulator</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>This package supports the running of MR Monte Carlo simulations.</p><p>In these simulations hundreds of thousands or millions of <a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a> particles randomly diffuse through some tissue microstructure. At each timepoint these spins are represented as a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> object. The spin diffusion is constrained by an <a href="@ref"><code>ObstructionGroup</code></a> (represented internally as <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>) The spins of these particles will be evolved based on the Bloch equations with the field strength and relaxation rates set by the local geometry and the effect of one or more <a href="@ref"><code>Sequence</code></a> objects. All these variables are combined into a single <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> object.  See <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> for how to run the simulation.</p><p>Plotting support for the sequence and resulting signal is also available based on <a href="https://makie.juliaplots.org/stable/">Makie.jl</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/MCMRSimulator.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Constants.gyromagnetic_ratio" href="#MCMRSimulator.Constants.gyromagnetic_ratio"><code>MCMRSimulator.Constants.gyromagnetic_ratio</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>gyromagnetic ratio of a proton (1H) in water in kHz/T</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/constants.jl#L2">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Methods" href="#MCMRSimulator.Methods"><code>MCMRSimulator.Methods</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines methods shared across multiple sub-modules.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/methods.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Methods.B0" href="#MCMRSimulator.Methods.B0"><code>MCMRSimulator.Methods.B0</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">B0(scanner)
B0(sequence)</code></pre><p>Returns the magnetic field strength of the scanner in Tesla.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/methods.jl#L19-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Methods.get_rotation-Tuple{Rotations.Rotation, Int64}" href="#MCMRSimulator.Methods.get_rotation-Tuple{Rotations.Rotation, Int64}"><code>MCMRSimulator.Methods.get_rotation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_rotation(rotation_mat, ndim)</code></pre><p>Returns a (3, <code>ndim</code>) rotation matrix, that is the relevant part of the full 3x3 <code>rotation_mat</code> to map to the x-axis (if <code>ndim</code> is 1) or the x-y plance (if <code>ndim</code> is 2). If <code>ndim</code> is 3, the full rotation matrix <code>rotation_mat</code> is returned.</p><pre><code class="nohighlight hljs">get_rotation(vector, ndim; reference_dimension)</code></pre><p>Returns the (3, <code>ndim</code>) rotation matrix mapping the <code>vector</code> to the <code>reference_dimension</code>. By default, the <code>reference_dimension is the x-direction (if</code>ndim<code>is 1 or 3) or the z-direction (if</code>ndim<code>is 2).</code>vector<code>and</code>reference_dimension` can be a length 3 array or one of the symbols :x, :y, or :z (representing vectors in those cardinal directions).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/methods.jl#L49-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Methods.get_time" href="#MCMRSimulator.Methods.get_time"><code>MCMRSimulator.Methods.get_time</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_time(snapshot)
get_time(sequence_component)
get_time(sequence, sequence_index)</code></pre><p>Returns the time in milliseconds that a snapshot was taken or that a sequence component will have effect.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/methods.jl#L10-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Methods.norm_angle-Tuple{Any}" href="#MCMRSimulator.Methods.norm_angle-Tuple{Any}"><code>MCMRSimulator.Methods.norm_angle</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">norm_angle(angle)</code></pre><p>Normalises an angle in degrees, so that it is between it is in the range (-180, 180]</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/methods.jl#L33-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Properties" href="#MCMRSimulator.Properties"><code>MCMRSimulator.Properties</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Types:</p><ul><li><a href="#MCMRSimulator.Properties.GlobalProperties"><code>GlobalProperties</code></a></li></ul><p>Methods:</p><ul><li><a href="#MCMRSimulator.Properties.R1"><code>R1</code></a></li><li><a href="#MCMRSimulator.Properties.R2"><code>R2</code></a></li><li><a href="#MCMRSimulator.Properties.off_resonance"><code>off_resonance</code></a></li><li><a href="#MCMRSimulator.Properties.stick_probability-NTuple{4, Number}"><code>stick_probability</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/properties.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Properties.GlobalProperties" href="#MCMRSimulator.Properties.GlobalProperties"><code>MCMRSimulator.Properties.GlobalProperties</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GlobalProperties(; R1=0, R2=0, off_resonance=0)</code></pre><p>Stores global MRI and collision properties.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/properties.jl#L13-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Properties.stick_probability-NTuple{4, Number}" href="#MCMRSimulator.Properties.stick_probability-NTuple{4, Number}"><code>MCMRSimulator.Properties.stick_probability</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stick_probability(surface_density, dwell_time, diffusivity, timestep)</code></pre><p>Computes the probability of a spin getting stuck at the surface given a <a href="@ref"><code>surface_density</code></a> and <a href="@ref"><code>dwell_time</code></a> as well as the diffusivity (in um^2/ms) and the timestep (in ms).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/properties.jl#L49-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries" href="#MCMRSimulator.Geometries"><code>MCMRSimulator.Geometries</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the microstructural environment with which the spins interact.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/geometries.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User" href="#MCMRSimulator.Geometries.User"><code>MCMRSimulator.Geometries.User</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>User interface for defining geometry.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/user.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Annuli" href="#MCMRSimulator.Geometries.User.Obstructions.Annuli"><code>MCMRSimulator.Geometries.User.Obstructions.Annuli</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:Annuli})(; fields...)</code></pre><p>Creates a set of Annulus objects. Fields can be set using keyword arguments. The following fields are available:</p><ul><li>inner: Radius of the inner cylinder. Field is required. Expected type: Float64.</li><li>outer: Radius of the outer cylinder. Field is required. Expected type: Float64.</li><li>myelin: Whether the annulus is myelinated. Field is required. Expected type: Bool.  default value: false</li><li>rotation: Rotation applied to all obstructions in group. Can be set to a matrix or one of :x, :y, or, :z (see <a href="#MCMRSimulator.Methods.get_rotation-Tuple{Rotations.Rotation, Int64}"><code>get_rotation</code></a>). Field is required. Expected type: StaticArraysCore.SMatrix{3, 2, Float64, 6}.  default value: [1.0 0.0; 0.0 1.0; 0.0 0.0]</li><li>R1_inner_surface: Additional longitudinal relaxation rate (kHz). Inner_surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R1_outer_surface: Additional longitudinal relaxation rate (kHz). Outer_surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R1_inner_volume: Additional longitudinal relaxation rate (kHz). Inner_volume property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R1_outer_volume: Additional longitudinal relaxation rate (kHz). Outer_volume property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_inner_surface: Additional transverse relaxation rate (kHz). Inner_surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_outer_surface: Additional transverse relaxation rate (kHz). Outer_surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_inner_volume: Additional transverse relaxation rate (kHz). Inner_volume property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_outer_volume: Additional transverse relaxation rate (kHz). Outer_volume property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_inner_surface: Additional off-resonance field offset (kHz). Inner_surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_outer_surface: Additional off-resonance field offset (kHz). Outer_surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_inner_volume: Additional off-resonance field offset (kHz). Inner_volume property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_outer_volume: Additional off-resonance field offset (kHz). Outer_volume property. Field is required. Expected type: Float64.  default value: 0.0</li><li>position: Spatial offset of obstruction from origin. Field is required. Expected type: StaticArraysCore.MVector{2, Float64}.  default value: [0.0, 0.0]</li><li>susceptibility_iso: Isotropic component of the myelin susceptibility (in ppm). Field can be null. Expected type: Float64.  default value: -0.1</li><li>susceptibility_aniso: Anisotropic component of the myelin susceptibility (in ppm). Field can be null. Expected type: Float64.  default value: -0.1</li><li>lorentz_radius: Only compute field explicitly for a annuli with this Lorentz radius. Field can be null. Expected type: Float64.  default value: 5.0</li><li>repeats: Length scale on which the obstructions are repeated (um). Field can be null. Expected type: StaticArraysCore.MVector{2, Float64}.</li><li>use_boundingbox: Use bounding boxes for an initial filtering of possible intersections. Field can be null. Expected type: Bool.  default value: true</li><li>grid_resolution: Resolution of the grid that the volume is split up into (um). Defaults to roughly one grid element per obstruction. Field can be null. Expected type: Float64.</li><li>dwell_time_inner_surface: Average time a particle stays stuck to the surface (ms). Inner_surface property. Field can be null. Expected type: Float64.</li><li>dwell_time_outer_surface: Average time a particle stays stuck to the surface (ms). Outer_surface property. Field can be null. Expected type: Float64.</li><li>density_inner_surface: Surface density of stuck particles relative to the volume density (um). Inner_surface property. Field can be null. Expected type: Float64.</li><li>density_outer_surface: Surface density of stuck particles relative to the volume density (um). Outer_surface property. Field can be null. Expected type: Float64.</li><li>permeability_inner_surface: Rate of particle passing through the obstruction in arbitrary units. Inner_surface property. Field can be null. Expected type: Float64.</li><li>permeability_outer_surface: Rate of particle passing through the obstruction in arbitrary units. Outer_surface property. Field can be null. Expected type: Float64.</li><li>relaxation_inner_surface: Rate of signal loss at each collision. The actual signal loss at each collision is e^(-x * sqrt(t)), where x is this rate and t is the timestep. Inner_surface property. Field can be null. Expected type: Float64.</li><li>relaxation_outer_surface: Rate of signal loss at each collision. The actual signal loss at each collision is e^(-x * sqrt(t)), where x is this rate and t is the timestep. Outer_surface property. Field can be null. Expected type: Float64.</li><li>size_scale: Size of the smallest obstructions. If not set explicitly, this will be determined by the minimum radius or distance between objects (see <code>size_scale</code>). Field can be null. Expected type: Float64.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/obstructions/obstructions.jl#L81-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.BendyCylinder" href="#MCMRSimulator.Geometries.User.Obstructions.BendyCylinder"><code>MCMRSimulator.Geometries.User.Obstructions.BendyCylinder</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:BendyCylinder})(; fields...)</code></pre><p>Creates a set of Ring objects. Fields can be set using keyword arguments. The following fields are available:</p><ul><li>control_point: Control points defining the path of the cylinder. Field is required. Expected type: StaticArraysCore.MVector{3, Float64}.</li><li>radius: Radius at each control point. Field is required. Expected type: Float64.</li><li>spline_order: Sets the order of the b-spine interpolating between control points. Field is required. Expected type: Int64.  default value: 3</li><li>myelin: Whether the cylinder is myelinated. Field is required. Expected type: Bool.  default value: false</li><li>rotation: Rotation applied to all obstructions in group. Can be set to a matrix or one of :x, :y, or, :z (see <a href="#MCMRSimulator.Methods.get_rotation-Tuple{Rotations.Rotation, Int64}"><code>get_rotation</code></a>). Field is required. Expected type: StaticArraysCore.SMatrix{3, 3, Float64, 9}.  default value: [1.0 0.0 0.0; 0.0 1.0 0.0; 0.0 0.0 1.0]</li><li>R1_surface: Additional longitudinal relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R1_inside: Additional longitudinal relaxation rate (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_surface: Additional transverse relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_inside: Additional transverse relaxation rate (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_surface: Additional off-resonance field offset (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_inside: Additional off-resonance field offset (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>nsamples: Number of mesh vertices along each ring. Field can be null. Expected type: Int64.  default value: 100</li><li>closed: After how many repeats in each dimension does the cylinder connect with itself. If not set the cylinder is not closed. Field can be null. Expected type: StaticArraysCore.MVector{3, Int64}.</li><li>susceptibility_iso: Isotropic component of the susceptibility (in ppm um). It can be calculated by multiplying the isotropic susceptibility of the simulated tissue by the thickness. Field can be null. Expected type: Float64.  default value: -0.1</li><li>susceptibility_aniso: Anisotropic component of the susceptibility (in ppm um). It can be calculated by multiplying the anisotropic susceptibility of the simulated tissue by the thickness. Field can be null. Expected type: Float64.  default value: -0.1</li><li>lorentz_radius: Only compute field explicitly for triangles with this Lorentz radius. Field can be null. Expected type: Float64.  default value: 5.0</li><li>repeats: Length scale on which the obstructions are repeated (um). Field can be null. Expected type: StaticArraysCore.MVector{3, Float64}.</li><li>use_boundingbox: Use bounding boxes for an initial filtering of possible intersections. Field can be null. Expected type: Bool.  default value: true</li><li>grid_resolution: Resolution of the grid that the volume is split up into (um). Defaults to roughly one grid element per obstruction. Field can be null. Expected type: Float64.</li><li>dwell_time: Average time a particle stays stuck to the surface (ms). Surface property. Field can be null. Expected type: Float64.</li><li>density: Surface density of stuck particles relative to the volume density (um). Surface property. Field can be null. Expected type: Float64.</li><li>permeability: Rate of particle passing through the obstruction in arbitrary units. Surface property. Field can be null. Expected type: Float64.</li><li>relaxation: Rate of signal loss at each collision. The actual signal loss at each collision is e^(-x * sqrt(t)), where x is this rate and t is the timestep. Surface property. Field can be null. Expected type: Float64.</li><li>size_scale: Size of the smallest obstructions. If not set explicitly, this will be determined by the minimum radius or distance between objects (see <code>size_scale</code>). Field can be null. Expected type: Float64.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/obstructions/obstructions.jl#L81-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Cylinders" href="#MCMRSimulator.Geometries.User.Obstructions.Cylinders"><code>MCMRSimulator.Geometries.User.Obstructions.Cylinders</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:Cylinders})(; fields...)</code></pre><p>Creates a set of Cylinder objects. Fields can be set using keyword arguments. The following fields are available:</p><ul><li>radius: Radius of the cylinder. Field is required. Expected type: Float64.</li><li>rotation: Rotation applied to all obstructions in group. Can be set to a matrix or one of :x, :y, or, :z (see <a href="#MCMRSimulator.Methods.get_rotation-Tuple{Rotations.Rotation, Int64}"><code>get_rotation</code></a>). Field is required. Expected type: StaticArraysCore.SMatrix{3, 2, Float64, 6}.  default value: [1.0 0.0; 0.0 1.0; 0.0 0.0]</li><li>R1_surface: Additional longitudinal relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R1_inside: Additional longitudinal relaxation rate (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_surface: Additional transverse relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_inside: Additional transverse relaxation rate (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_surface: Additional off-resonance field offset (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_inside: Additional off-resonance field offset (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>position: Spatial offset of obstruction from origin. Field is required. Expected type: StaticArraysCore.MVector{2, Float64}.  default value: [0.0, 0.0]</li><li>g_ratio: Inner/outer radius used for susceptibility calculation Field can be null. Expected type: Float64.  default value: 1.0</li><li>susceptibility_iso: Isotropic component of the susceptibility (in ppm um). It can be calculated by multiplying the isotropic susceptibility of the simulated tissue by the thickness. Field can be null. Expected type: Float64.  default value: -0.1</li><li>susceptibility_aniso: Anisotropic component of the susceptibility (in ppm um). It can be calculated by multiplying the anisotropic susceptibility of the simulated tissue by the thickness Field can be null. Expected type: Float64.  default value: -0.1</li><li>lorentz_radius: Only compute field explicitly for cylinders with this Lorentz radius. Field can be null. Expected type: Float64.  default value: 5.0</li><li>repeats: Length scale on which the obstructions are repeated (um). Field can be null. Expected type: StaticArraysCore.MVector{2, Float64}.</li><li>use_boundingbox: Use bounding boxes for an initial filtering of possible intersections. Field can be null. Expected type: Bool.  default value: true</li><li>grid_resolution: Resolution of the grid that the volume is split up into (um). Defaults to roughly one grid element per obstruction. Field can be null. Expected type: Float64.</li><li>dwell_time: Average time a particle stays stuck to the surface (ms). Surface property. Field can be null. Expected type: Float64.</li><li>density: Surface density of stuck particles relative to the volume density (um). Surface property. Field can be null. Expected type: Float64.</li><li>permeability: Rate of particle passing through the obstruction in arbitrary units. Surface property. Field can be null. Expected type: Float64.</li><li>relaxation: Rate of signal loss at each collision. The actual signal loss at each collision is e^(-x * sqrt(t)), where x is this rate and t is the timestep. Surface property. Field can be null. Expected type: Float64.</li><li>size_scale: Size of the smallest obstructions. If not set explicitly, this will be determined by the minimum radius or distance between objects (see <code>size_scale</code>). Field can be null. Expected type: Float64.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/obstructions/obstructions.jl#L81-L108">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Mesh" href="#MCMRSimulator.Geometries.User.Obstructions.Mesh"><code>MCMRSimulator.Geometries.User.Obstructions.Mesh</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:Mesh})(; fields...)</code></pre><p>Creates a set of Triangle objects. Fields can be set using keyword arguments. The following fields are available:</p><ul><li>triangles: Each triangle is defined by 3 vertices into the mesh. Field is required. Expected type: StaticArraysCore.MVector{3, Int64}.</li><li>vertices: Positions of the corners of the triangular mesh. Field is required. Expected type: Vector{StaticArraysCore.MVector{3, Float64}}.</li><li>myelin: Whether the mesh is myelinated. Field is required. Expected type: Bool.  default value: false</li><li>rotation: Rotation applied to all obstructions in group. Can be set to a matrix or one of :x, :y, or, :z (see <a href="#MCMRSimulator.Methods.get_rotation-Tuple{Rotations.Rotation, Int64}"><code>get_rotation</code></a>). Field is required. Expected type: StaticArraysCore.SMatrix{3, 3, Float64, 9}.  default value: [1.0 0.0 0.0; 0.0 1.0 0.0; 0.0 0.0 1.0]</li><li>R1_surface: Additional longitudinal relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R1_inside: Additional longitudinal relaxation rate (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_surface: Additional transverse relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_inside: Additional transverse relaxation rate (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_surface: Additional off-resonance field offset (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_inside: Additional off-resonance field offset (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>susceptibility_iso: Isotropic component of the susceptibility (in ppm um). It can be calculated by multiplying the isotropic susceptibility of the simulated tissue by the thickness. Field can be null. Expected type: Float64.  default value: -0.1</li><li>susceptibility_aniso: Anisotropic component of the susceptibility (in ppm um). It can be calculated by multiplying the anisotropic susceptibility of the simulated tissue by the thickness. Field can be null. Expected type: Float64.  default value: -0.1</li><li>lorentz_radius: Only compute field explicitly for triangles with this Lorentz radius. Field can be null. Expected type: Float64.  default value: 5.0</li><li>components: Which component this triangle belongs to. If not provided explicitly, this will be determined based on connectivity. Field can be null. Expected type: Int64.</li><li>repeats: Length scale on which the obstructions are repeated (um). Field can be null. Expected type: StaticArraysCore.MVector{3, Float64}.</li><li>use_boundingbox: Use bounding boxes for an initial filtering of possible intersections. Field can be null. Expected type: Bool.  default value: true</li><li>grid_resolution: Resolution of the grid that the volume is split up into (um). Defaults to roughly one grid element per obstruction. Field can be null. Expected type: Float64.</li><li>dwell_time: Average time a particle stays stuck to the surface (ms). Surface property. Field can be null. Expected type: Float64.</li><li>density: Surface density of stuck particles relative to the volume density (um). Surface property. Field can be null. Expected type: Float64.</li><li>permeability: Rate of particle passing through the obstruction in arbitrary units. Surface property. Field can be null. Expected type: Float64.</li><li>relaxation: Rate of signal loss at each collision. The actual signal loss at each collision is e^(-x * sqrt(t)), where x is this rate and t is the timestep. Surface property. Field can be null. Expected type: Float64.</li><li>size_scale: Size of the smallest obstructions. If not set explicitly, this will be determined by the minimum radius or distance between objects (see <code>size_scale</code>). Field can be null. Expected type: Float64.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/obstructions/obstructions.jl#L81-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Spheres" href="#MCMRSimulator.Geometries.User.Obstructions.Spheres"><code>MCMRSimulator.Geometries.User.Obstructions.Spheres</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:Spheres})(; fields...)</code></pre><p>Creates a set of Sphere objects. Fields can be set using keyword arguments. The following fields are available:</p><ul><li>radius: Radius of the cylinder. Field is required. Expected type: Float64.</li><li>rotation: Rotation applied to all obstructions in group. Can be set to a matrix or one of :x, :y, or, :z (see <a href="#MCMRSimulator.Methods.get_rotation-Tuple{Rotations.Rotation, Int64}"><code>get_rotation</code></a>). Field is required. Expected type: StaticArraysCore.SMatrix{3, 3, Float64, 9}.  default value: [1.0 0.0 0.0; 0.0 1.0 0.0; 0.0 0.0 1.0]</li><li>R1_surface: Additional longitudinal relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R1_inside: Additional longitudinal relaxation rate (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_surface: Additional transverse relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_inside: Additional transverse relaxation rate (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_surface: Additional off-resonance field offset (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_inside: Additional off-resonance field offset (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>position: Spatial offset of obstruction from origin. Field is required. Expected type: StaticArraysCore.MVector{3, Float64}.  default value: [0.0, 0.0, 0.0]</li><li>repeats: Length scale on which the obstructions are repeated (um). Field can be null. Expected type: StaticArraysCore.MVector{3, Float64}.</li><li>use_boundingbox: Use bounding boxes for an initial filtering of possible intersections. Field can be null. Expected type: Bool.  default value: true</li><li>grid_resolution: Resolution of the grid that the volume is split up into (um). Defaults to roughly one grid element per obstruction. Field can be null. Expected type: Float64.</li><li>dwell_time: Average time a particle stays stuck to the surface (ms). Surface property. Field can be null. Expected type: Float64.</li><li>density: Surface density of stuck particles relative to the volume density (um). Surface property. Field can be null. Expected type: Float64.</li><li>permeability: Rate of particle passing through the obstruction in arbitrary units. Surface property. Field can be null. Expected type: Float64.</li><li>relaxation: Rate of signal loss at each collision. The actual signal loss at each collision is e^(-x * sqrt(t)), where x is this rate and t is the timestep. Surface property. Field can be null. Expected type: Float64.</li><li>size_scale: Size of the smallest obstructions. If not set explicitly, this will be determined by the minimum radius or distance between objects (see <code>size_scale</code>). Field can be null. Expected type: Float64.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/obstructions/obstructions.jl#L81-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Walls" href="#MCMRSimulator.Geometries.User.Obstructions.Walls"><code>MCMRSimulator.Geometries.User.Obstructions.Walls</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:Walls})(; fields...)</code></pre><p>Creates a set of Wall objects. Fields can be set using keyword arguments. The following fields are available:</p><ul><li>rotation: Rotation applied to all obstructions in group. Can be set to a matrix or one of :x, :y, or, :z (see <a href="#MCMRSimulator.Methods.get_rotation-Tuple{Rotations.Rotation, Int64}"><code>get_rotation</code></a>). Field is required. Expected type: StaticArraysCore.SMatrix{3, 1, Float64, 3}.  default value: [1.0; 0.0; 0.0;;]</li><li>R1: Additional longitudinal relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2: Additional transverse relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance: Additional off-resonance field offset (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>position: Spatial offset of obstruction from origin. Field is required. Expected type: Float64.  default value: 0.0</li><li>repeats: Length scale on which the obstructions are repeated (um). Field can be null. Expected type: StaticArraysCore.MVector{1, Float64}.</li><li>use_boundingbox: Use bounding boxes for an initial filtering of possible intersections. Field can be null. Expected type: Bool.  default value: true</li><li>grid_resolution: Resolution of the grid that the volume is split up into (um). Defaults to roughly one grid element per obstruction. Field can be null. Expected type: Float64.</li><li>dwell_time: Average time a particle stays stuck to the surface (ms). Surface property. Field can be null. Expected type: Float64.</li><li>density: Surface density of stuck particles relative to the volume density (um). Surface property. Field can be null. Expected type: Float64.</li><li>permeability: Rate of particle passing through the obstruction in arbitrary units. Surface property. Field can be null. Expected type: Float64.</li><li>relaxation: Rate of signal loss at each collision. The actual signal loss at each collision is e^(-x * sqrt(t)), where x is this rate and t is the timestep. Surface property. Field can be null. Expected type: Float64.</li><li>size_scale: Size of the smallest obstructions. If not set explicitly, this will be determined by the minimum radius or distance between objects (see <code>size_scale</code>). Field can be null. Expected type: Float64.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/obstructions/obstructions.jl#L81-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Fields.Field" href="#MCMRSimulator.Geometries.User.Obstructions.Fields.Field"><code>MCMRSimulator.Geometries.User.Obstructions.Fields.Field</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Field{T}(name::Symbol[, description::String[, default_value::T]]; per_surface=false, per_volume=false, only_group=false, required=false)</code></pre><p>Represents a property of an obstruction with:</p><ul><li><code>Type</code>: type of the property value (can also be Nothing unless <code>required</code> is true).</li><li><code>name</code>: name of the property.</li><li><code>description</code>: describes the property to the user.</li><li><code>default_value</code>: what the value is set to if not provided by the user.</li><li><code>per_surface</code>: can have a different value for each surface in the obstruction.</li><li><code>per_volume</code>: can have a different value within each enclosed volume of the obstruction.</li><li><code>required</code>: if true, the user has to provide a value, which cannot be nothing.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/obstructions/fields.jl#L6-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Fields.FieldValue" href="#MCMRSimulator.Geometries.User.Obstructions.Fields.FieldValue"><code>MCMRSimulator.Geometries.User.Obstructions.Fields.FieldValue</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FieldValue(field::Field{T}, n_obstructions, [, category::Symbol][, value])</code></pre><p>Represents the value for a specific field across a vector of obstructions. For fields with multiple values (one per volume or surface), <code>category</code> is required to set this. The current value is given by <code>value</code>. This has to be type <code>T</code> or a vector of type <code>T</code>. For a non-required field, it can also be nothing (or a vector containing nothings).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/obstructions/fields.jl#L62-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Fields.convert_value-Union{Tuple{T}, Tuple{Type{T}, Any}} where T" href="#MCMRSimulator.Geometries.User.Obstructions.Fields.convert_value-Union{Tuple{T}, Tuple{Type{T}, Any}} where T"><code>MCMRSimulator.Geometries.User.Obstructions.Fields.convert_value</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">convert_value(T, value, required::Bool)</code></pre><p>Convert <code>value</code> into type <code>T</code> or a vector of <code>T</code>. If required is false <code>value</code> can also be nothing or a vector containing <code>T</code> and nothing.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/obstructions/fields.jl#L33-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes" href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes"><code>MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Types:</p><ul><li><a href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes.ObstructionType"><code>ObstructionType</code></a></li></ul><p>Methods:</p><ul><li><a href="@ref"><code>fields</code></a></li><li><a href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes.key_value_pairs"><code>key_value_pairs</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/obstructions/obstruction_types.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes.ObstructionType" href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes.ObstructionType"><code>MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes.ObstructionType</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines individual obstruction types</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/obstructions/obstruction_types.jl#L15-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes.key_value_pairs" href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes.key_value_pairs"><code>MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes.key_value_pairs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">key_value_pairs(obstruction_type, n_obstructions)</code></pre><p>Defines a mapping from symbols to <a href="#MCMRSimulator.Geometries.User.Obstructions.Fields.FieldValue"><code>FieldValue</code></a> objects.</p><p>Returns a type with:</p><ul><li>a sub-set of symbols that are enough to set all unique field values.</li><li>a mapping from symbols to field values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/obstructions/obstruction_types.jl#L75-L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.nvolumes-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup}" href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.nvolumes-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup}"><code>MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.nvolumes</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nvolumes(group)</code></pre><p>For any <code>ObstructionType</code> with group_volumes, this computes the number of distinct volumes.</p><p>This is mainly used to compute the number of distinct components in a mesh.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/obstructions/obstruction_groups.jl#L54-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Fix.apply_properties-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup, Vector{&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction}, Int64, Int64}" href="#MCMRSimulator.Geometries.User.Fix.apply_properties-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup, Vector{&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction}, Int64, Int64}"><code>MCMRSimulator.Geometries.User.Fix.apply_properties</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_properties(user_obstructions, internal_obstructions, index; surface, volume)</code></pre><p>Apply the generic obstruction properties defined in <code>user_obstruction</code> to <code>internal_obstructions</code>. This function applies (if appropriate):</p><ul><li>positional shifts</li><li>volumetic and surface-bound MRI properties</li><li>collision properties</li><li>rotation</li><li>repeats</li><li>mesh vertices</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/fix.jl#L103-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Fix.fix-Tuple{AbstractVector}" href="#MCMRSimulator.Geometries.User.Fix.fix-Tuple{AbstractVector}"><code>MCMRSimulator.Geometries.User.Fix.fix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fix(user_geometry; permeability=0., density=0., dwell_time=0., relaxation=0.)</code></pre><p>Creates a fixed version of the user-created geometry that will be used internally by the simulator.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/fix.jl#L9-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Fix.fix_type" href="#MCMRSimulator.Geometries.User.Fix.fix_type"><code>MCMRSimulator.Geometries.User.Fix.fix_type</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fix_type(group::ObstructionGroup, index)</code></pre><p>Replace user <a href="@ref"><code>ObstructionGroup</code></a> objects with a <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>.</p><p>This needs to be defined for each sub-type of <a href="@ref"><code>ObstructionGroup</code></a>,     e.g. <a href="#MCMRSimulator.Geometries.User.Obstructions.Spheres"><code>Spheres</code></a>, <a href="#MCMRSimulator.Geometries.User.Obstructions.Annuli"><code>Annuli</code></a>, <a href="#MCMRSimulator.Geometries.User.Obstructions.Mesh"><code>Mesh</code></a>.</p><p>Shifts, collision properties, and volumetric and surface MRI properties can be added using <a href="#MCMRSimulator.Geometries.User.Fix.apply_properties-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup, Vector{&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction}, Int64, Int64}"><code>apply_properties</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/fix.jl#L34-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.FixSusceptibility.fix_susceptibility-Tuple{AbstractVector}" href="#MCMRSimulator.Geometries.User.FixSusceptibility.fix_susceptibility-Tuple{AbstractVector}"><code>MCMRSimulator.Geometries.User.FixSusceptibility.fix_susceptibility</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fix_susceptibility(geometry)</code></pre><p>Create a new <a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.FixedSusceptibility"><code>FixedSusceptibility</code></a> based on the user-defined geometry settings.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/fix_susceptibility.jl#L11-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.LoadMesh.load_mesh-Tuple{IO}" href="#MCMRSimulator.Geometries.User.LoadMesh.load_mesh-Tuple{IO}"><code>MCMRSimulator.Geometries.User.LoadMesh.load_mesh</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_mesh(file)</code></pre><p>Loads a <a href="#MCMRSimulator.Geometries.User.Obstructions.Mesh"><code>Mesh</code></a> from a file.</p><p>Currently only PLY files are supported (see <a href="#MCMRSimulator.Geometries.User.LoadMesh.ply_from_mesh-Tuple{Any}"><code>ply_from_mesh</code></a>)</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/load_mesh.jl#L23-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.LoadMesh.ply_from_mesh-Tuple{Any}" href="#MCMRSimulator.Geometries.User.LoadMesh.ply_from_mesh-Tuple{Any}"><code>MCMRSimulator.Geometries.User.LoadMesh.ply_from_mesh</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ply_from_mesh(file)</code></pre><p>Loads a <a href="#MCMRSimulator.Geometries.User.Obstructions.Mesh"><code>Mesh</code></a> from a PLY file. PLY stands for Polygon File Format (http://paulbourke.net/dataformats/ply/). PLY IO is handled by PlyIO.jl (https://github.com/JuliaGeometry/PlyIO.jl).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/load_mesh.jl#L4-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.RandomDistribution.random_positions_radii-Tuple{Any, Real, Int64}" href="#MCMRSimulator.Geometries.User.RandomDistribution.random_positions_radii-Tuple{Any, Real, Int64}"><code>MCMRSimulator.Geometries.User.RandomDistribution.random_positions_radii</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">random_positions_radii(box_size, target_density, n_dimensions; distribution=Gamma, mean=1., variance=1., max_iter=1000, min_radius=0.1, max_radius=Inf)</code></pre><p>Randomly distributes circles or spheres in space.</p><p>Arguments:</p><ul><li><code>box_size</code>: Size of the infinitely repeating box of random positions</li><li><code>target_density</code>: Final density of the circles/spheres. This density will only be approximately reached</li><li><code>n_dimensions</code>: dimensionality of the space (2 for cicles; 3 for spheres)</li><li><code>distribution</code>: distribution from which the radii are drawn (from <a href="https://juliastats.org/Distributions.jl/stable/">Distributions.jl</a>)</li><li><code>mean</code>: mean of the gamma distribution (ignored if <code>distribution</code> explicitly set)</li><li><code>variance</code>: variance of the gamma distribution (ignored if <code>distribution</code> explicitly set)</li><li><code>max_iter</code>: maximum number of iterations to try to prevent the circles/spheres from overlapping. An error is raised if they still overlap after this number of iterations.</li><li><code>repulsion_strength</code>: strength of the repulsion in each step (defaults to 0.001).</li><li><code>max_iter_repulse</code>: maximum number of iterations that circles/spheres will be repulsed from each other</li><li><code>min_radius</code>: samples from the distribution below this radius will be rejected (in um).</li><li><code>max_radius</code>: samples from the distribution above this radius will be rejected (in um).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/random_distribution.jl#L116-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.SplitMesh" href="#MCMRSimulator.Geometries.User.SplitMesh"><code>MCMRSimulator.Geometries.User.SplitMesh</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Mesh-specific operations to normalise and split a mesh.</p><ul><li><a href="@ref"><code>split_mesh</code></a>: applies all the normalisations and splitting</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/split_mesh.jl#L1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.SplitMesh.components-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:Mesh}}" href="#MCMRSimulator.Geometries.User.SplitMesh.components-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:Mesh}}"><code>MCMRSimulator.Geometries.User.SplitMesh.components</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">components(mesh)</code></pre><p>Returns which component each element in the mesh belongs to.</p><p>If not set explicitly (using <code>mesh.components=[...]</code>), it will be computed once based on the connectivity structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/split_mesh.jl#L165-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.SplitMesh.connected_indices-Tuple{AbstractVector}" href="#MCMRSimulator.Geometries.User.SplitMesh.connected_indices-Tuple{AbstractVector}"><code>MCMRSimulator.Geometries.User.SplitMesh.connected_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">connected_indices(connectivity_matrix)
connected_indices(triangles)</code></pre><p>Returns a vector of indices, where each connected component has been given a unique index (starting with 1).</p><p>For the triangles, each vertex will be given an index (not each triangle).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/split_mesh.jl#L113-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.SplitMesh.connectivity_matrix-Tuple{Any}" href="#MCMRSimulator.Geometries.User.SplitMesh.connectivity_matrix-Tuple{Any}"><code>MCMRSimulator.Geometries.User.SplitMesh.connectivity_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">connectivity_matrix(triangles, nvertices)</code></pre><p>Create a nverticesxnvertices sparse boolean matrix, which is true for any connected vertices.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/split_mesh.jl#L99-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.SplitMesh.fix_mesh-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:Mesh}}" href="#MCMRSimulator.Geometries.User.SplitMesh.fix_mesh-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:Mesh}}"><code>MCMRSimulator.Geometries.User.SplitMesh.fix_mesh</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fix_mesh(mesh)</code></pre><p>Returns a fixed mesh, where all normals point outwards.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/split_mesh.jl#L15-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.SplitMesh.make_normals_consistent!-Tuple{AbstractVector}" href="#MCMRSimulator.Geometries.User.SplitMesh.make_normals_consistent!-Tuple{AbstractVector}"><code>MCMRSimulator.Geometries.User.SplitMesh.make_normals_consistent!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">make_normals_consistent!(triangles)</code></pre><p>Adjust the triangles to all point outwards or all point inwards. Assumes that all the triangles are connected (can be enforced using <a href="@ref"><code>connected_components</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/split_mesh.jl#L39-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.JSON" href="#MCMRSimulator.Geometries.User.JSON"><code>MCMRSimulator.Geometries.User.JSON</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Supports I/O to and from json</p><p>Functions:</p><ul><li><a href="#MCMRSimulator.Geometries.User.JSON.write_geometry-Tuple{Any}"><code>write_geometry</code></a></li><li><a href="#MCMRSimulator.Geometries.User.JSON.read_geometry-Tuple{IO}"><code>read_geometry</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/json.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.JSON.read_geometry-Tuple{IO}" href="#MCMRSimulator.Geometries.User.JSON.read_geometry-Tuple{IO}"><code>MCMRSimulator.Geometries.User.JSON.read_geometry</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_geometry(filename/io)</code></pre><p>Read geometry from a JSON file.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/json.jl#L53-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.JSON.write_geometry-Tuple{Any}" href="#MCMRSimulator.Geometries.User.JSON.write_geometry-Tuple{Any}"><code>MCMRSimulator.Geometries.User.JSON.write_geometry</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_geometry([io, ]geometry)</code></pre><p>Writes the user-defined geometry as a JSON file. If no IO is provided, the geometry is written to stdout.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/json.jl#L12-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.ToMesh" href="#MCMRSimulator.Geometries.User.ToMesh"><code>MCMRSimulator.Geometries.User.ToMesh</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Methods that extend the <code>Mesh</code> constructor to convert different types into meshes.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/to_mesh.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.BendyCylinder-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.IndexedObstruction{:Cylinders}}" href="#MCMRSimulator.Geometries.User.Obstructions.BendyCylinder-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.IndexedObstruction{:Cylinders}}"><code>MCMRSimulator.Geometries.User.Obstructions.BendyCylinder</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BendyCylinder(cylinder(s), nsamples=100, height=nothing)</code></pre><p>Approximates a cylinder by a <a href="#MCMRSimulator.Geometries.User.Obstructions.BendyCylinder"><code>BendyCylinder</code></a> with <code>nsamples</code> along the circumference. The <code>height</code> of the resulting mesh triangles is by default set to the circumference divided by <code>nsamples</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/to_mesh.jl#L118-L123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Mesh-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:BendyCylinder}}" href="#MCMRSimulator.Geometries.User.Obstructions.Mesh-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:BendyCylinder}}"><code>MCMRSimulator.Geometries.User.Obstructions.Mesh</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Mesh(other_obstruction; kwargs...)</code></pre><p>Approximates any other obstruction type by a mesh. Sometimes a sequence of <a href="#MCMRSimulator.Geometries.User.Obstructions.Mesh"><code>Mesh</code></a> objects will be returned instead (e.g., one mesh for each sphere/cylinder in <a href="#MCMRSimulator.Geometries.User.Obstructions.Spheres"><code>Spheres</code></a>/<a href="#MCMRSimulator.Geometries.User.Obstructions.Cylinders"><code>Cylinders</code></a> objects).</p><p><strong>Keyword arguments</strong></p><p>For <a href="#MCMRSimulator.Geometries.User.Obstructions.Cylinders"><code>Cylinders</code></a>:</p><ul><li><code>nsamples</code>: number of mesh vertices along the circumference (default: 100).</li><li><code>height</code>: height of mesh triangles in um along the long axis (default: average cylinder circumference divided by <code>nsamples</code>).</li></ul><p>For <a href="#MCMRSimulator.Geometries.User.Obstructions.Walls"><code>Walls</code></a>:</p><ul><li><code>height</code>: heigh of mesh triangle in um</li></ul><p>For <a href="#MCMRSimulator.Geometries.User.Obstructions.Spheres"><code>Spheres</code></a>:</p><ul><li><code>nasamples</code>: resulting mesh will contain at least this many triangles (default: 180).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/to_mesh.jl#L12-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.ToMesh.icosahedron-Tuple{}" href="#MCMRSimulator.Geometries.User.ToMesh.icosahedron-Tuple{}"><code>MCMRSimulator.Geometries.User.ToMesh.icosahedron</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">icosahedron(subdivision)</code></pre><p>Create an icosahedron. Based on algorithm from https://danielsieger.com/blog/2021/01/03/generating-platonic-solids.html</p><p>Each of the 20 original triangles is sub-divided into subdivision^2 triangles</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/to_mesh.jl#L208-L215">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.SizeScales.size_scale-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup}" href="#MCMRSimulator.Geometries.User.SizeScales.size_scale-Tuple{MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup}"><code>MCMRSimulator.Geometries.User.SizeScales.size_scale</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">size_scale(obstruction; ignore_user_value=false)</code></pre><p>Determines the size scale of the given obstruction.</p><p>The user can set the size scale using <code>obstruction.size_scale=&lt;value&gt;</code>. If set, this value will be returned (unless <code>ignore_user_value</code> is set to true).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/user/size_scales.jl#L6-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal" href="#MCMRSimulator.Geometries.Internal"><code>MCMRSimulator.Geometries.Internal</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Internal representation of the tissue geometry.</p><p>All objects are immutable and optimised for both memory usage and computational speed.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/internal.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.RayGridIntersection" href="#MCMRSimulator.Geometries.Internal.RayGridIntersection"><code>MCMRSimulator.Geometries.Internal.RayGridIntersection</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Methods:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.RayGridIntersection.ray_grid_intersections-Union{Tuple{N}, Tuple{StaticArraysCore.SVector{N, Float64}, StaticArraysCore.SVector{N, Float64}}} where N"><code>ray_grid_intersections</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/ray_grid_intersection.jl#L1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.RayGridIntersection.ray_grid_intersections-Union{Tuple{N}, Tuple{StaticArraysCore.SVector{N, Float64}, StaticArraysCore.SVector{N, Float64}}} where N" href="#MCMRSimulator.Geometries.Internal.RayGridIntersection.ray_grid_intersections-Union{Tuple{N}, Tuple{StaticArraysCore.SVector{N, Float64}, StaticArraysCore.SVector{N, Float64}}} where N"><code>MCMRSimulator.Geometries.Internal.RayGridIntersection.ray_grid_intersections</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ray_grid_intersections(origin, destination)</code></pre><p>Computes all voxels crossed by a ray between <code>origin</code> and <code>destination</code> with an inifinitely extending 1x1x1 grid. Both origin and destination are length-3 vectors. The returned object is an iterator returning a tuple with:</p><ul><li>N-length vector with the voxel that we are crossing through</li><li>Float with the time the ray entered voxel (0=<code>origin</code>, 1=<code>destination</code>)</li><li>N-length vector with position within voxel that the ray entered (i.e., numbers between 0 and 1)</li><li>Float with the time the ray left the voxel (0=<code>origin</code>, 1=<code>destination</code>)</li><li>N-length vector with position within voxel that the ray left (i.e., numbers between 0 and 1)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/ray_grid_intersection.jl#L16-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.BoundingBoxes" href="#MCMRSimulator.Geometries.Internal.BoundingBoxes"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Types:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox"><code>BoundingBox</code></a>: N-dimensional box fully containing an obstruction.</li></ul><p>Methods:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, AbstractVector, Vararg{Any}}} where N"><code>isinside</code></a>: returns whether point/spin is inside of bounding box</li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.could_intersect-Tuple{BoundingBox{1}, AbstractVector, AbstractVector}"><code>could_intersect</code></a>: returns whether spin trajectory could intersect with obstruction in bounding box</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/bounding_boxes.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox" href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BoundingBox(lower::Vector, upper::Vector)
BoundingBox([center::Vector, ]radius::Number)</code></pre><p>Represents a box in N-dimensional space.</p><p>Check whether particles are inside using <a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, AbstractVector, Vararg{Any}}} where N"><code>isinside</code></a>.</p><p>The main usage in the simulator is using <a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.could_intersect-Tuple{BoundingBox{1}, AbstractVector, AbstractVector}"><code>could_intersect</code></a>,  which checks whether a spin trajectory <em>could</em> intersect with the obstruction in the bounding box.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/bounding_boxes.jl#L12-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.BoundingBoxes.could_intersect-Tuple{BoundingBox{1}, AbstractVector, AbstractVector}" href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.could_intersect-Tuple{BoundingBox{1}, AbstractVector, AbstractVector}"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.could_intersect</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">could_intersect(bounding_box, start, dest)</code></pre><p>Returns true if a line connecting <code>start</code> to <code>dest</code> could intersect with an obstruction in <code>bounding_box</code>. This function only does some very fast, high-level checks. Just because it returns true does not mean that there is an interesection of the obstruction (or even the bounding box) with the line. However, if it returns false, there is guaranteed to be no intersection.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/bounding_boxes.jl#L61-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions" href="#MCMRSimulator.Geometries.Internal.Obstructions"><code>MCMRSimulator.Geometries.Internal.Obstructions</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines all the base obstructions supported by MCMRSimulator.</p><p>They are all sub-types of <a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction"><code>FixedObstruction</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/obstructions.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections" href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections"><code>MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Types:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.ObstructionIntersection"><code>ObstructionIntersection</code></a></li></ul><p>Attributes:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.empty_obstruction_intersections"><code>empty_obstruction_intersections</code></a></li></ul><p>Methods:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.has_intersection-Tuple{MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.ObstructionIntersection}"><code>has_intersection</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/obstruction_intersections.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.empty_obstruction_intersections" href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.empty_obstruction_intersections"><code>MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.empty_obstruction_intersections</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><a href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.ObstructionIntersection"><code>ObstructionIntersection</code></a> objects that indicate that no intersection was found.</p><p>This is a tuple with the ObstructionIntersection for 1, 2, or 3 dimensions.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/obstruction_intersections.jl#L25-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.ObstructionIntersection" href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.ObstructionIntersection"><code>MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.ObstructionIntersection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ObstructionIntersection{N}(distance, normal)</code></pre><p>Represents an intersection with a [<code>FixedObstruction</code>]{N}. Distance should be between 0 and 1 indicating where the obstruction intersects.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/obstruction_intersections.jl#L13-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.has_intersection-Tuple{MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.ObstructionIntersection}" href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.has_intersection-Tuple{MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.ObstructionIntersection}"><code>MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.has_intersection</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">has_intersection(intersection)</code></pre><p>Return true if the intersection object represents a true intersection.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/obstruction_intersections.jl#L36-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions" href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Types:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction"><code>FixedObstruction</code></a></li></ul><p>Methods:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.detect_intersection-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, StaticArraysCore.SVector{N}, StaticArraysCore.SVector{N}, NamedTuple, Union{Nothing, Bool}}} where N"><code>detect_intersection</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.has_inside"><code>has_inside</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, AbstractVector, Vararg{Any}}} where N"><code>isinside</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.radius"><code>radius</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox"><code>BoundingBox</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.obstruction_type-Union{Tuple{Type{O}}, Tuple{O}} where O&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction"><code>obstruction_type</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.random_surface_positions-Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction, NamedTuple, Number}"><code>random_surface_positions</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/fixed_obstructions.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox-Union{Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}}, Tuple{N}} where N" href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox-Union{Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}}, Tuple{N}} where N"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BoundingBox(obstruction[, vertices])</code></pre><p>Returns the smallest bounding box that fully encloses the <a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction"><code>FixedObstruction</code></a>.</p><p><code>vertices</code> will only be provided for the [<code>IndexTriangle</code>] type.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/fixed_obstructions.jl#L42-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction" href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Parent type of all individual obstructions.</p><p>N represents the intrinsic dimensionality of the obstruction (e.g., 1 for walls, 2 for cylinders, 3 for spheres/meshes)</p><p>Required interface for each obstruction:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.detect_intersection-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, StaticArraysCore.SVector{N}, StaticArraysCore.SVector{N}, NamedTuple, Union{Nothing, Bool}}} where N"><code>detect_intersection</code></a>(obstruction, start, dest) -&gt; <a href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.ObstructionIntersection"><code>ObstructionIntersection</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.has_inside"><code>has_inside</code></a>(obstruction_type) -&gt; Boolean</li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, AbstractVector, Vararg{Any}}} where N"><code>isinside</code></a>(obstruction, position) -&gt; Boolean</li><li>At least one of these two:<ul><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.radius"><code>radius</code></a>(obstruction): returns the radius of the obstruc</li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox"><code>BoundingBox</code></a>(obstruction): returns a Bounding box surrounding the obstruction</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/fixed_obstructions.jl#L18-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, AbstractVector, Vararg{Any}}} where N" href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, AbstractVector, Vararg{Any}}} where N"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isinside(obstruction, position)</code></pre><p>Returns true if the <code>position</code> is inside the <code>obstruction</code>. This will be inaccurate if the particle with that position is stuck on the surface of the obstruction.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/fixed_obstructions.jl#L73-L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.detect_intersection-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, StaticArraysCore.SVector{N}, StaticArraysCore.SVector{N}, NamedTuple, Union{Nothing, Bool}}} where N" href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.detect_intersection-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, StaticArraysCore.SVector{N}, StaticArraysCore.SVector{N}, NamedTuple, Union{Nothing, Bool}}} where N"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.detect_intersection</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">detect_intersection(obstruction, start, dest[, inside])</code></pre><p>Determines whether the line from <code>start</code> to <code>dest</code> intersects with <code>obstruction</code>. If no intersection is found, <a href="@ref"><code>empty_obstruction_intersection</code></a> is returned. Otherwise a <a href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.ObstructionIntersection"><code>ObstructionIntersection</code></a> object is returned.</p><p>If <code>inside</code> is set, the last collision in the trajectory was with this <code>obstruction</code>. <code>inside</code> indicates whether this previous collision was with the inside of the <code>obstruction</code>. This is passed on to prevent the particle from colliding with the same obstruction multiple times without any intermediate movement.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/fixed_obstructions.jl#L52-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.has_inside" href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.has_inside"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.has_inside</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">has_inside(obstruction_type)</code></pre><p>Returns true if a particular sub-type of <a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction"><code>FixedObstruction</code></a> has an inside.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/fixed_obstructions.jl#L66-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.obstruction_type-Union{Tuple{Type{O}}, Tuple{O}} where O&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction" href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.obstruction_type-Union{Tuple{Type{O}}, Tuple{O}} where O&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.obstruction_type</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">obstruction_type(obstruction/geometry)</code></pre><p>Returns the type of the obstruction that this geometry is built up out of</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/fixed_obstructions.jl#L82-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.radius" href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.radius"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.radius</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">radius(cylinder/sphere...)</code></pre><p>Returns the radius of an obstruction.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/fixed_obstructions.jl#L35-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.random_surface_positions-Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction, NamedTuple, Number}" href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.random_surface_positions-Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction, NamedTuple, Number}"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.random_surface_positions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">random_surface_positions(obstruction[, args], surface_density)</code></pre><p>Returns a vector of positions and normals on the normals of a specific obstruction. Normals should always assume that the particle is on the inside.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/fixed_obstructions.jl#L97-L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.size_scale-Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction}" href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.size_scale-Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction}"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.size_scale</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">size_scale(obstruction/geometry)</code></pre><p>Returns the size scale of the smallest object within the geometry (typically the radius or the repeating length scale).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/fixed_obstructions.jl#L89-L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.Triangles.curvature-NTuple{4, Any}" href="#MCMRSimulator.Geometries.Internal.Obstructions.Triangles.curvature-NTuple{4, Any}"><code>MCMRSimulator.Geometries.Internal.Obstructions.Triangles.curvature</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">curvature(triangles, vertices[index1, index2])</code></pre><p>Computes the curvature between two neighbouring triangles (<code>index1</code> and <code>index2</code>). If no indices are provided computes the mean curvature over the whole surface.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/triangles.jl#L183-L188">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.Triangles.detect_intersection_partial-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.Triangles.FullTriangle, StaticArraysCore.SVector{N}, StaticArraysCore.SVector{N}}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.Triangles.FullTriangle, StaticArraysCore.SVector{N}, StaticArraysCore.SVector{N}, Any}} where N" href="#MCMRSimulator.Geometries.Internal.Obstructions.Triangles.detect_intersection_partial-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.Triangles.FullTriangle, StaticArraysCore.SVector{N}, StaticArraysCore.SVector{N}}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.Triangles.FullTriangle, StaticArraysCore.SVector{N}, StaticArraysCore.SVector{N}, Any}} where N"><code>MCMRSimulator.Geometries.Internal.Obstructions.Triangles.detect_intersection_partial</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Computes the intersection for a triangle in a mesh (returned by <a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.detect_intersection-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, StaticArraysCore.SVector{N}, StaticArraysCore.SVector{N}, NamedTuple, Union{Nothing, Bool}}} where N"><code>detect_intersection</code></a>). This function also returns an additional bool. This bool will be true if the intersection is exactly at the edge of the triangle.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/triangles.jl#L105-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.Triangles.neighbours-Tuple{AbstractVector}" href="#MCMRSimulator.Geometries.Internal.Obstructions.Triangles.neighbours-Tuple{AbstractVector}"><code>MCMRSimulator.Geometries.Internal.Obstructions.Triangles.neighbours</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">neighbours(triangles)</code></pre><p>Return pairs of indices of triangles that share an edge.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/triangles.jl#L205-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.Triangles.normal-Tuple{AbstractVector, AbstractVector, AbstractVector}" href="#MCMRSimulator.Geometries.Internal.Obstructions.Triangles.normal-Tuple{AbstractVector, AbstractVector, AbstractVector}"><code>MCMRSimulator.Geometries.Internal.Obstructions.Triangles.normal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normal(p1, p2, p3)</code></pre><p>Computes the normal of a triangle formed by the three points</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/triangles.jl#L80-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.Triangles.triangle_size-Tuple{MCMRSimulator.Geometries.Internal.Obstructions.Triangles.FullTriangle}" href="#MCMRSimulator.Geometries.Internal.Obstructions.Triangles.triangle_size-Tuple{MCMRSimulator.Geometries.Internal.Obstructions.Triangles.FullTriangle}"><code>MCMRSimulator.Geometries.Internal.Obstructions.Triangles.triangle_size</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">triangle_size(full_triangle)
triangle_size(p1, p2, p3)</code></pre><p>Computes the size of a <a href="@ref"><code>FullTriangle</code></a> formed by three points</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/triangles.jl#L65-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.Shifts.Shift" href="#MCMRSimulator.Geometries.Internal.Obstructions.Shifts.Shift"><code>MCMRSimulator.Geometries.Internal.Obstructions.Shifts.Shift</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Shifts the obstruction <code>base</code> from the origin to <code>shift</code>.</p><p>The resulting object itself behaves like the base obstruction.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/obstructions/shifts.jl#L7-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Reflections" href="#MCMRSimulator.Geometries.Internal.Reflections"><code>MCMRSimulator.Geometries.Internal.Reflections</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Types:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.Reflections.Reflection"><code>Reflection</code></a></li></ul><p>Methods:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.Reflections.direction-Tuple{MCMRSimulator.Geometries.Internal.Reflections.Reflection, Any, Any}"><code>direction</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Reflections.has_hit-Tuple{MCMRSimulator.Geometries.Internal.Reflections.Reflection}"><code>has_hit</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Reflections.previous_hit-Tuple{MCMRSimulator.Geometries.Internal.Reflections.Reflection}"><code>previous_hit</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/reflections.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Reflections.Reflection" href="#MCMRSimulator.Geometries.Internal.Reflections.Reflection"><code>MCMRSimulator.Geometries.Internal.Reflections.Reflection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Reflection(intersection, direction, timestep, ratio_displaced, time_moved, distance_moved, permeable=false)</code></pre><p>Represents a reflection of a particle after colliding.</p><p>Parameters:</p><ul><li>intersection: <a href="@ref"><code>Intersection</code></a> represents the intersection of the trajectory with an obstruction. This will supply:<ul><li><code>geometry_index</code>: index of the geometry that got hit.</li><li><code>obstruction_index</code>: index of the obstruction that got hit within the geometry.</li><li><code>inside</code>: whether the inside of the obstruction was hit.</li></ul></li><li><code>direction</code>: this is stored in an updated form if the obstruction is not permeable (i.e., we have an actual reflection) as indicated by the <code>permeable</code> parameter.</li><li><code>ratio_displaced</code>: how large the displacement drawn from the Gaussian distribution was relative to that expected for the timestep.   This is calculated as &quot;step_size / sqrt(timestep)&quot;.</li><li><code>time_moved</code>: how long the particle has already been moving since the last time it was free at the start of a timestep (in ms).</li><li><code>distance_moved</code>: how far the particle has already moved (in um).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/reflections.jl#L16-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Reflections.Reflection-Tuple{Any}" href="#MCMRSimulator.Geometries.Internal.Reflections.Reflection-Tuple{Any}"><code>MCMRSimulator.Geometries.Internal.Reflections.Reflection</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Reflection(ratio_displaced)</code></pre><p>Creates a &quot;virtual&quot; Reflection that represents the movement of a free particle as drawn at the start of a timestep.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/reflections.jl#L56-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.has_intersection-Tuple{MCMRSimulator.Geometries.Internal.Reflections.Reflection}" href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.has_intersection-Tuple{MCMRSimulator.Geometries.Internal.Reflections.Reflection}"><code>MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.has_intersection</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">has_intersection(reflection)</code></pre><p>Returns true if this reflection is not empty, i.e., it represents a real collision with an obstruction.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/reflections.jl#L63-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Reflections.direction-Tuple{MCMRSimulator.Geometries.Internal.Reflections.Reflection, Any, Any}" href="#MCMRSimulator.Geometries.Internal.Reflections.direction-Tuple{MCMRSimulator.Geometries.Internal.Reflections.Reflection, Any, Any}"><code>MCMRSimulator.Geometries.Internal.Reflections.direction</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">direction(reflection, remaining_time)</code></pre><p>Returns the displacement that the spin should end up if it has <code>remaining_time</code> ms left in this timestep.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/reflections.jl#L87-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Reflections.has_hit-Tuple{MCMRSimulator.Geometries.Internal.Reflections.Reflection}" href="#MCMRSimulator.Geometries.Internal.Reflections.has_hit-Tuple{MCMRSimulator.Geometries.Internal.Reflections.Reflection}"><code>MCMRSimulator.Geometries.Internal.Reflections.has_hit</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">has_hit(reflection)</code></pre><p>Returns a tuple with the indices of the obstruction that the particle is reflecting off.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/reflections.jl#L73-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Reflections.previous_hit-Tuple{MCMRSimulator.Geometries.Internal.Reflections.Reflection}" href="#MCMRSimulator.Geometries.Internal.Reflections.previous_hit-Tuple{MCMRSimulator.Geometries.Internal.Reflections.Reflection}"><code>MCMRSimulator.Geometries.Internal.Reflections.previous_hit</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">previous_hit(reflection)</code></pre><p>Returns a tuple with the details of the previous reflection relevant for <a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.detect_intersection-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, StaticArraysCore.SVector{N}, StaticArraysCore.SVector{N}, NamedTuple, Union{Nothing, Bool}}} where N"><code>detect_intersection</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/reflections.jl#L80-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.FixedObstructionGroups" href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups"><code>MCMRSimulator.Geometries.Internal.FixedObstructionGroups</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Types:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup"><code>FixedObstructionGroup</code></a></li></ul><p>Methods:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.has_inside"><code>has_inside</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, AbstractVector, Vararg{Any}}} where N"><code>isinside</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.detect_intersection-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup{N, R, O, G} where {R&lt;:Union{Nothing, StaticArraysCore.SVector{N, Float64}}, O&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, G&lt;:MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N, O}}, StaticArraysCore.SVector{3}, StaticArraysCore.SVector{3}}, Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup{N, R, O, G} where {R&lt;:Union{Nothing, StaticArraysCore.SVector{N, Float64}}, O&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, G&lt;:MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N, O}}, StaticArraysCore.SVector{3}, StaticArraysCore.SVector{3}, Tuple{Int64, Int64, Bool}}} where N"><code>detect_intersection</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.size_scale-Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction}"><code>size_scale</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/fixed_obstruction_groups.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry" href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FixedGeometry([obstruction_groups...])</code></pre><p>A collection of <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup"><code>FixedObstructionGroup</code></a> objects each reperesenting part of the geometry.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/fixed_obstruction_groups.jl#L92-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup" href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup"><code>MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Collection of multiple base <a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction"><code>FixedObstruction</code></a> objects.</p><p>This is the main internal representation of a group of identical <a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction"><code>FixedObstruction</code></a> objects.</p><p>Properties:</p><ul><li><code>obstructions</code>: vector of the actual <a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction"><code>FixedObstruction</code></a> objects.</li><li><code>parent_index</code>: Index of this group within the larger <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>.</li><li><code>original_index</code>: Index of this group within the original user-provided geometry.</li><li><code>rotation</code>: rotation from global 3-dimensional space to the 1, 2, or 3-dimensional space of the obstructions.</li><li><code>inv_rotation</code>: inverse of the rotation above</li><li><code>grid</code>: <a href="@ref"><code>Grid</code></a> object on which the obstruction intersections have been precomputed. This speeds up the detection of intersections.</li><li><code>bounding_boxes</code>: vector of <a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox"><code>BoundingBox</code></a> objects for each obstruction. These are used to predect whether a spin could intersect with the obstruction.</li><li><code>volume</code>: R1, R2, and off-resonance properties of the spins inside the obstructions.</li><li><code>surface</code>: R1, R2, off-resonance, surface<em>density and dwell</em>time properties of particles stuck to the surface. Also, contains the permeability and surface relaxation to process collsions.</li><li><code>vertices</code>: vector of vertices (only used for a mesh).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/fixed_obstruction_groups.jl#L27-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside" href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isinside(obstruction_group, position[, stuck_to])</code></pre><p>Returns a vector of indices with all the obstructions in <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup"><code>FixedObstructionGroup</code></a> containing the <code>position</code> (in order). For obstructions with only a single inside, will return an empty vector (&quot;[]&quot;) if the particle is outside and a &quot;[0]&quot; if inside.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/fixed_obstruction_groups.jl#L120-L125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside" href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isinside(geometry, position[, stuck_reflection])</code></pre><p>Returns a vector of pairs of indices with all the obstructions in <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a> containing the <code>position</code> (in order). The first index indicates the index of the <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup"><code>FixedObstructionGroup</code></a> within the <code>geometry</code>. The second index is the index of the specific <a href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction"><code>FixedObstruction</code></a> within the obstruction group.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/fixed_obstruction_groups.jl#L165-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.FixedObstructionGroups.detect_intersection-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup{N, R, O, G} where {R&lt;:Union{Nothing, StaticArraysCore.SVector{N, Float64}}, O&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, G&lt;:MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N, O}}, StaticArraysCore.SVector{3}, StaticArraysCore.SVector{3}}, Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup{N, R, O, G} where {R&lt;:Union{Nothing, StaticArraysCore.SVector{N, Float64}}, O&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, G&lt;:MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N, O}}, StaticArraysCore.SVector{3}, StaticArraysCore.SVector{3}, Tuple{Int64, Int64, Bool}}} where N" href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.detect_intersection-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup{N, R, O, G} where {R&lt;:Union{Nothing, StaticArraysCore.SVector{N, Float64}}, O&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, G&lt;:MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N, O}}, StaticArraysCore.SVector{3}, StaticArraysCore.SVector{3}}, Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup{N, R, O, G} where {R&lt;:Union{Nothing, StaticArraysCore.SVector{N, Float64}}, O&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, G&lt;:MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N, O}}, StaticArraysCore.SVector{3}, StaticArraysCore.SVector{3}, Tuple{Int64, Int64, Bool}}} where N"><code>MCMRSimulator.Geometries.Internal.FixedObstructionGroups.detect_intersection</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">detect_intersection(obstruction_group/geometry, start, dest[, previous_intersection])</code></pre><p>Find the closest intersection between the line from <code>start</code> to <code>dest</code> and an obstruction in the <code>geometry(ies)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/fixed_obstruction_groups.jl#L183-L187">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.FixedObstructionGroups.prepare_isinside!-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup}" href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.prepare_isinside!-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup}"><code>MCMRSimulator.Geometries.Internal.FixedObstructionGroups.prepare_isinside!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_isinside!(fg::FixedObstructionGroup, )</code></pre><p>Prepare the <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup"><code>FixedObstructionGroup</code></a> for calls of <a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, AbstractVector, Vararg{Any}}} where N"><code>isinside</code></a>.</p><p>This function is not thread-safe, so it should be called before multi-threading in <code>evolve</code>. If called multiple times, it will only do the required work the first time.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/fixed_obstruction_groups.jl#L147-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.random_surface_positions-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup{N, R, O, G} where {R&lt;:Union{Nothing, StaticArraysCore.SVector{N, Float64}}, O&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, G&lt;:MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N, O}}, BoundingBox{3}, Number}} where N" href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.random_surface_positions-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup{N, R, O, G} where {R&lt;:Union{Nothing, StaticArraysCore.SVector{N, Float64}}, O&lt;:MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, G&lt;:MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N, O}}, BoundingBox{3}, Number}} where N"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.random_surface_positions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">random_surface_positions(group/geometry, bounding_box, volume_density)</code></pre><p>Randomly draws positions on the surface within the <a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox"><code>BoundingBox</code></a>. The density of points will be equal to <code>surface_density</code> * <code>volume_density</code>, where <code>surface_density</code> is either set by the <code>group</code> itself or by <code>default_surface_density</code> (which should come from <a href="@ref"><code>GlobalProperties</code></a>).</p><p>For each drawn position will return a tuple with:</p><ul><li>position: 3D in um</li><li>surface normal: 3D, normalised (always pointing inwards)</li><li>geometry_index: index of the group</li><li>obstruction_index: index of the obstruction within the group that the position is on the surface of</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/fixed_obstruction_groups.jl#L299-L311">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.HitGrids.HitGrid" href="#MCMRSimulator.Geometries.Internal.HitGrids.HitGrid"><code>MCMRSimulator.Geometries.Internal.HitGrids.HitGrid</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HitGrid(obstructions, vertices, grid_resolution[, repeats])</code></pre><p>A precomputed grid that makes it easier to compute the interactions between a trajectory and obstructions.</p><p>Predetermines the interactions between the obstructions and the grid. This is determined purely based on the bounding boxes (could be improved by considering the shape of each obstruction).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/hit_grids.jl#L13-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.HitGrids.HitGridNoRepeat" href="#MCMRSimulator.Geometries.Internal.HitGrids.HitGridNoRepeat"><code>MCMRSimulator.Geometries.Internal.HitGrids.HitGridNoRepeat</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A specific version of <a href="#MCMRSimulator.Geometries.Internal.HitGrids.HitGrid"><code>HitGrid</code></a> that is optimised for any non-repeating geometry.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/hit_grids.jl#L47-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.HitGrids.HitGridRepeat" href="#MCMRSimulator.Geometries.Internal.HitGrids.HitGridRepeat"><code>MCMRSimulator.Geometries.Internal.HitGrids.HitGridRepeat</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A specific version of <a href="#MCMRSimulator.Geometries.Internal.HitGrids.HitGrid"><code>HitGrid</code></a> that is optimised for any repeating geometry.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/hit_grids.jl#L56-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N}, StaticArraysCore.SVector{N, Float64}, Int32, Bool, NamedTuple}} where N" href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N}, StaticArraysCore.SVector{N, Float64}, Int32, Bool, NamedTuple}} where N"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isinside(grid, position)</code></pre><p>Get the indices of obstructions that contain the <code>position</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/hit_grids.jl#L203-L207">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.HitGrids.detect_intersection_grid-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N}, StaticArraysCore.SVector{N, Float64}, StaticArraysCore.SVector{N, Float64}, Int32, Bool, NamedTuple}} where N" href="#MCMRSimulator.Geometries.Internal.HitGrids.detect_intersection_grid-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N}, StaticArraysCore.SVector{N, Float64}, StaticArraysCore.SVector{N, Float64}, Int32, Bool, NamedTuple}} where N"><code>MCMRSimulator.Geometries.Internal.HitGrids.detect_intersection_grid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">detect_intersection_grid(grid, start, dest, prev_index, prev_inside, args)</code></pre><p>Computes the first intersection between the trajectory from <code>start</code> to <code>dest</code> and the obstructions stored in <code>grid</code>.</p><p>This function returns the index of the obstruction the trajectory intersects with and an <a href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections.ObstructionIntersection"><code>ObstructionIntersection</code></a> object describing the intersection in more detail. If <code>prev_index</code> is non-zero, it is assumed that the trajectory starts from hitting the obstruction with that index having hit at <code>prev_inside</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/hit_grids.jl#L239-L246">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.HitGrids.find_hits-Union{Tuple{N}, Tuple{BoundingBox{N}, Any, Any, Any}} where N" href="#MCMRSimulator.Geometries.Internal.HitGrids.find_hits-Union{Tuple{N}, Tuple{BoundingBox{N}, Any, Any, Any}} where N"><code>MCMRSimulator.Geometries.Internal.HitGrids.find_hits</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_hits(bb, dims, repeats, bounding_boxes)</code></pre><p>Find the intersections between the <code>bounding_boxes</code> and a grid with extent of bounding box <code>bb</code> and size of <code>dims</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/hit_grids.jl#L128-L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.HitGrids.obstructions-Union{Tuple{MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N, O}}, Tuple{O}, Tuple{N}} where {N, O}" href="#MCMRSimulator.Geometries.Internal.HitGrids.obstructions-Union{Tuple{MCMRSimulator.Geometries.Internal.HitGrids.HitGrid{N, O}}, Tuple{O}, Tuple{N}} where {N, O}"><code>MCMRSimulator.Geometries.Internal.HitGrids.obstructions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">obstructions(grid/fixed_obstructions)</code></pre><p>Returns a sequence of all the obstructions included in this group.</p><p>This operation is very slow and should be avoided within inner loops.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/hit_grids.jl#L29-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Properties" href="#MCMRSimulator.Geometries.Internal.Properties"><code>MCMRSimulator.Geometries.Internal.Properties</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Methods to extract properties from the <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>.</p><p>MRI properties (using <a href="#MCMRSimulator.Geometries.Internal.Properties.MRIProperties"><code>MRIProperties</code></a>):</p><ul><li><a href="#MCMRSimulator.Properties.R1"><code>R1</code></a></li><li><a href="#MCMRSimulator.Properties.R2"><code>R2</code></a></li><li><a href="#MCMRSimulator.Properties.off_resonance"><code>off_resonance</code></a></li></ul><p>Collision properties:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.Properties.permeability-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup, Int64}"><code>permeability</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Properties.surface_relaxation-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup, Int64}"><code>surface_relaxation</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Properties.surface_density-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup, Int64}"><code>surface_density</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Properties.dwell_time-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup, Int64}"><code>dwell_time</code></a></li></ul><p>Others:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.Properties.max_timestep_sticking-Tuple{NTuple{N, MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup} where N, Number, Any}"><code>max_timestep_sticking</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/properties.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Properties.MRIProperties" href="#MCMRSimulator.Geometries.Internal.Properties.MRIProperties"><code>MCMRSimulator.Geometries.Internal.Properties.MRIProperties</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MRIProperties(R1, R2, off_resonance)
MRIProperties(full_geometry, inside_geometry, global_properties, position, reflection)</code></pre><p>Determines the R1, R2, and off-resonance of a particle at given <code>position</code> and bound at <a href="#MCMRSimulator.Geometries.Internal.Reflections.Reflection"><code>Reflection</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/properties.jl#L26-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Properties.dwell_time-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup, Int64}" href="#MCMRSimulator.Geometries.Internal.Properties.dwell_time-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup, Int64}"><code>MCMRSimulator.Geometries.Internal.Properties.dwell_time</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dwell_time(geometry, reflection)</code></pre><p>Returns the dwell_time experienced by the spin hitting the surface represented by a <a href="#MCMRSimulator.Geometries.Internal.Reflections.Reflection"><code>Reflection</code></a>. The <code>geometry</code> has to be a <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/properties.jl#L81-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Properties.max_permeability_non_inf-Tuple{NTuple{N, MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup} where N}" href="#MCMRSimulator.Geometries.Internal.Properties.max_permeability_non_inf-Tuple{NTuple{N, MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup} where N}"><code>MCMRSimulator.Geometries.Internal.Properties.max_permeability_non_inf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">max_permeability_non_inf(geometry)</code></pre><p>Returns the largest permeability within the geometry that is not infinite.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/properties.jl#L121-L125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Properties.max_surface_relaxation-Tuple{NTuple{N, MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup} where N}" href="#MCMRSimulator.Geometries.Internal.Properties.max_surface_relaxation-Tuple{NTuple{N, MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup} where N}"><code>MCMRSimulator.Geometries.Internal.Properties.max_surface_relaxation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">max_surface_relaxation(geometry)</code></pre><p>Returns the largest surface relaxation parameter within the geometry.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/properties.jl#L140-L144">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Properties.max_timestep_sticking-Tuple{NTuple{N, MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup} where N, Number, Any}" href="#MCMRSimulator.Geometries.Internal.Properties.max_timestep_sticking-Tuple{NTuple{N, MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup} where N, Number, Any}"><code>MCMRSimulator.Geometries.Internal.Properties.max_timestep_sticking</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">max_timestep_sticking(geometry, diffusivity, scaling)</code></pre><p>Returns the maximum timestep that can be used while keeping log(1-<a href="#MCMRSimulator.Properties.stick_probability-NTuple{4, Number}"><code>stick_probability</code></a>) lower than <code>scaling</code></p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/properties.jl#L106-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Properties.min_dwell_time-Tuple{NTuple{N, MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup} where N}" href="#MCMRSimulator.Geometries.Internal.Properties.min_dwell_time-Tuple{NTuple{N, MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup} where N}"><code>MCMRSimulator.Geometries.Internal.Properties.min_dwell_time</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">min_dwell_time(geometry)</code></pre><p>Returns the minimum dwell time ignoring any parts of the geometry where there is no bound pool.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/properties.jl#L156-L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Properties.permeability-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup, Int64}" href="#MCMRSimulator.Geometries.Internal.Properties.permeability-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup, Int64}"><code>MCMRSimulator.Geometries.Internal.Properties.permeability</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">permeability(geometry, reflection)</code></pre><p>Returns the permeability experienced by the spin hitting the surface represented by a <a href="#MCMRSimulator.Geometries.Internal.Reflections.Reflection"><code>Reflection</code></a>. The <code>geometry</code> has to be a <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/properties.jl#L81-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Properties.surface_density-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup, Int64}" href="#MCMRSimulator.Geometries.Internal.Properties.surface_density-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup, Int64}"><code>MCMRSimulator.Geometries.Internal.Properties.surface_density</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">surface_density(geometry, reflection)</code></pre><p>Returns the surface_density experienced by the spin hitting the surface represented by a <a href="#MCMRSimulator.Geometries.Internal.Reflections.Reflection"><code>Reflection</code></a>. The <code>geometry</code> has to be a <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/properties.jl#L81-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Properties.surface_relaxation-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup, Int64}" href="#MCMRSimulator.Geometries.Internal.Properties.surface_relaxation-Tuple{MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup, Int64}"><code>MCMRSimulator.Geometries.Internal.Properties.surface_relaxation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">surface_relaxation(geometry, reflection)</code></pre><p>Returns the surface_relaxation experienced by the spin hitting the surface represented by a <a href="#MCMRSimulator.Geometries.Internal.Reflections.Reflection"><code>Reflection</code></a>. The <code>geometry</code> has to be a <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/properties.jl#L81-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Base" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Base</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Types:</p><ul><li><a href="@ref"><code>Susceptibility</code></a></li></ul><p>Methods:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility"><code>single_susceptibility</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/base.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Base.BaseSusceptibility" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base.BaseSusceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Base.BaseSusceptibility</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BaseSusceptibility{N}</code></pre><p>Parent type of all susceptibility sources. Each <code>BaseSusceptibility</code> object represents a single susceptibility source in <code>N</code>-dimensional space  (e.g., N=2 for <a href="@ref"><code>CylinderSusceptibility</code></a> or N=3 for <a href="@ref"><code>PointSusceptibility</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/base.jl#L10-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">single_susceptibility(source::BaseSusceptibility, offset, distance, stuck_to, b0_field)</code></pre><p>Computes the off-resonance field contribution from a <a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base.BaseSusceptibility"><code>BaseSusceptibility</code></a> source given:</p><ul><li><code>offset</code> vector from spin position to the centre of the <code>source</code></li><li><code>distance</code> of the spin from the source (which is the norm of <code>offset</code>)</li><li><code>stuck_to</code> <code>nothing</code> for free particle. Otherwise, boolean indicating whether the particle is stuck to the inside or outside of the obstructions it is stuck to.</li><li><code>b0_field</code> N-length vector with the magnetic field within the coordinate system of the susceptibility source</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/base.jl#L19-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility_gradient" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility_gradient"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility_gradient</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">single_susceptibility_gradient(source::BaseSusceptibility)</code></pre><p>Maximal off-resonance gradient in ppm/um produced by a single susceptibility source.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/base.jl#L30-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Cylinder.CylinderSusceptibility" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Cylinder.CylinderSusceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Cylinder.CylinderSusceptibility</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CylinderSusceptibility(radius, g_ratio, chi_I, chi_A, b0_field)</code></pre><p>Creates a cylindrical susceptibility source, which produces the intra- and extra-axonal field expected for a myelin sheath. More realistic myelin sheaths with a finite width can be modeled using <code>AnnulusSusceptibility</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/cylinder.jl#L5-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility-Tuple{MCMRSimulator.Geometries.Internal.Susceptibility.Cylinder.CylinderSusceptibility, AbstractVector, Number, Union{Nothing, Bool}, StaticArraysCore.SVector{2, Float64}}" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility-Tuple{MCMRSimulator.Geometries.Internal.Susceptibility.Cylinder.CylinderSusceptibility, AbstractVector, Number, Union{Nothing, Bool}, StaticArraysCore.SVector{2, Float64}}"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">single_susceptibility(cylinder, position, distance, stuck_to, b0_field)</code></pre><p>Computed by the hollow cylinder fiber model from (<a href="../references/#Wharton_2012">Wharton and Bowtell, 2012</a>). The myelin sheath is presumed to be an infinitely thin cylinder.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/cylinder.jl#L28-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Annulus.AnnulusSusceptibility" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Annulus.AnnulusSusceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Annulus.AnnulusSusceptibility</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AnnulusSusceptibility(inner_radius, outer_radius, chi_I, chi_A, b0_field)</code></pre><p>Creates an annular susceptibility source, which computes the off-resonance field expected for a myelin sheath.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/annulus.jl#L6-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility-Tuple{MCMRSimulator.Geometries.Internal.Susceptibility.Annulus.AnnulusSusceptibility, AbstractVector, Number, Union{Nothing, Bool}, StaticArraysCore.SVector{2, Float64}}" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility-Tuple{MCMRSimulator.Geometries.Internal.Susceptibility.Annulus.AnnulusSusceptibility, AbstractVector, Number, Union{Nothing, Bool}, StaticArraysCore.SVector{2, Float64}}"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">single_susceptibility(annulus, position, distance, stuck_inside, b0_field)</code></pre><p>Computed by the hollow cylinder fiber model from (<a href="../references/#Wharton_2012">Wharton and Bowtell, 2012</a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/annulus.jl#L35-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Triangle" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Triangle"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Triangle</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Computes the off-resonance field produced by a triangular mesh:</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/triangle.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.AnisotropicTriangleSusceptibility" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.AnisotropicTriangleSusceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.AnisotropicTriangleSusceptibility</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AnisotropicTriangleSusceptibility(full_triangle, chi_I, chi_A, b0_field)</code></pre><p>Represents a triangle with anisotropic magnetic susceptibility.</p><p>For more details on the internal representation, see <a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.TriangleSusceptibility"><code>TriangleSusceptibility</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/triangle.jl#L59-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.IsotropicTriangleSusceptibility" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.IsotropicTriangleSusceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.IsotropicTriangleSusceptibility</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">IsotropicTriangleSusceptibility(full_triangle, chi_I)</code></pre><p>Represents a triangle with isotropic magnetic susceptibility.</p><p>For more details on the internal representation, see <a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.TriangleSusceptibility"><code>TriangleSusceptibility</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/triangle.jl#L27-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.TriangleSusceptibility" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.TriangleSusceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.TriangleSusceptibility</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Parent type for each triangle in a mesh with susceptibility.</p><p>Computes the field produced by a triangular susceptibility source One triangle vertex is assumed to be at <code>vertex1</code>. Within the coordinate system defined by <code>rotation</code> the other two points are at:</p><ul><li>(0, <code>e2_shift</code>, 0)</li><li>(<code>e3_shift[1]</code>, <code>e3_shift[2]</code>, 0)</li></ul><p>There are two versions:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.IsotropicTriangleSusceptibility"><code>IsotropicTriangleSusceptibility</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.AnisotropicTriangleSusceptibility"><code>AnisotropicTriangleSusceptibility</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/triangle.jl#L12-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility-Tuple{MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.TriangleSusceptibility, AbstractVector, Number, Union{Nothing, Bool}, StaticArraysCore.SVector{3, Float64}}" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility-Tuple{MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.TriangleSusceptibility, AbstractVector, Number, Union{Nothing, Bool}, StaticArraysCore.SVector{3, Float64}}"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">single_susceptibility(triangle, position, distance[, stuck_inside])</code></pre><p>Computed using the algorithm described in (<a href="../references/#rubeckAnalyticalCalculationMagnet2013">Rubeck <em>et al.</em>, 2013</a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/triangle.jl#L119-L123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.right_angle_triangle_field-Tuple{Number, Number, Number}" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.right_angle_triangle_field-Tuple{Number, Number, Number}"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Triangle.right_angle_triangle_field</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">right_angle_triangle_field(a, b, z)</code></pre><p>Returns the magnetic field experienced at (0, 0, z) generated by a triangle with edges (0, 0, 0), (a, 0, 0), (a, b, 0). The susceptibility of the triangle is assumed to be <span>$\sigma_m = 4 \pi \mu_0$</span>.</p><p>This uses equations 8-10 from (<a href="../references/#rubeckAnalyticalCalculationMagnet2013">Rubeck <em>et al.</em>, 2013</a>). Note that these equations assume a and b to be positive.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/triangle.jl#L90-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Grid.AnisotropicSusceptibilityGridElement" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.AnisotropicSusceptibilityGridElement"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.AnisotropicSusceptibilityGridElement</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridElement"><code>SusceptibilityGridElement</code></a> with an arbitrarily oriented magnetisation.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/grid.jl#L37-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Grid.FixedSusceptibility" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.FixedSusceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.FixedSusceptibility</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Tuple containing all susceptibility sources</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/grid.jl#L104-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Grid.IsotropicSusceptibilityGridElement" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.IsotropicSusceptibilityGridElement"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.IsotropicSusceptibilityGridElement</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridElement"><code>SusceptibilityGridElement</code></a> with a magnetisation in the direction of the B0 field.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/grid.jl#L28-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGrid" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGrid"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGrid</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Precomputed off-resonance field from repeating distant sources.</p><p>In each voxel the pre-computed field is stored in <code>off_resonance</code>. The sources for which the field contribution should still be added are stored in <code>indices</code>. These are stored of vectors of <a href="@ref"><code>SuscetibilityGridElement</code></a>, where each element contains all the information to compute the dipole field approximation.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/grid.jl#L52-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridElement" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridElement"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridElement</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A simplified representation of a magnetic susceptibility obstruction, which has been simplified as a point source in N-dimensional space.</p><p>There are two versions:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.IsotropicSusceptibilityGridElement"><code>IsotropicSusceptibilityGridElement</code></a>: for objects with isotropic susceptibilities (and symmetric objects with anisotropic susceptibilities), where the magnetisation is consistently in the direction of the B0 field.</li><li><a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.AnisotropicSusceptibilityGridElement"><code>AnisotropicSusceptibilityGridElement</code></a>: for objects with anisotropic susceptibilities, where the magnetisation can be in any arbitrary orientation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/grid.jl#L10-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridNoRepeat" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridNoRepeat"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridNoRepeat</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Specialised version of <a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGrid"><code>SusceptibilityGrid</code></a> for non-repeating geometries.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/grid.jl#L84-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridRepeat" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridRepeat"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridRepeat</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Specialised version of <a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGrid"><code>SusceptibilityGrid</code></a> for repeating geometries.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/grid.jl#L64-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Grid.dipole_approximation-Tuple{Float64, StaticArraysCore.SVector{3, Float64}, Float64, StaticArraysCore.SVector{3, Float64}}" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.dipole_approximation-Tuple{Float64, StaticArraysCore.SVector{3, Float64}, Float64, StaticArraysCore.SVector{3, Float64}}"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.dipole_approximation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dipole_approximation(susceptibility, offset, distance, B0_field)
dipole_approximation(magnetisation, offset, distance, B0_field)</code></pre><p>Computes the shift in magnetic field due to a shift of susceptibility which is at the given offset (with given pre-computed distance) along the B0 field.</p><p>The <code>susceptibility</code> is given as a scalar value and is assumed to generate a field in the z-direction. The <code>magnetisation</code> is a vector representing a magnetisation in an arbitrary direction (as required for anisotropic susceptibilities).</p><p>Equations from (<a href="../references/#schenck96_role_magnet_suscep_magnet_reson_imagin">Schenck, 1996</a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/grid.jl#L163-L173">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Grid.element_susceptibility-Tuple{MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridElement, Int32, MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGrid, AbstractVector, Union{Nothing, Bool}}" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.element_susceptibility-Tuple{MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGridElement, Int32, MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGrid, AbstractVector, Union{Nothing, Bool}}"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.element_susceptibility</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">element_susceptibility(source::SuscetibilityGridElement, grid::SuscetibilityGrid, position, stuck_to)</code></pre><p>Computes the off-resonance field contribution from a <a href="@ref"><code>SuscetibilityGridElement</code></a>.</p><p>For a <code>position</code> within twice the <code>source.radius</code> of <code>source.position</code>, this will call <a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.dipole_approximation-Tuple{Float64, StaticArraysCore.SVector{3, Float64}, Float64, StaticArraysCore.SVector{3, Float64}}"><code>dipole_approximation</code></a>. For any closer <code>position</code> <a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility"><code>single_susceptibility</code></a> will be called on the appropriate element in <code>grid.sources</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/grid.jl#L254-L261">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Grid.off_resonance_gradient-Tuple{MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGrid, Any}" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.off_resonance_gradient-Tuple{MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGrid, Any}"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.off_resonance_gradient</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">off_resonance_gradient(susceptibility, B0)</code></pre><p>Maximum gradient of the off-resonance field in kHz/um due to the simulated susceptibility sources.</p><p>Internally, computed for each susceptibility sources using <a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base.single_susceptibility_gradient"><code>single_susceptibility_gradient</code></a>. The maximum out of these is returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/grid.jl#L279-L286">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Grid.susceptibility_off_resonance" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.susceptibility_off_resonance"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.susceptibility_off_resonance</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">susceptibility_off_resonance(susceptibility_grid, position[, inside])</code></pre><p>Computes the susceptibility off-resonance caused by a <a href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.SusceptibilityGrid"><code>SusceptibilityGrid</code></a> at given position.</p><p>The field is computed in ppm. Knowledge of the scanner <a href="@ref"><code>B0</code></a> is needed to convert it into KHz.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/geometries/internal/susceptibility/grid.jl#L123-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins" href="#MCMRSimulator.Spins"><code>MCMRSimulator.Spins</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Types:</p><ul><li><a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a></li><li><a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a></li><li><a href="#MCMRSimulator.Spins.SpinOrientation"><code>SpinOrientation</code></a></li><li><a href="#MCMRSimulator.Spins.FixedXoshiro"><code>FixedXoshiro</code></a></li></ul><p>Methods:</p><ul><li><a href="#MCMRSimulator.Spins.longitudinal"><code>longitudinal</code></a></li><li><a href="#MCMRSimulator.Spins.transverse"><code>transverse</code></a></li><li><a href="#MCMRSimulator.Methods.phase"><code>phase</code></a></li><li><a href="#MCMRSimulator.Spins.orientation"><code>orientation</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside-Union{Tuple{N}, Tuple{MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions.FixedObstruction{N}, AbstractVector, Vararg{Any}}} where N"><code>isinside</code></a></li><li><a href="#MCMRSimulator.Spins.stuck-Tuple{Spin}"><code>stuck</code></a></li><li><a href="#MCMRSimulator.Spins.stuck_to-Tuple{Spin, Any}"><code>stuck_to</code></a></li><li><a href="#MCMRSimulator.Spins.get_sequence-Tuple{Spin, Any}"><code>get_sequence</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.FixedXoshiro" href="#MCMRSimulator.Spins.FixedXoshiro"><code>MCMRSimulator.Spins.FixedXoshiro</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Immutable version of the Xoshiro random number generator state</p><p>Used to store the current state in the Spin object. To evolve the spin in a predictable manner set the seed using <code>copy!(spin.rng, Random.TaskLocalRNG)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L32-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.Snapshot" href="#MCMRSimulator.Spins.Snapshot"><code>MCMRSimulator.Spins.Snapshot</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Represents the positions and orientations of multiple <a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a> objects at a specific <code>time</code>.</p><p>Note that times are in milliseconds and positions in micrometer.  The equilibrium longitudinal spin (after T1 relaxation) is always 1.</p><p><strong>Useful constructors</strong></p><pre><code class="nohighlight hljs">Snapshot(positions; time=0., longitudinal=1., transverse=0., phase=0., nsequences=1)
Snapshot(nspins[, bounding_box[, geometry]]; time=0., longitudinal=1., transverse=0., phase=0., nsequences=1)
Snapshot(nspins, simulation[, bounding_box; time=0., longitudinal=1., transverse=0., phase=0., nsequences=1)</code></pre><p>Creates a new Snapshot at the given <code>time</code> with spins initialised for simulating <code>nsequences</code> sequences. All spins will start out in equilibrium, but that can be changed using the <code>longitudinal</code>, <code>transverse</code>, and/or <code>phase</code> flags. This initial spin locations are given by <code>positions</code> (Nx3 matrix or sequence of vectors of size 3). Alternatively the number of spins can be given in which case the spins are randomly distributed in the given <code>bounding_box</code> (default: 1x1x1 mm box centered on origin). The bounding_box can be a <a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox"><code>BoundingBox</code></a> object, a tuple with the lower and upper bounds (i.e., two vectors of length 3) or a number <code>r</code> (resulting in spins filling a cube from <code>-r</code> to <code>+r</code>)</p><pre><code class="nohighlight hljs">Snapshot(snap::Snapshot{1}, nsequences)</code></pre><p>Replicates the positions and orientations for a single sequence in the input snapshot across <code>nsequences</code>.</p><p><strong>Extracting summary information</strong></p><ul><li><a href="#MCMRSimulator.Spins.longitudinal"><code>longitudinal</code></a>(snapshot) to get the <code>nsequences</code> spin magnitudes in the z-direction (equilibrium of 1) averaged over all spins</li><li><a href="#MCMRSimulator.Spins.transverse"><code>transverse</code></a>(snapshot) to get the <code>nsequences</code> spin magnitudes in the x-y-plane averaged over all spins</li><li><a href="#MCMRSimulator.Methods.phase"><code>phase</code></a>(snapshot) to get the <code>nsequences</code> spin angles in x-y plane (in degrees) averaged over all spins</li><li><a href="#MCMRSimulator.Spins.orientation"><code>orientation</code></a>(snapshot) to get a (<code>nsequences</code>x3) matrix with the spin orientations in 3D space averaged over all spins</li><li><a href="#MCMRSimulator.Spins.SpinOrientation"><code>SpinOrientation</code></a>(snapshot) to get a <code>nsequences</code> vector of [<code>SpinOrientation</code>] objects with the average spin orientation across all spins</li><li><a href="#MCMRSimulator.Spins.position-Tuple{Snapshot}"><code>position</code></a>.(snapshot) to get a the position for each spin in a vector (no averaging applied)</li></ul><p>Information for a single sequence can be extracted by calling <a href="#MCMRSimulator.Spins.get_sequence-Tuple{Spin, Any}"><code>get_sequence</code></a> first.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L269-L299">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.Spin" href="#MCMRSimulator.Spins.Spin"><code>MCMRSimulator.Spins.Spin</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Spin particle with a position and <code>nsequences</code> spin orientations (stored as <a href="#MCMRSimulator.Spins.SpinOrientation"><code>SpinOrientation</code></a>).</p><p>A random number generator is stored in the <code>Spin</code> object as well, which will be used for evolving the spin into the future in a reproducible manner.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">Spin(;nsequences=1, position=[0, 0, 0], longitudinal=1., transverse=0., phase=0.)</code></pre><p>Creates a new spin with <code>nsequences</code> identical spin orientations (given by <code>longitudinal</code>, <code>transverse</code>, and <code>phase</code> flags). The spin will start at given position.</p><pre><code class="nohighlight hljs">Spin(reference_spin::Spin{1}, nsequences)</code></pre><p>Create a new spin with the same position as <code>reference_spin</code> with the orientation of <code>reference_spin</code> replicated <code>nsequences</code> times.</p><p><strong>Extracting spin information</strong></p><ul><li><a href="#MCMRSimulator.Spins.longitudinal"><code>longitudinal</code></a> to get the <code>nsequences</code> spin magnitudes in the z-direction (equilibrium of 1)</li><li><a href="#MCMRSimulator.Spins.transverse"><code>transverse</code></a> to get the <code>nsequences</code> spin magnitudes in the x-y-plane</li><li><a href="#MCMRSimulator.Methods.phase"><code>phase</code></a> to get the <code>nsequences</code> spin angles in x-y plane (in degrees)</li><li><a href="#MCMRSimulator.Spins.orientation"><code>orientation</code></a> to get a (<code>nsequences</code>x3) matrix with the spin orientations in 3D space</li><li><a href="#MCMRSimulator.Spins.position-Tuple{Snapshot}"><code>position</code></a> to get a length-3 vector with spin location</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L92-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.SpinOrientation" href="#MCMRSimulator.Spins.SpinOrientation"><code>MCMRSimulator.Spins.SpinOrientation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SpinOrientation(longitudinal, transverse, phase)</code></pre><p>The spin orientation. Usually created as part of a <a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a> object.</p><pre><code class="nohighlight hljs">SpinOrientation(snapshot::Snapshot)</code></pre><p>Returns the average spin orientations of all <a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a> objects in the <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a>.</p><p>This information can be extracted using:</p><ul><li><a href="#MCMRSimulator.Spins.longitudinal"><code>longitudinal</code></a> to get the spin in the z-direction (equilibrium of 1)</li><li><a href="#MCMRSimulator.Spins.transverse"><code>transverse</code></a> to get the spin in the x-y-plane</li><li><a href="#MCMRSimulator.Methods.phase"><code>phase</code></a> to get the spin angle in x-y plane (in degrees)</li><li><a href="#MCMRSimulator.Spins.orientation"><code>orientation</code></a> to get the spin orientation as a length-3 vector</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L60-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.SpinOrientationSum" href="#MCMRSimulator.Spins.SpinOrientationSum"><code>MCMRSimulator.Spins.SpinOrientationSum</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SpinOrientationSum(snapshot)</code></pre><p>Computes the total signal and the number of spins in a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a>. The number of spins can be found by running <code>length(spin_orientation_sum)</code>. The spin orientation information can be found in the same way as for <a href="#MCMRSimulator.Spins.SpinOrientation"><code>SpinOrientation</code></a>, namely by calling <a href="#MCMRSimulator.Spins.transverse"><code>transverse</code></a>, <a href="#MCMRSimulator.Spins.longitudinal"><code>longitudinal</code></a>, or <a href="#MCMRSimulator.Methods.phase"><code>phase</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L430-L437">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside-Tuple{Any, AbstractVector}" href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside-Tuple{Any, AbstractVector}"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isinside([geometry, ]spin)</code></pre><p>Returns vector of obstructions that the spin is inside. If <code>geometry</code> is not provided, will return a vector of indices instead. If a non-fixed <code>geometry</code> is provided, will return the number of obstructions that the spin is inside.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L256-L262">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Methods.phase" href="#MCMRSimulator.Methods.phase"><code>MCMRSimulator.Methods.phase</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">phase(spin)
phase(snapshot)</code></pre><p>Returns the phase in the x-y plane of the spin for a single particle (<a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a>) or averaged across a group of particles in a [<code>Snapshot</code>]. When orientations for multiple sequences are available  an array of phase values is returned with a value for each sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L207-L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Properties.R1" href="#MCMRSimulator.Properties.R1"><code>MCMRSimulator.Properties.R1</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">R1(snapshot, geometry, global_properties)
R1(spins, geometry, global_properties)
R1(positions, geometry, global_properties)</code></pre><p>Returns the R1 experienced by the <a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a> objects given the surface and volume properties of the <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>. Alternatively, the <code>position</code> of the spins can be provided. In that case the spins will be presumed to be free.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L364-L371">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Properties.R2" href="#MCMRSimulator.Properties.R2"><code>MCMRSimulator.Properties.R2</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">R2(snapshot, geometry, global_properties)
R2(spins, geometry, global_properties)
R2(positions, geometry, global_properties)</code></pre><p>Returns the R2 experienced by the <a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a> objects given the surface and volume properties of the <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>. Alternatively, the <code>position</code> of the spins can be provided. In that case the spins will be presumed to be free.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L364-L371">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Properties.off_resonance" href="#MCMRSimulator.Properties.off_resonance"><code>MCMRSimulator.Properties.off_resonance</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">off_resonance(snapshot, geometry, global_properties)
off_resonance(spin(s), geometry, global_properties)
off_resonance(position(s), geometry, global_properties)</code></pre><p>Computes the off-resonance field experienced by each spin in the <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a>.</p><p>A tuple is returned with:</p><ol><li>the off-resonance field due to susceptibility sources in ppm (e.g., myelin/iron).</li><li>the off-resonance field due to other sources in kHz (i.e., <code>off_resonance=...</code> set by the user).</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L395-L405">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.get_sequence-Tuple{Spin, Any}" href="#MCMRSimulator.Spins.get_sequence-Tuple{Spin, Any}"><code>MCMRSimulator.Spins.get_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_sequence(spin, sequence_index)
get_sequence(snapshot, sequence_index)</code></pre><p>Extracts the spin orientation corresponding to a specific sequence, where the sequence index uses the order in which the sequences where provided in the <code>Simulation</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L240-L245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.longitudinal" href="#MCMRSimulator.Spins.longitudinal"><code>MCMRSimulator.Spins.longitudinal</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">longitudinal(spin)
longitudinal(snapshot)</code></pre><p>Returns the longitudinal magnitude of the spin (i.e., magnitude aligned with the magnetic field) for a single particle (<a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a>) or averaged across a group of particles in a [<code>Snapshot</code>]. When orientations for multiple sequences are available an array of longitudinal values is returned with a value for each sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L189-L195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.orientation" href="#MCMRSimulator.Spins.orientation"><code>MCMRSimulator.Spins.orientation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">orientation(spin)
orientation(snapshot)</code></pre><p>Returns the spin orientation as a length-3 vector for a single particle (<a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a>) or averaged across a group of particles in a [<code>Snapshot</code>]. When orientations for multiple sequences are available an array of vectors is returned with a value for each sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L216-L222">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.position-Tuple{Snapshot}" href="#MCMRSimulator.Spins.position-Tuple{Snapshot}"><code>MCMRSimulator.Spins.position</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">position.(s::Snapshot)</code></pre><p>Returns all the positions of the spin particles as a vector of length-3 vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L471-L475">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.position-Tuple{Spin}" href="#MCMRSimulator.Spins.position-Tuple{Spin}"><code>MCMRSimulator.Spins.position</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">position(s::Spin)</code></pre><p>Returns the position of the spin particle as a vector of length 3.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L249-L253">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.stuck-Tuple{Spin}" href="#MCMRSimulator.Spins.stuck-Tuple{Spin}"><code>MCMRSimulator.Spins.stuck</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stuck(spin)</code></pre><p>Returns true if the spin is stuck on the surface. This can be used to filter a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> using:</p><pre><code class="language-julia hljs">only_stuck = filter(stuck, snapshot)
only_free = filter(s -&gt; !stuck(s), snapshot)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L141-L150">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.stuck_to-Tuple{Spin, Any}" href="#MCMRSimulator.Spins.stuck_to-Tuple{Spin, Any}"><code>MCMRSimulator.Spins.stuck_to</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stuck_to(spin, geometry)</code></pre><p>Return the internal representation of the obstruction the spin is stuck to. Raises an error if the spin is free.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L163-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.stuck_to-Tuple{Spin}" href="#MCMRSimulator.Spins.stuck_to-Tuple{Spin}"><code>MCMRSimulator.Spins.stuck_to</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stuck_to(spin)</code></pre><p>Return the indices of the obstruction the spin is stuck to. Will return (0, 0) for a free spin.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L153-L158">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.transverse" href="#MCMRSimulator.Spins.transverse"><code>MCMRSimulator.Spins.transverse</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transverse(spin)
transverse(snapshot)</code></pre><p>Returns the transverse spin (i.e., magnitude in the plane perpendicular to the magnetic field) for a single particle (<a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a>) or averaged across a group of particles in a [<code>Snapshot</code>]. When orientations for multiple sequences are available an array of transverse values is returned with a value for each sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/spins.jl#L198-L204">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.TimeSteps.TimeStep" href="#MCMRSimulator.TimeSteps.TimeStep"><code>MCMRSimulator.TimeSteps.TimeStep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Simulation(timestep=(turtoisity=3e-2, gradient=1e-4, permeability=0.5, surface_relaxation=0.01, transfer_rate=0.01, dwell_time=0.1))</code></pre><p>Creates an object controlling the timestep of the MCMR simulation.</p><p>It can be set by supplying a named tuple to the <code>timestep</code> keyword when creating a <code>Simulation</code>.</p><p>At any time the timestep is guaranteed to be shorter than:</p><ol><li><code>FullTimeStep.turtoisity_precision</code> * <code>size_scale(geometry)</code>^2 / D, where <a href="@ref"><code>size_scale</code></a> is the average size of the obstructions and <code>D</code> is the <a href="@ref"><code>diffusivity</code></a>.</li><li>timestep greater than <code>permeability</code> times 1 / (maximum permeability parameter)^2</li><li>timestep that would allow surface relaxation rate at single collision to be greater than <code>surface_relaxation</code>.</li><li>timestep that would allow magnetisation transfer rate at single collision to be greater than <code>transfer_rate</code>.</li><li>the minimum dwell time of the bound pool times <code>dwell_time</code>.</li><li>(<code>gradient</code> /( D * \gamma^2 * G^2))^(1//3), where \gamma is the <a href="#MCMRSimulator.Constants.gyromagnetic_ratio"><code>gyromagnetic_ratio</code></a> and <code>G</code> is the current <code>gradient_strength</code>.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/timesteps.jl#L5-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.TimeSteps.max_timestep_permeability-Tuple{Any, Any}" href="#MCMRSimulator.TimeSteps.max_timestep_permeability-Tuple{Any, Any}"><code>MCMRSimulator.TimeSteps.max_timestep_permeability</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">max_timestep_permeability(geometry, scaling)</code></pre><p>Compute the maximum timestep necessary to keep the probability of a spin passing through sufficiently low.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/timesteps.jl#L81-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.TimeSteps.max_timestep_surface_relaxation-Tuple{Any, Any}" href="#MCMRSimulator.TimeSteps.max_timestep_surface_relaxation-Tuple{Any, Any}"><code>MCMRSimulator.TimeSteps.max_timestep_surface_relaxation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">max_timestep_surface_relaxation(geometry, scaling)</code></pre><p>Compute the maximum timestep necessary to maintain accuracy in estimating the transverse signal loss due to surface relaxation.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/timesteps.jl#L88-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Relax.relax!-Union{Tuple{N}, Tuple{Spin{N}, Union{Nothing, Bool, StaticArraysCore.SVector{3, Float64}}, Simulation{N, NG} where NG, MCMRSimulator.SequenceParts.MultSequencePart{N, T, ST} where {T&lt;:MCMRSimulator.SequenceParts.SequencePart, ST&lt;:StaticArraysCore.StaticArray{Tuple{N}, T, 1}}, Float64, Float64, StaticArraysCore.StaticArray{Tuple{N}, Float64, 1}}} where N" href="#MCMRSimulator.Relax.relax!-Union{Tuple{N}, Tuple{Spin{N}, Union{Nothing, Bool, StaticArraysCore.SVector{3, Float64}}, Simulation{N, NG} where NG, MCMRSimulator.SequenceParts.MultSequencePart{N, T, ST} where {T&lt;:MCMRSimulator.SequenceParts.SequencePart, ST&lt;:StaticArraysCore.StaticArray{Tuple{N}, T, 1}}, Float64, Float64, StaticArraysCore.StaticArray{Tuple{N}, Float64, 1}}} where N"><code>MCMRSimulator.Relax.relax!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">relax!(spin, new_pos, simulations, sequence_parts, t1, t2, B0s)</code></pre><p>Evolves a <code>spin</code> during part of a sequence represented a <a href="#MCMRSimulator.SequenceParts.MultSequencePart"><code>MultSequencePart</code></a> (containing one <a href="#MCMRSimulator.SequenceParts.SequencePart"><code>SequencePart</code></a> for each <a href="#MCMRSimulator.Spins.SpinOrientation"><code>SpinOrientation</code></a> in the <a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a>).</p><p>The spin is evolved for the duration from <code>t1</code> and <code>t2</code>, where <code>t=0</code> corresponds to the start of the sequence part and <code>t=1</code> to the end. The spin is assumed to travel from <code>spin.position</code> to <code>new_pos</code> during this period.</p><p>The spin will precess around an effective RF pulse and relax with a given <code>R1</code> and <code>R2</code>. The R1 and R2 are determined based on the <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> parameters, potentially influenced by the geometry. The effective RF pulse is determined by the sequence and any changes in the off-resonance field due to the geometry or set in the <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/relax.jl#L16-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.SequenceParts.ConstantPulse" href="#MCMRSimulator.SequenceParts.ConstantPulse"><code>MCMRSimulator.SequenceParts.ConstantPulse</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ConstantPulse(amplitude, phase, frequency)</code></pre><p>Stores the RF pulse state during a single timestep.</p><p>It contains:</p><ul><li><code>amplitude</code> of RF pulse in kHz (assumed to be constant over the timestep).</li><li><code>phase</code> of the RF pulse at the beginning of the timestep in degrees.</li><li>off-resonance <code>frequency</code> of the RF pulse in kHz.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/sequence_parts.jl#L41-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.SequenceParts.IndexedReadout" href="#MCMRSimulator.SequenceParts.IndexedReadout"><code>MCMRSimulator.SequenceParts.IndexedReadout</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">IndexedReadout(time, TR, readout)</code></pre><p>Represents a readout in an MR sequence.</p><p>Generate these for a sequence of interest using <a href="@ref"><code>MCMRSimulator.get_readouts</code></a>.</p><p>All indices are integers. They refer to:</p><ul><li><code>time</code>: time since beginning of sequence in ms</li><li><code>TR</code>: which TR the simulation is in (defaults to 0 if not set).</li><li><code>readout</code>: which readout within the TR (or total sequence) this is.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/sequence_parts.jl#L106-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.SequenceParts.InstantSequencePart" href="#MCMRSimulator.SequenceParts.InstantSequencePart"><code>MCMRSimulator.SequenceParts.InstantSequencePart</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">InstantSequencePart(instants)</code></pre><p>A set of <code>N</code> instant pulses/gradients that should be applied to the spins.</p><p>Some of the instants might be <code>nothing</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/sequence_parts.jl#L90-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.SequenceParts.MultSequencePart" href="#MCMRSimulator.SequenceParts.MultSequencePart"><code>MCMRSimulator.SequenceParts.MultSequencePart</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MultSequencePart(duration, parts)</code></pre><p>A set of N <a href="#MCMRSimulator.SequenceParts.SequencePart"><code>SequencePart</code></a> objects representing overlapping parts of <code>N</code> sequences.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/sequence_parts.jl#L63-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.SequenceParts.SequencePart" href="#MCMRSimulator.SequenceParts.SequencePart"><code>MCMRSimulator.SequenceParts.SequencePart</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A short part of the sequence that can be handled by the simulator.</p><p>There are 4 types:</p><ul><li><a href="@ref"><code>EmptyPart</code></a>: no pulse or gradient</li><li><a href="@ref"><code>ContantPart</code></a>: no pulse; constant gradient</li><li><a href="@ref"><code>LinearPart</code></a>: no pulse; linear gradient</li><li><a href="@ref"><code>PulsePart</code></a>: RF pulse; constant gradient</li></ul><p>To break down a generic sequence in these parts will require some approximations.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/sequence_parts.jl#L9-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.SequenceParts.get_readouts-Tuple{MRIBuilder.Containers.BaseSequences.BaseSequence, Number}" href="#MCMRSimulator.SequenceParts.get_readouts-Tuple{MRIBuilder.Containers.BaseSequences.BaseSequence, Number}"><code>MCMRSimulator.SequenceParts.get_readouts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_readouts(sequence, start_time; readouts=nothing, nTR=1, skip_TR=0)</code></pre><p>Returns a iterator of the readouts (<a href="@ref"><code>MCMRSimulator.IndexedReadout</code></a> objects) that will be used for the given sequence in the simulator.</p><p>This can be used to identify which readouts will be (or have been) used in the simulation by running: <code>collect(get_readouts(sequence, snapshot.current_time; kwargs...))</code> where <code>snapshot</code> is the starting snapshot (which has a <code>current_time</code> of 0 by default) and <code>kwargs</code> are the keyword arguments used in <a href="@ref"><code>readout</code></a> (i.e., <code>readouts,</code>nTR<code>, and</code>skip_TR`).</p><p>By default the readout/ADC objects with the actual sequence definition are used. These can be overriden by <code>readouts</code>, which can be set to a vector of the timings of the readouts within each TR.</p><p><strong>Non-repeating sequences</strong></p><p>This is the behaviour if both <code>nTR</code> and <code>skip_TR</code> are not set by the user. Any readouts before the <code>start_time</code> are ignored. Any readouts after the <code>start_time</code> (whether from the <code>readouts</code> keyword or within the sequence definition) are returned.</p><p><strong>Repeating sequences</strong></p><p>This is the behaviour if either <code>nTR</code> or <code>skip_TR</code> or both are not set by the user. If at <code>start_time</code> any of the readouts in the current TR have already passed, then the readout will only start in the next TR (unless <code>skip_TR</code> is set to -1). We will skip an additional number of TRs given by <code>skip_TR</code> (default: 0). Then readouts will continue for the number of TRs given by <code>nTR</code> (default: 1).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/sequence_parts.jl#L391-L414">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Simulations.Simulation" href="#MCMRSimulator.Simulations.Simulation"><code>MCMRSimulator.Simulations.Simulation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Simulation(
    sequences; geometry=[], diffusivity=0.,
    R1=0, T1=Inf, R2=0, T2=Inf, off_resonance=0, MT_fraction=0, permeability=0,, 
    timestep=&lt;default parameters&gt;,
)</code></pre><p>Defines the setup of the simulation and stores the output of the run.</p><p><strong>Argument</strong></p><p><strong>General parameters:</strong></p><ul><li><code>sequences</code>: Vector of <a href="@ref"><code>Sequence</code></a> objects. During the spin random walk the simulation will keep track of the spin magnetisations for all of the provided sequences.</li><li><code>geometry</code>: Set of obstructions, which can be used to restrict the diffusion, produce off-resonance fields, alter the local T1/T2 relaxation, and as sources of magnetisation transfer.</li><li><code>diffusivity</code>: Rate of the random motion of the spins in um^2/ms.</li><li><code>verbose</code>: set to false to silence descriptions of the simulation parameters (default: true).</li></ul><p><strong>MRI properties</strong></p><p>These parameters determine the evolution and relaxation of the spin magnetisation.</p><ul><li><code>R1</code>/<code>T1</code>: sets the longitudinal relaxation rate (R1 in kHz) or relaxation time (T1=1/R1 in ms). This determines how fast the longitudinal magnetisation returns to its equilibrium value of 1.</li><li><code>R2</code>/<code>T2</code>: sets the transverse relaxation rate (R2 in kHz) or relaxation time (T2=1/R2 in ms). This determines how fast the transverse magnetisation is lost.</li><li><code>off_resonance</code>: Size of the off-resonance field in this voxel in kHz.</li></ul><p>These MRI properties can be overriden for spins inside the <a href="@ref"><code>ObstructionGroup</code></a> objects of the <code>geometry</code>.</p><p><strong>Collision parameters</strong></p><p>These parameters determine how parameters behave when hitting the <a href="@ref"><code>ObstructionGroup</code></a> objects of the <code>geoemtry</code>. They can be overriden for individual objects for each [<code>ObstructionGroup</code>].</p><ul><li><code>MT_fraction</code>: the fraction of magnetisation transfered between the obstruction and the water spin at each collision.</li><li><code>permeability</code>: the rate of spins passing through the surface in arbitrary units (set to infinity for fully permeable surface).</li><li><code>surface_density</code>: Density of spins stuck on the surface relative to the volume density of hte free water.</li><li><code>dwell_time</code>: Typical time that spins will stay at the surface after getting stuck.</li></ul><p>Note that <code>MT_fraction</code> and <code>permeability</code> are internally adjusted to make their effect independent of the timestep.</p><p><strong>Timestep parameters</strong></p><ul><li><code>timestep</code> controls the timepoints at which the simulation is evaluated. </li></ul><p>It can be set directly to a number or one can control the parameters as described in the documentation for <a href="#MCMRSimulator.TimeSteps.TimeStep"><code>TimeStep</code></a> (default). To override any of these parameters run: <code>timestep=(turtoisity=Inf, )</code>.  This example will ignore the turtoisity constraint (by setting the parameter to Inf).</p><p><strong>Running the simulation</strong></p><p>To run a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> of spins through the simulations you can use one of the following functions:</p><ul><li><code>evolve</code>: evolves the spins in the snapshot until a single given time and returns that state in a new <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a>.</li><li><code>readout</code>: evolves the spins to particular times in each TR and return the total signal at that time (or a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/simulations.jl#L11-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Grid.susceptibility_off_resonance-Tuple{Simulation, Spin}" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.susceptibility_off_resonance-Tuple{Simulation, Spin}"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.susceptibility_off_resonance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">susceptibility_off_resonance(simulation, spin)</code></pre><p>Computes the susceptibility off-resonance caused by all susceptibility sources in the <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> affecting the <a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a></p><p>The field is computed in ppm. Knowledge of the scanner <a href="#MCMRSimulator.Methods.B0"><code>B0</code></a> is needed to convert it into KHz.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/simulations.jl#L191-L197">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Subsets" href="#MCMRSimulator.Subsets"><code>MCMRSimulator.Subsets</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Support for selecting a subset of the total signal.</p><p>Types:</p><ul><li><a href="#MCMRSimulator.Subsets.Subset"><code>Subset</code></a></li></ul><p>Functions:</p><ul><li><a href="#MCMRSimulator.Subsets.get_subset-Tuple{AbstractVector{&lt;:Spin}, Vararg{Any}}"><code>get_subset</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/subsets.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Subsets.Subset" href="#MCMRSimulator.Subsets.Subset"><code>MCMRSimulator.Subsets.Subset</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Subset(; bound=nothing, inside=nothing, geometry_index=nothing, obstruction_index=nothing)</code></pre><p>This creates a helper object to extract a subset of a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> from the total snapshot. It defines which spins should be kept. This definition is determined by:</p><ul><li><code>bound</code>: set to true to return only bound spins, to false to return only free spins (default: whether spins are bound is not relevant).</li><li><code>inside</code>: set to true to return only spins inside the geometry, to false to return only spins outside of the geometry (default: whether spins are inside or outside is not relevant). It can also be set to a positive integer number. Only spins that are inside that exact number of obstructions will be returned.</li><li><code>geometry_index</code>: set to an index to only consider that obstruction group within the total geometry (default: consider the full geometry).</li><li><code>obstruction_index</code>: set to an index to only consider that obstruction group within the total geometry (default: consider the full geometry).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/subsets.jl#L23-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Subsets.get_subset-Tuple{AbstractVector{&lt;:Spin}, Vararg{Any}}" href="#MCMRSimulator.Subsets.get_subset-Tuple{AbstractVector{&lt;:Spin}, Vararg{Any}}"><code>MCMRSimulator.Subsets.get_subset</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_subset(snapshot, simulation, subset)
get_subset(snapshot, simulation; bound=nothing, inside=nothing, geometry_index=nothing, obstruction_index=nothing)</code></pre><p>Returns a subset of the <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> from the <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> that obey some specific properties. These properties can be either defined by a <a href="#MCMRSimulator.Subsets.Subset"><code>Subset</code></a> object or a set of keyword arguments.</p><p>These keyword arguments are:</p><ul><li><code>bound</code>: set to true to return only bound spins, to false to return only free spins (default: whether spins are bound is not relevant).</li><li><code>inside</code>: set to true to return only spins inside the geometry, to false to return only spins outside of the geometry (default: whether spins are inside or outside is not relevant). It can also be set to a positive integer number. Only spins that are inside that exact number of obstructions will be returned.</li><li><code>geometry_index</code>: set to an index to only consider that obstruction group within the total geometry (default: consider the full geometry).</li><li><code>obstruction_index</code>: set to an index to only consider that obstruction group within the total geometry (default: consider the full geometry).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/subsets.jl#L39-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve" href="#MCMRSimulator.Evolve"><code>MCMRSimulator.Evolve</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the functions that run the actual simulation:</p><ul><li><a href="#MCMRSimulator.Evolve.readout"><code>readout</code></a>: get total signal or <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> at any <a href="@ref"><code>Readout</code></a> objects in the sequences.</li><li><a href="#MCMRSimulator.Evolve.evolve-Union{Tuple{N}, Tuple{Any, Simulation{N, NG} where NG, Any}} where N"><code>evolve</code></a>: Return a single <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> with the state of the simulation at a given time. This snapshot can be used as initialisation for further runs.</li></ul><p>All of these functions call <a href="@ref"><code>evolve_to_time</code></a> under the hood to actually run the simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/evolve.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.FillerAccumulator" href="#MCMRSimulator.Evolve.FillerAccumulator"><code>MCMRSimulator.Evolve.FillerAccumulator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FillerAccumulator()</code></pre><p>An accumulator that will be used to fill any gaps in the regular grid of the readout accumulation.</p><p>After the simulation <code>nothing</code> is returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/evolve.jl#L73-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.GridAccumulator" href="#MCMRSimulator.Evolve.GridAccumulator"><code>MCMRSimulator.Evolve.GridAccumulator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GridAccumulator(simulation, start_time; kwargs...)</code></pre><p>Creates a grid of accumulators to readout the results of the <code>simulation</code> starting at <code>start_time</code> ms.</p><p>Keywords match the relevant ones described in <a href="#MCMRSimulator.Evolve.readout"><code>readout</code></a>.</p><p><strong>Properties</strong></p><ul><li><code>grid</code>: 4-dimensional grid of <a href="@ref"><code>SingleAccumulator</code></a> objects. Each dimension corresponds to a possible dimension of the <a href="#MCMRSimulator.Evolve.readout"><code>readout</code></a> output, namely:<ol><li>multiple sequences</li><li>multiple readouts in single TR</li><li>subsequent sequence repetitions</li><li>individual subsets (see <a href="#MCMRSimulator.Subsets.Subset"><code>Subset</code></a>)</li></ol></li><li><code>flatten</code>: length-4 vector of booleans indicating which dimensions should be kept when producing the output from <a href="#MCMRSimulator.Evolve.readout"><code>readout</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/evolve.jl#L83-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.ReadoutAccumulator" href="#MCMRSimulator.Evolve.ReadoutAccumulator"><code>MCMRSimulator.Evolve.ReadoutAccumulator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Supertype for any Readout accumulator.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/evolve.jl#L24-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.SnapshotAccumulator" href="#MCMRSimulator.Evolve.SnapshotAccumulator"><code>MCMRSimulator.Evolve.SnapshotAccumulator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SnapshotAccumulator(readout_time)</code></pre><p>Accumulator used to store the full spin state.</p><p>This uses a lot of memory. If you are just interested in the total signal use <a href="#MCMRSimulator.Evolve.TotalSignalAccumulator"><code>TotalSignalAccumulator</code></a> instead by setting <code>return_snapshot=false</code> in <a href="#MCMRSimulator.Evolve.readout"><code>readout</code></a>.</p><p>After the simulation a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> will be returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/evolve.jl#L51-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.TotalSignalAccumulator" href="#MCMRSimulator.Evolve.TotalSignalAccumulator"><code>MCMRSimulator.Evolve.TotalSignalAccumulator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TotalSignalAccumulator(readout_time)</code></pre><p>Accumulator used to store the total signal.</p><p>The actual state of the <code>Snapshot</code> is discarded (unlike <a href="#MCMRSimulator.Evolve.SnapshotAccumulator"><code>SnapshotAccumulator</code></a>), which can be used by setting <code>return_snapshot=true</code> in <a href="#MCMRSimulator.Evolve.readout"><code>readout</code></a>.</p><p>After the simulation a <a href="#MCMRSimulator.Spins.SpinOrientationSum"><code>SpinOrientationSum</code></a> will be returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/evolve.jl#L30-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.apply_instants!-Union{Tuple{N}, Tuple{Array{Spin{N}, 1}, MCMRSimulator.SequenceParts.InstantSequencePart{N, T, ST} where {T, ST&lt;:StaticArraysCore.StaticArray{Tuple{N}, T, 1}}, MCMRSimulator.Evolve.GridAccumulator}} where N" href="#MCMRSimulator.Evolve.apply_instants!-Union{Tuple{N}, Tuple{Array{Spin{N}, 1}, MCMRSimulator.SequenceParts.InstantSequencePart{N, T, ST} where {T, ST&lt;:StaticArraysCore.StaticArray{Tuple{N}, T, 1}}, MCMRSimulator.Evolve.GridAccumulator}} where N"><code>MCMRSimulator.Evolve.apply_instants!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_instants!(spins, instants, accumulator)</code></pre><p>Apply a set of <code>N</code> instants to a vector of spins for each of the <code>N</code> sequences being simulated.</p><p>Each instant can be:</p><ul><li><code>nothing</code>: do nothing</li><li><code>MRIBuilder.Components.InstantPulse</code>: apply RF pulse rotation</li><li><code>MRIBuilder.Components.InstantGradient</code>: add phase corresponding to gradient</li><li><code>IndexedReadout</code>: add the current snapshot to <code>accumulator</code></li></ul><p>Returns <code>true</code> if this is the final readout and we should stop.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/evolve.jl#L570-L582">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.draw_step!-Union{Tuple{N}, Tuple{Array{Spin{N}, 1}, Simulation{N, NG} where NG, MCMRSimulator.SequenceParts.MultSequencePart{N, T, ST} where {T&lt;:MCMRSimulator.SequenceParts.SequencePart, ST&lt;:StaticArraysCore.StaticArray{Tuple{N}, T, 1}}, StaticArraysCore.StaticArray{Tuple{N}, Float64, 1}}} where N" href="#MCMRSimulator.Evolve.draw_step!-Union{Tuple{N}, Tuple{Array{Spin{N}, 1}, Simulation{N, NG} where NG, MCMRSimulator.SequenceParts.MultSequencePart{N, T, ST} where {T&lt;:MCMRSimulator.SequenceParts.SequencePart, ST&lt;:StaticArraysCore.StaticArray{Tuple{N}, T, 1}}, StaticArraysCore.StaticArray{Tuple{N}, Float64, 1}}} where N"><code>MCMRSimulator.Evolve.draw_step!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">draw_step!(spin(s), simulation, mult_sequence_part, B0s)</code></pre><p>Updates the spin based on a random movement through the given geometry for a given <code>timestep</code>:</p><ul><li>draws the next location of the particle after <code>timestep</code> with given <code>simulation.diffusivity</code>.   This displacement will take into account the obstructions in <code>simulation.geometry</code>.</li><li>The spin orientation will be affected by relaxation (see <a href="#MCMRSimulator.Relax.relax!-Union{Tuple{N}, Tuple{Spin{N}, Union{Nothing, Bool, StaticArraysCore.SVector{3, Float64}}, Simulation{N, NG} where NG, MCMRSimulator.SequenceParts.MultSequencePart{N, T, ST} where {T&lt;:MCMRSimulator.SequenceParts.SequencePart, ST&lt;:StaticArraysCore.StaticArray{Tuple{N}, T, 1}}, Float64, Float64, StaticArraysCore.StaticArray{Tuple{N}, Float64, 1}}} where N"><code>relax!</code></a>) and potentially by magnetisation transfer during collisions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/evolve.jl#L440-L447">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.evolve-Union{Tuple{N}, Tuple{Any, Simulation{N, NG} where NG, Any}} where N" href="#MCMRSimulator.Evolve.evolve-Union{Tuple{N}, Tuple{Any, Simulation{N, NG} where NG, Any}} where N"><code>MCMRSimulator.Evolve.evolve</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">evolve(snapshot, simulation[, new_time]; bounding_box=&lt;1x1x1 mm box&gt;)</code></pre><p>Evolves the <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> through the <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> to a new time. Returns a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> at the new time, which can be used as a basis for further simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/evolve.jl#L381-L386">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.fix_accumulator-Tuple{MCMRSimulator.Evolve.GridAccumulator}" href="#MCMRSimulator.Evolve.fix_accumulator-Tuple{MCMRSimulator.Evolve.GridAccumulator}"><code>MCMRSimulator.Evolve.fix_accumulator</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fix_accumulator(grid_accumulator)</code></pre><p>Return the accumulated readout results as an array.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/evolve.jl#L287-L291">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.fix_accumulator-Tuple{MCMRSimulator.Evolve.TotalSignalAccumulator}" href="#MCMRSimulator.Evolve.fix_accumulator-Tuple{MCMRSimulator.Evolve.TotalSignalAccumulator}"><code>MCMRSimulator.Evolve.fix_accumulator</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fix_accumulator(single_accumulator)</code></pre><p>Return the accumulated readout results as a <code>SpinOrientationSum</code> or <code>Snapshot</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/evolve.jl#L275-L279">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.has_nwrite-Tuple{MCMRSimulator.Evolve.SingleAccumulator, Int64}" href="#MCMRSimulator.Evolve.has_nwrite-Tuple{MCMRSimulator.Evolve.SingleAccumulator, Int64}"><code>MCMRSimulator.Evolve.has_nwrite</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">has_nwrite(accumulator, target)</code></pre><p>Returns true if the number of times that each of the accumulators has been written matches <code>target</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/evolve.jl#L266-L270">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.readout" href="#MCMRSimulator.Evolve.readout"><code>MCMRSimulator.Evolve.readout</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">readout(spins, simulation[, readout_times]; bounding_box=&lt;1x1x1 mm box&gt;, skip_TR=0, nTR=1, return_snapshot=false, subset=&lt;all&gt;)</code></pre><p>Evolves a set of spins through the <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a>. Returns the total signal or a full <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> at every readout time in the simulated sequences over one or more repetition times (TRs).</p><p><strong>Positional arguments:</strong></p><ul><li><code>spins</code>: Number of spins to simulate or an already existing <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a>.</li><li><code>simulation</code>: <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> object defining the environment, scanner, and sequence(s).</li><li><code>times</code> (optional): time of the readouts relative to the start of the TR (in ms). If not provided, the times of any <a href="@ref"><code>Readout</code></a> objects in the sequence will be used (see <a href="@ref"><code>MCMRSimulator.get_readouts</code></a> for details).</li></ul><p><strong>Keyword arguments:</strong></p><ul><li><code>bounding_box</code>: size of the voxel in which the spins are initiated in um (default is 1000, corresponding to a 1x1x1 mm box centered on zero). Can be set to a <a href="@ref"><code>BoundingBox</code></a> object for more control.</li><li><code>skip_TR</code>: Number of repetition times to skip before starting the readout.    Even if set to zero (the default), the simulator will still skip the current TR before starting the readout    if the starting snapshot is from a time past one of the sequence readouts.   See <a href="@ref"><code>MCMRSimulator.get_readouts</code></a> for details.</li><li><code>nTR</code>: number of TRs for which to store the output. See <a href="@ref"><code>MCMRSimulator.get_readouts</code></a> for details.</li><li><code>return_snapshot</code>: set to true to output the state of all the spins as a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> at each readout instead of a <a href="#MCMRSimulator.Spins.SpinOrientationSum"><code>SpinOrientationSum</code></a> with the total signal.</li><li><code>subset</code>: Return the signal/snapshot for a subset of all spins. Can be set to a single or a vector of <a href="#MCMRSimulator.Subsets.Subset"><code>Subset</code></a> objects. If set to a vector, this will add an attional dimension to the output.</li></ul><p><strong>Returns</strong></p><p>The function returns an up to 3-dimensional (KxLxMxN) array, with the following dimensions:</p><ul><li><code>K</code>: the number of sequences. This dimension is not included if the simulation only contains a single sequencen (and this single sequence is not passed into the <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> as a vector).</li><li><code>L</code>: the number of readout times with a single TR. This dimension is skipped if the <code>readout_times</code> is set to a scalar number. This dimension might contain <code>nothing</code>s for sequences that contain fewer <a href="@ref"><code>Readout</code></a> objects than the maximum (<code>M</code>).</li><li><code>M</code>: the number of TRs (controlled by the <code>nTR</code> keyword). If <code>nTR</code> is not explicitly set by the user, this dimension is skipped.</li><li><code>N</code>: the number of subsets (controlled by the <code>subset</code> keyword). If <code>subset</code> is set to a single value (&lt;all&gt; by default), this dimension is skipped.</li></ul><p>By default each element of this matrix is either a <a href="#MCMRSimulator.Spins.SpinOrientationSum"><code>SpinOrientationSum</code></a> with the total signal. If <code>return_snapshot=true</code> is set, each element is the full <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/evolve.jl#L301-L330">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.readout!-Tuple{MCMRSimulator.Evolve.TotalSignalAccumulator, Vector{Spin{1}}}" href="#MCMRSimulator.Evolve.readout!-Tuple{MCMRSimulator.Evolve.TotalSignalAccumulator, Vector{Spin{1}}}"><code>MCMRSimulator.Evolve.readout!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">readout!(single_accumulator, spins)</code></pre><p>Adds the <code>spins</code> to the readout of <code>single_accumulator</code></p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/evolve.jl#L222-L226">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.readout!-Union{Tuple{N}, Tuple{MCMRSimulator.Evolve.GridAccumulator, Array{Spin{N}, 1}, Int64, MCMRSimulator.SequenceParts.IndexedReadout}} where N" href="#MCMRSimulator.Evolve.readout!-Union{Tuple{N}, Tuple{MCMRSimulator.Evolve.GridAccumulator, Array{Spin{N}, 1}, Int64, MCMRSimulator.SequenceParts.IndexedReadout}} where N"><code>MCMRSimulator.Evolve.readout!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">readout!(grid_accumulator, spins, index_sequence, readout)</code></pre><p>Adds the <code>spins</code> to the accumulators corresponding to each subset for given sequence and readout.</p><p>Returns true if this is the last readout that needs to be considered in the simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/evolve.jl#L240-L246">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.run_readout!-Union{Tuple{N}, Tuple{Snapshot{N}, Simulation{N, NG} where NG, MCMRSimulator.Evolve.GridAccumulator, Val}} where N" href="#MCMRSimulator.Evolve.run_readout!-Union{Tuple{N}, Tuple{Snapshot{N}, Simulation{N, NG} where NG, MCMRSimulator.Evolve.GridAccumulator, Val}} where N"><code>MCMRSimulator.Evolve.run_readout!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_readout!(snapshot, simulation, accumulators)</code></pre><p>Runs the simulation starting from <code>snapshot</code> and filling the <code>accumulators</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/evolve.jl#L343-L347">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Plot" href="#MCMRSimulator.Plot"><code>MCMRSimulator.Plot</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>This module contains the base plotting functions.</p><p>If <a href="https://makie.org"><code>Makie</code></a> is not installed, none of the plotting functions will work. If a Makie backend is installed and importend, concrete methods will be added to these functions by the MakieMCMRSimulator extension. This makes Makie an optional dependency of MCMRSimulator, which will only be required if you want to use the MCMRSimulator plotting capabilities.</p><p>In addition to these empty plotting functions, this module defines the <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a> for any 2D-projections and helper functions to project onto this plane.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/plot.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Plot.PlotPlane" href="#MCMRSimulator.Plot.PlotPlane"><code>MCMRSimulator.Plot.PlotPlane</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines a finite plane in the 3D space used for plotting.</p><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">PlotPlane(normal=[0, 0, 1], position=[0, 0, 0]; size=10., sizex=&lt;size&gt;, sizey=&lt;size&gt;, ngrid=100)</code></pre><p>Arguments:</p><ul><li><code>normal</code>: length-3 vector with the orientation perpendicular to the plane (default to z-direction).</li><li><code>position</code>: position of plane as a length-3 vector (defaults to origin).</li><li><code>sizex</code>: size of the plane in the x-direction (before rotating to <code>normal</code>).</li><li><code>sizey</code>: size of the plane in the y-direction (before rotating to <code>normal</code>).</li><li><code>size</code>: set default value for <code>sizex</code> and <code>sizey</code>.</li><li><code>ngrid</code>: number of grid elements to split the plane up into for plotting.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/plot.jl#L249-L262">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Plot.plot_geometry-Tuple" href="#MCMRSimulator.Plot.plot_geometry-Tuple"><code>MCMRSimulator.Plot.plot_geometry</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot([plot_plane,] geometry; kwargs...)
plot!([scene,] [plot_plane,] geometry; kwargs...)
plot_geometry([plot_plane,] geometry; kwargs...)
plot_geometry!([scene,] [plot_plane,] geometry; kwargs...)</code></pre><p>Plots a given geometry.  If a <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a> is provided the 2D projection of the geometry onto this plane is plotted. Otherwise, the geometry is plotted in 3D.</p><p>If you want to overlay the off-resonance field, call <a href="#MCMRSimulator.Plot.plot_off_resonance-Tuple"><code>plot_off_resonance</code></a> first before calling this function.</p><p>This function will only work if a <a href="https://makie.org"><code>Makie</code></a> backend is imported.</p><p><strong>Attributes</strong></p><ul><li><code>color</code>: Set the color of the lines (2D) or patches (3D). In 2D it is set to the theme&#39;s <code>linecolor</code> by default. In 3D each individual obstruction is by default plotted in a different, distinguishable color.</li><li><code>alpha</code>: Set the transparancy in a 3D plot (0 being fully transparent and 1 fully opague).</li><li><code>linewidth</code>: Set the linewidth in 2D plots.</li><li><code>linestyle</code>: Set the linestyle in 2D plots.</li></ul><p>Base.Docs.DocStr(svec(&quot;### 3D shading attributes\n\n- <code>shading = Makie.automatic</code> sets the lighting algorithm used. Options are <code>NoShading</code> (no lighting), <code>FastShading</code> (AmbientLight + PointLight) or <code>MultiLightShading</code> (Multiple lights, GLMakie only). Note that this does not affect RPRMakie.\n- <code>diffuse::Vec3f = Vec3f(1.0)</code> sets how strongly the red, green and blue channel react to diffuse (scattered) light.\n- <code>specular::Vec3f = Vec3f(0.4)</code> sets how strongly the object reflects light in the red, green and blue channels.\n- <code>shininess::Real = 32.0</code> sets how sharp the reflection is.\n- <code>backlight::Float32 = 0f0</code> sets a weight for secondary light calculation with inverted normals.\n- <code>ssao::Bool = false</code> adjusts whether the plot is rendered with ssao (screen space ambient occlusion). Note that this only makes sense in 3D plots and is only applicable with <code>fxaa = true</code>.\n&quot;), nothing, Dict{Symbol, Any}(:typesig =&gt; Tuple{Any}, :module =&gt; MakieCore, :linenumber =&gt; 150, :binding =&gt; MakieCore.shading<em>attributes!, :path =&gt; &quot;/root/.julia/packages/MakieCore/NeQjl/src/basic</em>plots.jl&quot;))</p><p>Base.Docs.DocStr(svec(&quot;### Generic attributes\n\n- <code>visible::Bool = true</code> sets whether the plot will be rendered or not.\n- <code>overdraw::Bool = false</code> sets whether the plot will draw over other plots. This specifically means ignoring depth checks in GL backends.\n- <code>transparency::Bool = false</code> adjusts how the plot deals with transparency. In GLMakie <code>transparency = true</code> results in using Order Independent Transparency.\n- <code>fxaa::Bool = true</code> adjusts whether the plot is rendered with fxaa (anti-aliasing).\n- <code>inspectable::Bool = true</code> sets whether this plot should be seen by <code>DataInspector</code>.\n- <code>depth_shift::Float32 = 0f0</code> adjusts the depth value of a plot after all other transformations, i.e. in clip space, where <code>0 &lt;= depth &lt;= 1</code>. This only applies to GLMakie and WGLMakie and can be used to adjust render order (like a tunable overdraw).\n- <code>model::Makie.Mat4f</code> sets a model matrix for the plot. This replaces adjustments made with <code>translate!</code>, <code>rotate!</code> and <code>scale!</code>.\n- <code>space::Symbol = :data</code> sets the transformation space for box encompassing the volume plot. See <code>Makie.spaces()</code> for possible inputs.\n- <code>clip_planes::Vector{Plane3f} = Plane3f[]</code>: allows you to specify up to 8 planes behind which plot objects get clipped (i.e. become invisible). By default clip planes are inherited from the parent plot or scene.\n&quot;), nothing, Dict{Symbol, Any}(:typesig =&gt; Tuple{Any}, :module =&gt; MakieCore, :linenumber =&gt; 4, :binding =&gt; MakieCore.generic<em>plot</em>attributes!, :path =&gt; &quot;/root/.julia/packages/MakieCore/NeQjl/src/basic_plots.jl&quot;))</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/plot.jl#L19-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Plot.plot_off_resonance-Tuple" href="#MCMRSimulator.Plot.plot_off_resonance-Tuple"><code>MCMRSimulator.Plot.plot_off_resonance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_off_resonance([plot_plane,] geometry; kwargs...)
plot_off_resonance!([scene,] [plot_plane,] geometry; kwargs...)</code></pre><p>Plots the off-resonance field generated by a given geometry.  If a <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a> is provided the 2D projection of the geometry onto this plane is plotted. Otherwise, the geometry is plotted in 3D.</p><p>This function will only work if a <a href="https://makie.org"><code>Makie</code></a> backend is imported.</p><p><strong>Attributes</strong></p><ul><li><code>ngrid=400</code> sets the number of points where the off-resonance field is evaluated before producing the image. Setting this to a higher number will produce a more accurate image of the off-resonance field at the cost of more computing power.</li></ul><p>Base.Docs.DocStr(svec(&quot;### Color attributes\n\n- <code>colormap::Union{Symbol, Vector{&lt;:Colorant}} = :viridis</code> sets the colormap that is sampled for numeric <code>color</code>s.\n  <code>PlotUtils.cgrad(...)</code>, <code>Makie.Reverse(any_colormap)</code> can be used as well, or any symbol from ColorBrewer or PlotUtils.\n  To see all available color gradients, you can call <code>Makie.available_gradients()</code>.\n- <code>colorscale::Function = identity</code> color transform function. Can be any function, but only works well together with <code>Colorbar</code> for <code>identity</code>, <code>log</code>, <code>log2</code>, <code>log10</code>, <code>sqrt</code>, <code>logit</code>, <code>Makie.pseudolog10</code> and <code>Makie.Symlog10</code>.\n- <code>colorrange::Tuple{&lt;:Real, &lt;:Real}</code> sets the values representing the start and end points of <code>colormap</code>.\n- <code>nan_color::Union{Symbol, &lt;:Colorant} = RGBAf(0,0,0,0)</code> sets a replacement color for <code>color = NaN</code>.\n- <code>lowclip::Union{Nothing, Symbol, &lt;:Colorant} = nothing</code> sets a color for any value below the colorrange.\n- <code>highclip::Union{Nothing, Symbol, &lt;:Colorant} = nothing</code> sets a color for any value above the colorrange.\n- <code>alpha = 1.0</code> sets the alpha value of the colormap or color attribute. Multiple alphas like in <code>plot(alpha=0.2, color=(:red, 0.5)</code>, will get multiplied.\n&quot;), nothing, Dict{Symbol, Any}(:typesig =&gt; Tuple{Any, Any}, :module =&gt; MakieCore, :linenumber =&gt; 89, :binding =&gt; MakieCore.colormap<em>attributes!, :path =&gt; &quot;/root/.julia/packages/MakieCore/NeQjl/src/basic</em>plots.jl&quot;))</p><p>Base.Docs.DocStr(svec(&quot;### Generic attributes\n\n- <code>visible::Bool = true</code> sets whether the plot will be rendered or not.\n- <code>overdraw::Bool = false</code> sets whether the plot will draw over other plots. This specifically means ignoring depth checks in GL backends.\n- <code>transparency::Bool = false</code> adjusts how the plot deals with transparency. In GLMakie <code>transparency = true</code> results in using Order Independent Transparency.\n- <code>fxaa::Bool = true</code> adjusts whether the plot is rendered with fxaa (anti-aliasing).\n- <code>inspectable::Bool = true</code> sets whether this plot should be seen by <code>DataInspector</code>.\n- <code>depth_shift::Float32 = 0f0</code> adjusts the depth value of a plot after all other transformations, i.e. in clip space, where <code>0 &lt;= depth &lt;= 1</code>. This only applies to GLMakie and WGLMakie and can be used to adjust render order (like a tunable overdraw).\n- <code>model::Makie.Mat4f</code> sets a model matrix for the plot. This replaces adjustments made with <code>translate!</code>, <code>rotate!</code> and <code>scale!</code>.\n- <code>space::Symbol = :data</code> sets the transformation space for box encompassing the volume plot. See <code>Makie.spaces()</code> for possible inputs.\n- <code>clip_planes::Vector{Plane3f} = Plane3f[]</code>: allows you to specify up to 8 planes behind which plot objects get clipped (i.e. become invisible). By default clip planes are inherited from the parent plot or scene.\n&quot;), nothing, Dict{Symbol, Any}(:typesig =&gt; Tuple{Any}, :module =&gt; MakieCore, :linenumber =&gt; 4, :binding =&gt; MakieCore.generic<em>plot</em>attributes!, :path =&gt; &quot;/root/.julia/packages/MakieCore/NeQjl/src/basic_plots.jl&quot;))</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/plot.jl#L57-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Plot.plot_sequence-Tuple" href="#MCMRSimulator.Plot.plot_sequence-Tuple"><code>MCMRSimulator.Plot.plot_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot(sequence; kwargs...)
plot!([scene,] sequence; kwargs...)
plot_sequence(sequence; kwargs...)
plot_sequence!([scene,] sequence; kwargs...)</code></pre><p>Plot the sequence diagram.</p><p>This function will only work if <a href="https://makie.org"><code>Makie</code></a> is installed and imported.</p><p><strong>Attributes</strong></p><p><strong>Line properties</strong></p><ul><li><code>linecolor</code> sets the color of the lines. If you want to set the text color to the same value, you can also use <code>color=...</code>.</li><li><code>linewidth=1.5</code> sets the width of the lines.</li><li><code>instant_width=3.</code> sets the width of any instant gradients or pulses with respect to the <code>linewidth</code>.</li><li><code>readout_linestyle</code> sets the linestyle used to mark the sequence readouts (<code>:dot</code> by default).</li></ul><p><strong>Text properties</strong></p><ul><li><code>textcolor</code> sets the color of the text. If you want to set the line color to the same value, you can also use <code>color=...</code>.</li><li><code>font</code> sets whether the rendered text is :regular, :bold, or :italic.</li><li><code>fontsize</code>: set the size of each character.</li></ul><p>Base.Docs.DocStr(svec(&quot;### Generic attributes\n\n- <code>visible::Bool = true</code> sets whether the plot will be rendered or not.\n- <code>overdraw::Bool = false</code> sets whether the plot will draw over other plots. This specifically means ignoring depth checks in GL backends.\n- <code>transparency::Bool = false</code> adjusts how the plot deals with transparency. In GLMakie <code>transparency = true</code> results in using Order Independent Transparency.\n- <code>fxaa::Bool = true</code> adjusts whether the plot is rendered with fxaa (anti-aliasing).\n- <code>inspectable::Bool = true</code> sets whether this plot should be seen by <code>DataInspector</code>.\n- <code>depth_shift::Float32 = 0f0</code> adjusts the depth value of a plot after all other transformations, i.e. in clip space, where <code>0 &lt;= depth &lt;= 1</code>. This only applies to GLMakie and WGLMakie and can be used to adjust render order (like a tunable overdraw).\n- <code>model::Makie.Mat4f</code> sets a model matrix for the plot. This replaces adjustments made with <code>translate!</code>, <code>rotate!</code> and <code>scale!</code>.\n- <code>space::Symbol = :data</code> sets the transformation space for box encompassing the volume plot. See <code>Makie.spaces()</code> for possible inputs.\n- <code>clip_planes::Vector{Plane3f} = Plane3f[]</code>: allows you to specify up to 8 planes behind which plot objects get clipped (i.e. become invisible). By default clip planes are inherited from the parent plot or scene.\n&quot;), nothing, Dict{Symbol, Any}(:typesig =&gt; Tuple{Any}, :module =&gt; MakieCore, :linenumber =&gt; 4, :binding =&gt; MakieCore.generic<em>plot</em>attributes!, :path =&gt; &quot;/root/.julia/packages/MakieCore/NeQjl/src/basic_plots.jl&quot;))</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/plot.jl#L184-L208">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Plot.plot_snapshot-Tuple" href="#MCMRSimulator.Plot.plot_snapshot-Tuple"><code>MCMRSimulator.Plot.plot_snapshot</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot([plot_plane], snapshot; kind=:scatter, kwargs...)
plot!([scene,] [plot_plane], snapshot; kind=:scatter, kwargs...)
plot_snapshot([plot_plane], snapshot; kind=:scatter, kwargs...)
plot_snapshot!([scene,] [plot_plane], snapshot; kind=:scatter, kwargs...)</code></pre><p>Plots a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> in a new plot. </p><p>The spins are plotted in 2D projected onto the <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a> if one is provided. Otherwise, the spins are plotted in 3D (does not work for <code>kind=:image</code>).</p><p>There are three kinds of snapshot plots available:</p><p><strong>Scatter plot</strong></p><p>Default (or set using <code>kind=:scatter</code>). Each spin is plotted as a point with the colour set by the transverse magnetisation. Additional keywords are passed on to <code>Makie.scatter</code> (namely, <code>marker</code>, <code>markersize</code>, <code>strokecolor</code>, <code>strokewidth</code>, <code>glowcolor</code>, <code>glowwidth</code>).</p><p><strong>Dyad plot</strong></p><p>Set using <code>kind=:dyad</code>. Each spin is plotted as a dyad. For a 2D dyad the orienation is set by the transverse magnetisation. For a 3D dyad the full magnetisation is used to set the orienation. Additional keywords are passed on to <code>Makie.arrows</code> (namely, <code>arrowsize</code>, <code>arrowhead</code>, <code>arrowtail</code>, <code>linestyle</code>, <code>lengthscale</code>, <code>quality</code>, <code>markerspace</code>, <code>diffuse</code>, <code>specular</code>, <code>shininess</code>).</p><p><strong>Image</strong></p><p>Set using <code>kind=:image</code>. The average magnetisation is plotted across the <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a>.  The colour in each pixel is set by the average transverse magnetisation of the local spins. Set <code>interpolate=false</code> to disable interpolating the colors. This plot will not work in 3D (i.e., a <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a> is required).</p><p>This function will only work if <a href="https://makie.org"><code>Makie</code></a> is installed and imported.</p><p>Base.Docs.DocStr(svec(&quot;### Generic attributes\n\n- <code>visible::Bool = true</code> sets whether the plot will be rendered or not.\n- <code>overdraw::Bool = false</code> sets whether the plot will draw over other plots. This specifically means ignoring depth checks in GL backends.\n- <code>transparency::Bool = false</code> adjusts how the plot deals with transparency. In GLMakie <code>transparency = true</code> results in using Order Independent Transparency.\n- <code>fxaa::Bool = true</code> adjusts whether the plot is rendered with fxaa (anti-aliasing).\n- <code>inspectable::Bool = true</code> sets whether this plot should be seen by <code>DataInspector</code>.\n- <code>depth_shift::Float32 = 0f0</code> adjusts the depth value of a plot after all other transformations, i.e. in clip space, where <code>0 &lt;= depth &lt;= 1</code>. This only applies to GLMakie and WGLMakie and can be used to adjust render order (like a tunable overdraw).\n- <code>model::Makie.Mat4f</code> sets a model matrix for the plot. This replaces adjustments made with <code>translate!</code>, <code>rotate!</code> and <code>scale!</code>.\n- <code>space::Symbol = :data</code> sets the transformation space for box encompassing the volume plot. See <code>Makie.spaces()</code> for possible inputs.\n- <code>clip_planes::Vector{Plane3f} = Plane3f[]</code>: allows you to specify up to 8 planes behind which plot objects get clipped (i.e. become invisible). By default clip planes are inherited from the parent plot or scene.\n&quot;), nothing, Dict{Symbol, Any}(:typesig =&gt; Tuple{Any}, :module =&gt; MakieCore, :linenumber =&gt; 4, :binding =&gt; MakieCore.generic<em>plot</em>attributes!, :path =&gt; &quot;/root/.julia/packages/MakieCore/NeQjl/src/basic_plots.jl&quot;))</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/plot.jl#L85-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Plot.plot_trajectory-Tuple" href="#MCMRSimulator.Plot.plot_trajectory-Tuple"><code>MCMRSimulator.Plot.plot_trajectory</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot([plot_plane], snapshots; kwargs...)
plot!([scene,] [plot_plane], snapshots; kwargs...)
plot_trajectory([plot_plane], snapshots; kwargs...)
plot_trajectory!([scene,] [plot_plane], snapshots; kwargs...)</code></pre><p>Plots the spin trajectory in a vector of <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> on an existing plot scene.</p><p>The spins are plotted in 2D projected onto the <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a> if one is provided. Otherwise, the spins are plotted in 3D. At each location along the trajectory, the colour is set by the transverse magnetisation. Additional keywords are passed on to <code>Makie.lines!</code>.</p><p>This function will only work if <a href="https://makie.org"><code>Makie</code></a> is installed and imported.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/plot.jl#L158-L172">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Plot.project_on_grid-Tuple{PlotPlane, Snapshot{1}, Int64}" href="#MCMRSimulator.Plot.project_on_grid-Tuple{PlotPlane, Snapshot{1}, Int64}"><code>MCMRSimulator.Plot.project_on_grid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">project_on_grid(plot_plane, snap, ngrid)</code></pre><p>Spins from the <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> are projected onto the grid defined by <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a> in two ways:</p><ul><li>along the normal spins are projected onto the plane from infinitely far (TODO: give finite extent)</li><li>in the other directions any spins are projected onto the plane using mod(position[1], <code>sizex</code>) and mod(position[2], <code>sizey</code>).   This assumes that the geometry and field repeats itself ad infinitum beyond the <code>PlotPlane</code> (TODO: allow this assumption to be turned off).</li></ul><p>In effect, this means that all spins are projected onto the <code>PlotPlane</code>. The average spin orientation in each grid cell is returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/plot.jl#L345-L353">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Plot.simulator_movie" href="#MCMRSimulator.Plot.simulator_movie"><code>MCMRSimulator.Plot.simulator_movie</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulator_movie(filename, simulation, times, size; resolution=(1600, 800), trajectory_init=30, signal_init=10000, framerate=50, plane_orientation=:z, kwargs...)</code></pre><p>Writes a movie of the <a href="@ref"><code>Simulation</code></a> to the given <code>filename</code>.</p><p>Each frame of the movie shows the <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> at given <code>times</code>. <code>size</code> is a tuple with the size of the plotted region in the x- and y-direction. If there is a repeating geometry, then it is strongly recommended to use the size of the repeat for <code>size</code>.</p><p>Keyword arguments:</p><ul><li><code>resolution</code>: pixel resolution of each frame in the movie.</li><li><code>trajectory_init</code>: how many spins to plot on each frame.</li><li><code>signal_init</code>: how many spins to use to evaluate the signal evolution.</li><li><code>framerate</code>: wait time between each subsequent frame in the movie.</li><li><code>plane_orientation</code>: orienation of the plane on which the spins are projected (see <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a>).</li></ul><p>Additional keyword arguments are passed on to <a href="@ref"><code>plot_snapshot!</code></a>.</p><p>This function will only work if <a href="https://makie.org"><code>Makie</code></a> is installed and imported.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/plot.jl#L226-L245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI" href="#MCMRSimulator.CLI"><code>MCMRSimulator.CLI</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the command line interface to MCMRSimulator.jl (<code>mcmr</code>).</p><p>Functions:</p><ul><li><a href="#MCMRSimulator.CLI.run_main"><code>run_main</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/cli.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.install_cli-Tuple{}" href="#MCMRSimulator.CLI.install_cli-Tuple{}"><code>MCMRSimulator.CLI.install_cli</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">install_cli()</code></pre><p>Installs the command line interface for </p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/cli.jl#L18-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.run_main" href="#MCMRSimulator.CLI.run_main"><code>MCMRSimulator.CLI.run_main</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_main(args=ARGS; kwargs...)</code></pre><p>Main run command for the command line interface.</p><p>Any keyword arguments are passed on to <code>ArgParse.ArgParseSettings</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/cli.jl#L77-L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.run_main_docs-Tuple{AbstractString}" href="#MCMRSimulator.CLI.run_main_docs-Tuple{AbstractString}"><code>MCMRSimulator.CLI.run_main_docs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_main_test(cmd::AbstractString)</code></pre><p>Returns markdown with the stdout and stderr produced by running <a href="#MCMRSimulator.CLI.run_main"><code>run_main</code></a> on the given command. This is used for testing of the command line interface</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/cli.jl#L141-L146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.run_main_test-Tuple{AbstractString}" href="#MCMRSimulator.CLI.run_main_test-Tuple{AbstractString}"><code>MCMRSimulator.CLI.run_main_test</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_main_test(cmd::AbstractString)</code></pre><p>Returns the stdout and stderr produced by running <a href="#MCMRSimulator.CLI.run_main"><code>run_main</code></a> on the given command. This is used for testing of the command line interface</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/cli.jl#L106-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.Geometry" href="#MCMRSimulator.CLI.Geometry"><code>MCMRSimulator.CLI.Geometry</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines command line interface for <code>mcmr geometry</code></p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/geometry.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.Geometry.get_parser-Tuple{}" href="#MCMRSimulator.CLI.Geometry.get_parser-Tuple{}"><code>MCMRSimulator.CLI.Geometry.get_parser</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_parser()</code></pre><p>Returns the parser of arguments for <code>mcmr geometry</code></p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/geometry.jl#L99-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.Geometry.parse_user_argument-Tuple{Any, Any}" href="#MCMRSimulator.CLI.Geometry.parse_user_argument-Tuple{Any, Any}"><code>MCMRSimulator.CLI.Geometry.parse_user_argument</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_user_argument(value, n_objects)</code></pre><p>Parse the user argument to something that can actually be used internally by Julia.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/geometry.jl#L244-L248">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.Geometry.run_main" href="#MCMRSimulator.CLI.Geometry.run_main"><code>MCMRSimulator.CLI.Geometry.run_main</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_main([arguments])</code></pre><p>Runs the <code>mcmr geometry</code> command line interface. The supplied arguments can be provided as a sequence of strings (as provided by the terminal) or as a dictionary (as provided by <code>ArgParse</code> after parsing). By default it is set to <code>ARGS</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/geometry.jl#L273-L280">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.Run" href="#MCMRSimulator.CLI.Run"><code>MCMRSimulator.CLI.Run</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the command line interface to <code>mcmr run</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/run.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.Run.add_init_flags!-Tuple{Any}" href="#MCMRSimulator.CLI.Run.add_init_flags!-Tuple{Any}"><code>MCMRSimulator.CLI.Run.add_init_flags!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Add initialisation flags to an argument parser.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/run.jl#L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.Run.add_output_flags!-Tuple{Any}" href="#MCMRSimulator.CLI.Run.add_output_flags!-Tuple{Any}"><code>MCMRSimulator.CLI.Run.add_output_flags!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Add output flags to an argument parser.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/run.jl#L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.Run.add_readout_flags!-Tuple{Any}" href="#MCMRSimulator.CLI.Run.add_readout_flags!-Tuple{Any}"><code>MCMRSimulator.CLI.Run.add_readout_flags!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Add readout flags to an argument parser.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/run.jl#L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.Run.add_simulation_definition!-Tuple{Any}" href="#MCMRSimulator.CLI.Run.add_simulation_definition!-Tuple{Any}"><code>MCMRSimulator.CLI.Run.add_simulation_definition!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Add simulation definition parameters to an argument parser.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/run.jl#L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.Run.get_parser-Tuple{}" href="#MCMRSimulator.CLI.Run.get_parser-Tuple{}"><code>MCMRSimulator.CLI.Run.get_parser</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_parser()</code></pre><p>Returns the parser of arguments for <code>mcmr run</code></p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/run.jl#L118-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.Run.read_bvecs-Tuple{Any}" href="#MCMRSimulator.CLI.Run.read_bvecs-Tuple{Any}"><code>MCMRSimulator.CLI.Run.read_bvecs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_bvecs(filename)</code></pre><p>Reads the bvecs into a Nx3 matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/run.jl#L133-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.Run.run_main" href="#MCMRSimulator.CLI.Run.run_main"><code>MCMRSimulator.CLI.Run.run_main</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_main([arguments])</code></pre><p>Runs the <code>mcmr run</code> command line interface. The supplied arguments can be provided as a sequence of strings (as provided by the terminal) or as a dictionary (as provided by <code>ArgParse</code> after parsing). By default it is set to <code>ARGS</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/269f8bb43f6a169f56c58b6b6c8ddf06963f9548/src/cli/run.jl#L150-L157">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../properties/">« MRI/collision properties</a><a class="docs-footer-nextpage" href="../references/">References »</a><div class="flexbox-break"></div></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 24 October 2024 16:02">Thursday 24 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

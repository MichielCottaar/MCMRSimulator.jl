<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · MCMRSimulator.jl</title><meta name="title" content="API · MCMRSimulator.jl"/><meta property="og:title" content="API · MCMRSimulator.jl"/><meta property="twitter:title" content="API · MCMRSimulator.jl"/><meta name="description" content="Documentation for MCMRSimulator.jl: a Monte Carlo MRI simulator in Julia"/><meta property="og:description" content="Documentation for MCMRSimulator.jl: a Monte Carlo MRI simulator in Julia"/><meta property="twitter:description" content="Documentation for MCMRSimulator.jl: a Monte Carlo MRI simulator in Julia"/><meta property="og:url" content="https://open.win.ox.ac.uk/pages/ndcn0236/mcmrsimulator.jl/stable/api/"/><meta property="twitter:url" content="https://open.win.ox.ac.uk/pages/ndcn0236/mcmrsimulator.jl/stable/api/"/><link rel="canonical" href="https://open.win.ox.ac.uk/pages/ndcn0236/mcmrsimulator.jl/stable/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MCMRSimulator.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../tutorial_julia/">Tutorial (Julia)</a></li><li><a class="tocitem" href="../tutorial_cli/">Tutorial (CLI)</a></li><li><a class="tocitem" href="../geometry/">Geometry</a></li><li><a class="tocitem" href="../properties/">MRI/collision properties</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Running-simulations"><span>Running simulations</span></a></li><li><a class="tocitem" href="#Creating-geometry"><span>Creating geometry</span></a></li><li><a class="tocitem" href="#Querying-simulation-output"><span>Querying simulation output</span></a></li><li><a class="tocitem" href="#Plotting"><span>Plotting</span></a></li><li><a class="tocitem" href="#Probing-MCMR-internals"><span>Probing MCMR internals</span></a></li><li><a class="tocitem" href="#Internal-modules"><span>Internal modules</span></a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl" title="View the repository"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">Repository</span></a><a class="docs-navbar-link" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/main/docs/src/api.md" title="Edit source"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="api"><a class="docs-heading-anchor" href="#api">MCMRSimulator.jl public API</a><a id="api-1"></a><a class="docs-heading-anchor-permalink" href="#api" title="Permalink"></a></h1><p>This is the public API for <a href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl">MCMRSimulator</a>. For a more user-friendly introduction, click <a href="../#Introduction">here</a>.</p><h2 id="Running-simulations"><a class="docs-heading-anchor" href="#Running-simulations">Running simulations</a><a id="Running-simulations-1"></a><a class="docs-heading-anchor-permalink" href="#Running-simulations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Simulations.Simulation" href="#MCMRSimulator.Simulations.Simulation"><code>MCMRSimulator.Simulations.Simulation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Simulation(
    sequences; geometry=[], diffusivity=0.,
    R1=0, T1=Inf, R2=0, T2=Inf, off_resonance=0, MT_fraction=0, permeability=0,, 
    timestep=&lt;default parameters&gt;,
)</code></pre><p>Defines the setup of the simulation and stores the output of the run.</p><p><strong>Argument</strong></p><p><strong>General parameters:</strong></p><ul><li><code>sequences</code>: Vector of <code>MRIBuilder.Sequence</code> objects. During the spin random walk the simulation will keep track of the spin magnetisations for all of the provided sequences.</li><li><code>geometry</code>: Set of obstructions, which can be used to restrict the diffusion, produce off-resonance fields, alter the local T1/T2 relaxation, and as sources of magnetisation transfer.</li><li><code>diffusivity</code>: Rate of the random motion of the spins in um^2/ms.</li><li><code>verbose</code>: set to false to silence descriptions of the simulation parameters (default: true).</li></ul><p><strong>MRI properties</strong></p><p>These parameters determine the evolution and relaxation of the spin magnetisation.</p><ul><li><code>R1</code>/<code>T1</code>: sets the longitudinal relaxation rate (R1 in kHz) or relaxation time (T1=1/R1 in ms). This determines how fast the longitudinal magnetisation returns to its equilibrium value of 1.</li><li><code>R2</code>/<code>T2</code>: sets the transverse relaxation rate (R2 in kHz) or relaxation time (T2=1/R2 in ms). This determines how fast the transverse magnetisation is lost.</li><li><code>off_resonance</code>: Size of the off-resonance field in this voxel in kHz.</li></ul><p>These MRI properties can be overriden for spins inside the <a href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup"><code>ObstructionGroup</code></a> objects of the <code>geometry</code>.</p><p><strong>Collision parameters</strong></p><p>These parameters determine how parameters behave when hitting the <a href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup"><code>ObstructionGroup</code></a> objects of the <code>geometry</code>. They can be overriden for individual objects for each <a href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup"><code>ObstructionGroup</code></a>.</p><ul><li><code>MT_fraction</code>: the fraction of magnetisation transfered between the obstruction and the water spin at each collision.</li><li><code>permeability</code>: the rate of spins passing through the surface in arbitrary units (set to infinity for fully permeable surface).</li><li><code>surface_density</code>: Density of spins stuck on the surface relative to the volume density of hte free water.</li><li><code>dwell_time</code>: Typical time that spins will stay at the surface after getting stuck.</li></ul><p>Note that <code>MT_fraction</code> and <code>permeability</code> are internally adjusted to make their effect independent of the timestep.</p><p><strong>Timestep parameters</strong></p><p><code>timestep</code> controls the timepoints at which the simulation is evaluated.  By default, the maximum allowable timestep will be determined by the geometry and biophysical parameters as described in <a href="#MCMRSimulator.TimeSteps.TimeStep"><code>MCMRSimulator.TimeStep</code></a>. That documentation also describes how to adjust these settings. The timestep can also be set to a number to ignore any of these parameters. Note that a too large timestep will lead to inaccurate results.</p><p><strong>Running the simulation</strong></p><p>To run a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> of spins through the simulations you can use one of the following functions:</p><ul><li><code>evolve</code>: evolves the spins in the snapshot until a single given time and returns that state in a new <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a>.</li><li><code>readout</code>: evolves the spins to particular times in each TR and return the total signal at that time (or a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/simulations.jl#L14-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.readout" href="#MCMRSimulator.Evolve.readout"><code>MCMRSimulator.Evolve.readout</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">readout(spins, simulation[, readout_times]; bounding_box=&lt;1x1x1 mm box&gt;, skip_TR=0, nTR=1, return_snapshot=false, subset=&lt;all&gt;)</code></pre><p>Evolves a set of spins through the <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a>. Returns the total signal or a full <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> at every readout time in the simulated sequences over one or more repetition times (TRs).</p><p><strong>Positional arguments:</strong></p><ul><li><code>spins</code>: Number of spins to simulate or an already existing <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a>.</li><li><code>simulation</code>: <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> object defining the environment, scanner, and sequence(s).</li><li><code>times</code> (optional): time of the readouts relative to the start of the TR (in ms). If not provided, the times of any <code>MRIBuilder.ADC</code> objects in the sequence will be used (see <a href="#MCMRSimulator.SequenceParts.get_readouts"><code>get_readouts</code></a> for details).</li></ul><p><strong>Keyword arguments:</strong></p><ul><li><code>bounding_box</code>: size of the voxel in which the spins are initiated in um (default is 1000, corresponding to a 1x1x1 mm box centered on zero). Can be set to a <a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox"><code>BoundingBox</code></a> object for more control.</li><li><code>skip_TR</code>: Number of repetition times to skip before starting the readout.    Even if set to zero (the default), the simulator will still skip the current TR before starting the readout    if the starting snapshot is from a time past one of the sequence readouts.   See <a href="#MCMRSimulator.SequenceParts.get_readouts"><code>get_readouts</code></a> for details.</li><li><code>nTR</code>: number of TRs for which to store the output. See <a href="#MCMRSimulator.SequenceParts.get_readouts"><code>get_readouts</code></a> for details.</li><li><code>return_snapshot</code>: set to true to output the state of all the spins as a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> at each readout instead of a <a href="#MCMRSimulator.Spins.SpinOrientationSum"><code>SpinOrientationSum</code></a> with the total signal.</li><li><code>subset</code>: Return the signal/snapshot for a subset of all spins. Can be set to a single or a vector of <a href="#MCMRSimulator.Subsets.Subset"><code>Subset</code></a> objects. If set to a vector, this will add an attional dimension to the output.</li></ul><p><strong>Returns</strong></p><p>The function returns an up to 3-dimensional (KxLxMxN) array, with the following dimensions:</p><ul><li><code>K</code>: the number of sequences. This dimension is not included if the simulation only contains a single sequencen (and this single sequence is not passed into the <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> as a vector).</li><li><code>L</code>: the number of readout times with a single TR. This dimension is skipped if the <code>readout_times</code> is set to a scalar number. This dimension might contain <code>nothing</code>s for sequences that contain fewer <code>Readout.ADC</code> objects than the maximum (<code>M</code>).</li><li><code>M</code>: the number of TRs (controlled by the <code>nTR</code> keyword). If <code>nTR</code> is not explicitly set by the user, this dimension is skipped.</li><li><code>N</code>: the number of subsets (controlled by the <code>subset</code> keyword). If <code>subset</code> is set to a single value (&lt;all&gt; by default), this dimension is skipped.</li></ul><p>By default each element of this matrix is either a <a href="#MCMRSimulator.Spins.SpinOrientationSum"><code>SpinOrientationSum</code></a> with the total signal. If <code>return_snapshot=true</code> is set, each element is the full <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/evolve.jl#L301-L330">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve.evolve" href="#MCMRSimulator.Evolve.evolve"><code>MCMRSimulator.Evolve.evolve</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">evolve(snapshot, simulation[, new_time]; bounding_box=&lt;1x1x1 mm box&gt;)</code></pre><p>Evolves the <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> through the <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> to a new time. Returns a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> at the new time, which can be used as a basis for further simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/evolve.jl#L381-L386">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Subsets.Subset" href="#MCMRSimulator.Subsets.Subset"><code>MCMRSimulator.Subsets.Subset</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Subset(; bound=nothing, inside=nothing, geometry_index=nothing, obstruction_index=nothing)</code></pre><p>This creates a helper object to extract a subset of a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> from the total snapshot. It defines which spins should be kept. This definition is determined by:</p><ul><li><code>bound</code>: set to true to return only bound spins, to false to return only free spins (default: whether spins are bound is not relevant).</li><li><code>inside</code>: set to true to return only spins inside the geometry, to false to return only spins outside of the geometry (default: whether spins are inside or outside is not relevant). It can also be set to a positive integer number. Only spins that are inside that exact number of obstructions will be returned.</li><li><code>geometry_index</code>: set to an index to only consider that obstruction group within the total geometry (default: consider the full geometry).</li><li><code>obstruction_index</code>: set to an index to only consider that obstruction group within the total geometry (default: consider the full geometry).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/subsets.jl#L23-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.Snapshot" href="#MCMRSimulator.Spins.Snapshot"><code>MCMRSimulator.Spins.Snapshot</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Represents the positions and orientations of multiple <a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a> objects at a specific <code>time</code>.</p><p>Note that times are in milliseconds and positions in micrometer.  The equilibrium longitudinal spin (after T1 relaxation) is always 1.</p><p><strong>Useful constructors</strong></p><pre><code class="nohighlight hljs">Snapshot(positions; time=0., longitudinal=1., transverse=0., phase=0., nsequences=1)
Snapshot(nspins[, bounding_box[, geometry]]; time=0., longitudinal=1., transverse=0., phase=0., nsequences=1)
Snapshot(nspins, simulation[, bounding_box; time=0., longitudinal=1., transverse=0., phase=0., nsequences=1)</code></pre><p>Creates a new Snapshot at the given <code>time</code> with spins initialised for simulating <code>nsequences</code> sequences. All spins will start out in equilibrium, but that can be changed using the <code>longitudinal</code>, <code>transverse</code>, and/or <code>phase</code> flags. This initial spin locations are given by <code>positions</code> (Nx3 matrix or sequence of vectors of size 3). Alternatively the number of spins can be given in which case the spins are randomly distributed in the given <code>bounding_box</code> (default: 1x1x1 mm box centered on origin). The bounding_box can be a <a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox"><code>BoundingBox</code></a> object, a tuple with the lower and upper bounds (i.e., two vectors of length 3) or a number <code>r</code> (resulting in spins filling a cube from <code>-r</code> to <code>+r</code>)</p><pre><code class="nohighlight hljs">Snapshot(snap::Snapshot{1}, nsequences)</code></pre><p>Replicates the positions and orientations for a single sequence in the input snapshot across <code>nsequences</code>.</p><p><strong>Extracting summary information</strong></p><ul><li><a href="#MCMRSimulator.Spins.longitudinal"><code>longitudinal</code></a>(snapshot) to get the <code>nsequences</code> spin magnitudes in the z-direction (equilibrium of 1) averaged over all spins</li><li><a href="#MCMRSimulator.Spins.transverse"><code>transverse</code></a>(snapshot) to get the <code>nsequences</code> spin magnitudes in the x-y-plane averaged over all spins</li><li><a href="#MCMRSimulator.Spins.phase"><code>phase</code></a>(snapshot) to get the <code>nsequences</code> spin angles in x-y plane (in degrees) averaged over all spins</li><li><a href="#MCMRSimulator.Spins.orientation"><code>orientation</code></a>(snapshot) to get a (<code>nsequences</code>x3) matrix with the spin orientations in 3D space averaged over all spins</li><li><a href="#MCMRSimulator.Spins.SpinOrientation"><code>SpinOrientation</code></a>(snapshot) to get a <code>nsequences</code> vector of [<code>SpinOrientation</code>] objects with the average spin orientation across all spins</li><li><a href="#MCMRSimulator.Spins.position"><code>position</code></a>.(snapshot) to get a the position for each spin in a vector (no averaging applied)</li></ul><p>Information for a single sequence can be extracted by calling <a href="#MCMRSimulator.Spins.get_sequence"><code>get_sequence</code></a> first.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L290-L320">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox" href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BoundingBox(lower::Vector, upper::Vector)
BoundingBox([center::Vector, ]radius::Number)</code></pre><p>Represents a box in N-dimensional space.</p><p>Check whether particles are inside using <a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside"><code>isinside</code></a>.</p><p>This can be used to define where spins should be generated in a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> (see <a href="#MCMRSimulator.Evolve.readout"><code>readout</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/bounding_boxes.jl#L14-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.Spin" href="#MCMRSimulator.Spins.Spin"><code>MCMRSimulator.Spins.Spin</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Spin particle with a position and <code>nsequences</code> spin orientations (stored as <a href="#MCMRSimulator.Spins.SpinOrientation"><code>SpinOrientation</code></a>).</p><p>A random number generator is stored in the <code>Spin</code> object as well, which will be used for evolving the spin into the future in a reproducible manner.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">Spin(;nsequences=1, position=[0, 0, 0], longitudinal=1., transverse=0., phase=0.)</code></pre><p>Creates a new spin with <code>nsequences</code> identical spin orientations (given by <code>longitudinal</code>, <code>transverse</code>, and <code>phase</code> flags). The spin will start at given position.</p><pre><code class="nohighlight hljs">Spin(reference_spin::Spin{1}, nsequences)</code></pre><p>Create a new spin with the same position as <code>reference_spin</code> with the orientation of <code>reference_spin</code> replicated <code>nsequences</code> times.</p><p><strong>Extracting spin information</strong></p><ul><li><a href="#MCMRSimulator.Spins.longitudinal"><code>longitudinal</code></a> to get the <code>nsequences</code> spin magnitudes in the z-direction (equilibrium of 1)</li><li><a href="#MCMRSimulator.Spins.transverse"><code>transverse</code></a> to get the <code>nsequences</code> spin magnitudes in the x-y-plane</li><li><a href="#MCMRSimulator.Spins.phase"><code>phase</code></a> to get the <code>nsequences</code> spin angles in x-y plane (in degrees)</li><li><a href="#MCMRSimulator.Spins.orientation"><code>orientation</code></a> to get a (<code>nsequences</code>x3) matrix with the spin orientations in 3D space</li><li><a href="#MCMRSimulator.Spins.position"><code>position</code></a> to get a length-3 vector with spin location</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L94-L115">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Subsets.get_subset" href="#MCMRSimulator.Subsets.get_subset"><code>MCMRSimulator.Subsets.get_subset</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_subset(snapshot, simulation, subset)
get_subset(snapshot, simulation; bound=nothing, inside=nothing, geometry_index=nothing, obstruction_index=nothing)</code></pre><p>Returns a subset of the <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> from the <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> that obey some specific properties. These properties can be either defined by a <a href="#MCMRSimulator.Subsets.Subset"><code>Subset</code></a> object or a set of keyword arguments.</p><p>These keyword arguments are:</p><ul><li><code>bound</code>: set to true to return only bound spins, to false to return only free spins (default: whether spins are bound is not relevant).</li><li><code>inside</code>: set to true to return only spins inside the geometry, to false to return only spins outside of the geometry (default: whether spins are inside or outside is not relevant). It can also be set to a positive integer number. Only spins that are inside that exact number of obstructions will be returned.</li><li><code>geometry_index</code>: set to an index to only consider that obstruction group within the total geometry (default: consider the full geometry).</li><li><code>obstruction_index</code>: set to an index to only consider that obstruction group within the total geometry (default: consider the full geometry).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/subsets.jl#L39-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.SpinOrientation" href="#MCMRSimulator.Spins.SpinOrientation"><code>MCMRSimulator.Spins.SpinOrientation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SpinOrientation(longitudinal, transverse, phase)</code></pre><p>The spin orientation. Usually created as part of a <a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a> object.</p><pre><code class="nohighlight hljs">SpinOrientation(snapshot::Snapshot)</code></pre><p>Returns the average spin orientations of all <a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a> objects in the <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a>.</p><p>This information can be extracted using:</p><ul><li><a href="#MCMRSimulator.Spins.longitudinal"><code>longitudinal</code></a> to get the spin in the z-direction (equilibrium of 1)</li><li><a href="#MCMRSimulator.Spins.transverse"><code>transverse</code></a> to get the spin in the x-y-plane</li><li><a href="#MCMRSimulator.Spins.phase"><code>phase</code></a> to get the spin angle in x-y plane (in degrees)</li><li><a href="#MCMRSimulator.Spins.orientation"><code>orientation</code></a> to get the spin orientation as a length-3 vector</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L60-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.SpinOrientationSum" href="#MCMRSimulator.Spins.SpinOrientationSum"><code>MCMRSimulator.Spins.SpinOrientationSum</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SpinOrientationSum(snapshot)</code></pre><p>Computes the total signal and the number of spins in a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a>. The number of spins can be found by running <code>length(spin_orientation_sum)</code>. The spin orientation information can be found in the same way as for <a href="#MCMRSimulator.Spins.SpinOrientation"><code>SpinOrientation</code></a>, namely by calling <a href="#MCMRSimulator.Spins.transverse"><code>transverse</code></a>, <a href="#MCMRSimulator.Spins.longitudinal"><code>longitudinal</code></a>, or <a href="#MCMRSimulator.Spins.phase"><code>phase</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L451-L458">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.TimeSteps.TimeStep" href="#MCMRSimulator.TimeSteps.TimeStep"><code>MCMRSimulator.TimeSteps.TimeStep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Simulation(timestep=(tortuosity=3e-2, gradient=1e-4, permeability=0.5, surface_relaxation=0.01, transfer_rate=0.01, dwell_time=0.1))</code></pre><p>Creates an object controlling the timestep of the MCMR simulation.</p><p>It can be set by supplying a named tuple to the <code>timestep</code> keyword when creating a <code>Simulation</code>.</p><p>At any time the timestep is guaranteed to be shorter than:</p><ol><li><code>tortuosity</code> * <code>size_scale(geometry)</code>^2 / D, where <code>size_scale</code> is the average size of the obstructions and <code>D</code> is the <code>diffusivity</code>.</li><li>timestep greater than <code>permeability</code> times 1 / (maximum permeability parameter)^2</li><li>timestep that would allow surface relaxation rate at single collision to be greater than <code>surface_relaxation</code>.</li><li>timestep that would allow magnetisation transfer rate at single collision to be greater than <code>transfer_rate</code>.</li><li>the minimum dwell time of the bound pool times <code>dwell_time</code>.</li><li>(<code>gradient</code> /( D * \gamma^2 * G^2))^(1//3), where \gamma is the <a href="#MCMRSimulator.Constants.gyromagnetic_ratio"><code>gyromagnetic_ratio</code></a> and <code>G</code> is the current <code>gradient_strength</code>.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/timesteps.jl#L8-L22">source</a></section></article><h2 id="Creating-geometry"><a class="docs-heading-anchor" href="#Creating-geometry">Creating geometry</a><a id="Creating-geometry-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-geometry" title="Permalink"></a></h2><h3 id="Geometry-types"><a class="docs-heading-anchor" href="#Geometry-types">Geometry types</a><a id="Geometry-types-1"></a><a class="docs-heading-anchor-permalink" href="#Geometry-types" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Annuli" href="#MCMRSimulator.Geometries.User.Obstructions.Annuli"><code>MCMRSimulator.Geometries.User.Obstructions.Annuli</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:Annuli})(; fields...)</code></pre><p>Creates a set of <a href="#MCMRSimulator.Geometries.User.Obstructions.Annulus"><code>MCMRSimulator.Annulus</code></a> objects. Fields can be set using keyword arguments. The following fields are available:</p><ul><li>inner: Radius of the inner cylinder. Field is required. Expected type: Float64.</li><li>outer: Radius of the outer cylinder. Field is required. Expected type: Float64.</li><li>myelin: Whether the annulus is myelinated. Field is required. Expected type: Bool.  default value: false</li><li>rotation: Rotation applied to all obstructions in group. Can be set to a matrix or one of :x, :y, or, :z (see <a href="#MCMRSimulator.Methods.get_rotation"><code>MCMRSimulator.get_rotation</code></a>). Field is required. Expected type: StaticArraysCore.SMatrix{3, 2, Float64, 6}.  default value: [1.0 0.0; 0.0 1.0; 0.0 0.0]</li><li>R1_inner_surface: Additional longitudinal relaxation rate (kHz). Inner_surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R1_outer_surface: Additional longitudinal relaxation rate (kHz). Outer_surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R1_inner_volume: Additional longitudinal relaxation rate (kHz). Inner_volume property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R1_outer_volume: Additional longitudinal relaxation rate (kHz). Outer_volume property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_inner_surface: Additional transverse relaxation rate (kHz). Inner_surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_outer_surface: Additional transverse relaxation rate (kHz). Outer_surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_inner_volume: Additional transverse relaxation rate (kHz). Inner_volume property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_outer_volume: Additional transverse relaxation rate (kHz). Outer_volume property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_inner_surface: Additional off-resonance field offset (kHz). Inner_surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_outer_surface: Additional off-resonance field offset (kHz). Outer_surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_inner_volume: Additional off-resonance field offset (kHz). Inner_volume property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_outer_volume: Additional off-resonance field offset (kHz). Outer_volume property. Field is required. Expected type: Float64.  default value: 0.0</li><li>position: Spatial offset of obstruction from origin. Field is required. Expected type: StaticArraysCore.MVector{2, Float64}.  default value: [0.0, 0.0]</li><li>susceptibility_iso: Isotropic component of the myelin susceptibility (in ppm). Field can be null. Expected type: Float64.  default value: -0.1</li><li>susceptibility_aniso: Anisotropic component of the myelin susceptibility (in ppm). Field can be null. Expected type: Float64.  default value: -0.1</li><li>lorentz_radius: Only compute field explicitly for a annuli with this Lorentz radius. Field can be null. Expected type: Float64.  default value: 5.0</li><li>repeats: Length scale on which the obstructions are repeated (um). Field can be null. Expected type: StaticArraysCore.MVector{2, Float64}.</li><li>use_boundingbox: Use bounding boxes for an initial filtering of possible intersections. Field can be null. Expected type: Bool.  default value: true</li><li>grid_resolution: Resolution of the grid that the volume is split up into (um). Defaults to roughly one grid element per obstruction. Field can be null. Expected type: Float64.</li><li>dwell_time_inner_surface: Average time a particle stays stuck to the surface (ms). Inner_surface property. Field can be null. Expected type: Float64.</li><li>dwell_time_outer_surface: Average time a particle stays stuck to the surface (ms). Outer_surface property. Field can be null. Expected type: Float64.</li><li>density_inner_surface: Surface density of stuck particles relative to the volume density (um). Inner_surface property. Field can be null. Expected type: Float64.</li><li>density_outer_surface: Surface density of stuck particles relative to the volume density (um). Outer_surface property. Field can be null. Expected type: Float64.</li><li>permeability_inner_surface: Rate of particle passing through the obstruction in arbitrary units. Inner_surface property. Field can be null. Expected type: Float64.</li><li>permeability_outer_surface: Rate of particle passing through the obstruction in arbitrary units. Outer_surface property. Field can be null. Expected type: Float64.</li><li>relaxation_inner_surface: Rate of signal loss at each collision. The actual signal loss at each collision is e^(-x * sqrt(t)), where x is this rate and t is the timestep. Inner_surface property. Field can be null. Expected type: Float64.</li><li>relaxation_outer_surface: Rate of signal loss at each collision. The actual signal loss at each collision is e^(-x * sqrt(t)), where x is this rate and t is the timestep. Outer_surface property. Field can be null. Expected type: Float64.</li><li>size_scale: Size of the smallest obstructions. If not set explicitly, this will be determined by the minimum radius or distance between objects (see <code>size_scale</code>). Field can be null. Expected type: Float64.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstructions.jl#L86-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Annulus" href="#MCMRSimulator.Geometries.User.Obstructions.Annulus"><code>MCMRSimulator.Geometries.User.Obstructions.Annulus</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Singular Annulus object that is obtained by indexing a <a href="#MCMRSimulator.Geometries.User.Obstructions.Annuli"><code>Annuli</code></a> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstructions.jl#L94-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Cylinders" href="#MCMRSimulator.Geometries.User.Obstructions.Cylinders"><code>MCMRSimulator.Geometries.User.Obstructions.Cylinders</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:Cylinders})(; fields...)</code></pre><p>Creates a set of <a href="#MCMRSimulator.Geometries.User.Obstructions.Cylinder"><code>MCMRSimulator.Cylinder</code></a> objects. Fields can be set using keyword arguments. The following fields are available:</p><ul><li>radius: Radius of the cylinder. Field is required. Expected type: Float64.</li><li>rotation: Rotation applied to all obstructions in group. Can be set to a matrix or one of :x, :y, or, :z (see <a href="#MCMRSimulator.Methods.get_rotation"><code>MCMRSimulator.get_rotation</code></a>). Field is required. Expected type: StaticArraysCore.SMatrix{3, 2, Float64, 6}.  default value: [1.0 0.0; 0.0 1.0; 0.0 0.0]</li><li>R1_surface: Additional longitudinal relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R1_inside: Additional longitudinal relaxation rate (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_surface: Additional transverse relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_inside: Additional transverse relaxation rate (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_surface: Additional off-resonance field offset (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_inside: Additional off-resonance field offset (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>position: Spatial offset of obstruction from origin. Field is required. Expected type: StaticArraysCore.MVector{2, Float64}.  default value: [0.0, 0.0]</li><li>g_ratio: Inner/outer radius used for susceptibility calculation Field can be null. Expected type: Float64.  default value: 1.0</li><li>susceptibility_iso: Isotropic component of the susceptibility (in ppm um). It can be calculated by multiplying the isotropic susceptibility of the simulated tissue by the thickness. Field can be null. Expected type: Float64.  default value: -0.1</li><li>susceptibility_aniso: Anisotropic component of the susceptibility (in ppm um). It can be calculated by multiplying the anisotropic susceptibility of the simulated tissue by the thickness Field can be null. Expected type: Float64.  default value: -0.1</li><li>lorentz_radius: Only compute field explicitly for cylinders with this Lorentz radius. Field can be null. Expected type: Float64.  default value: 5.0</li><li>repeats: Length scale on which the obstructions are repeated (um). Field can be null. Expected type: StaticArraysCore.MVector{2, Float64}.</li><li>use_boundingbox: Use bounding boxes for an initial filtering of possible intersections. Field can be null. Expected type: Bool.  default value: true</li><li>grid_resolution: Resolution of the grid that the volume is split up into (um). Defaults to roughly one grid element per obstruction. Field can be null. Expected type: Float64.</li><li>dwell_time: Average time a particle stays stuck to the surface (ms). Surface property. Field can be null. Expected type: Float64.</li><li>density: Surface density of stuck particles relative to the volume density (um). Surface property. Field can be null. Expected type: Float64.</li><li>permeability: Rate of particle passing through the obstruction in arbitrary units. Surface property. Field can be null. Expected type: Float64.</li><li>relaxation: Rate of signal loss at each collision. The actual signal loss at each collision is e^(-x * sqrt(t)), where x is this rate and t is the timestep. Surface property. Field can be null. Expected type: Float64.</li><li>size_scale: Size of the smallest obstructions. If not set explicitly, this will be determined by the minimum radius or distance between objects (see <code>size_scale</code>). Field can be null. Expected type: Float64.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstructions.jl#L86-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Cylinder" href="#MCMRSimulator.Geometries.User.Obstructions.Cylinder"><code>MCMRSimulator.Geometries.User.Obstructions.Cylinder</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Singular Cylinder object that is obtained by indexing a <a href="#MCMRSimulator.Geometries.User.Obstructions.Cylinders"><code>Cylinders</code></a> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstructions.jl#L94-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Walls" href="#MCMRSimulator.Geometries.User.Obstructions.Walls"><code>MCMRSimulator.Geometries.User.Obstructions.Walls</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:Walls})(; fields...)</code></pre><p>Creates a set of <a href="#MCMRSimulator.Geometries.User.Obstructions.Wall"><code>MCMRSimulator.Wall</code></a> objects. Fields can be set using keyword arguments. The following fields are available:</p><ul><li>rotation: Rotation applied to all obstructions in group. Can be set to a matrix or one of :x, :y, or, :z (see <a href="#MCMRSimulator.Methods.get_rotation"><code>MCMRSimulator.get_rotation</code></a>). Field is required. Expected type: StaticArraysCore.SMatrix{3, 1, Float64, 3}.  default value: [1.0; 0.0; 0.0;;]</li><li>R1: Additional longitudinal relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2: Additional transverse relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance: Additional off-resonance field offset (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>position: Spatial offset of obstruction from origin. Field is required. Expected type: Float64.  default value: 0.0</li><li>repeats: Length scale on which the obstructions are repeated (um). Field can be null. Expected type: StaticArraysCore.MVector{1, Float64}.</li><li>use_boundingbox: Use bounding boxes for an initial filtering of possible intersections. Field can be null. Expected type: Bool.  default value: true</li><li>grid_resolution: Resolution of the grid that the volume is split up into (um). Defaults to roughly one grid element per obstruction. Field can be null. Expected type: Float64.</li><li>dwell_time: Average time a particle stays stuck to the surface (ms). Surface property. Field can be null. Expected type: Float64.</li><li>density: Surface density of stuck particles relative to the volume density (um). Surface property. Field can be null. Expected type: Float64.</li><li>permeability: Rate of particle passing through the obstruction in arbitrary units. Surface property. Field can be null. Expected type: Float64.</li><li>relaxation: Rate of signal loss at each collision. The actual signal loss at each collision is e^(-x * sqrt(t)), where x is this rate and t is the timestep. Surface property. Field can be null. Expected type: Float64.</li><li>size_scale: Size of the smallest obstructions. If not set explicitly, this will be determined by the minimum radius or distance between objects (see <code>size_scale</code>). Field can be null. Expected type: Float64.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstructions.jl#L86-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Wall" href="#MCMRSimulator.Geometries.User.Obstructions.Wall"><code>MCMRSimulator.Geometries.User.Obstructions.Wall</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Singular Wall object that is obtained by indexing a <a href="#MCMRSimulator.Geometries.User.Obstructions.Walls"><code>Walls</code></a> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstructions.jl#L94-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Spheres" href="#MCMRSimulator.Geometries.User.Obstructions.Spheres"><code>MCMRSimulator.Geometries.User.Obstructions.Spheres</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:Spheres})(; fields...)</code></pre><p>Creates a set of <a href="#MCMRSimulator.Geometries.User.Obstructions.Sphere"><code>MCMRSimulator.Sphere</code></a> objects. Fields can be set using keyword arguments. The following fields are available:</p><ul><li>radius: Radius of the cylinder. Field is required. Expected type: Float64.</li><li>rotation: Rotation applied to all obstructions in group. Can be set to a matrix or one of :x, :y, or, :z (see <a href="#MCMRSimulator.Methods.get_rotation"><code>MCMRSimulator.get_rotation</code></a>). Field is required. Expected type: StaticArraysCore.SMatrix{3, 3, Float64, 9}.  default value: [1.0 0.0 0.0; 0.0 1.0 0.0; 0.0 0.0 1.0]</li><li>R1_surface: Additional longitudinal relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R1_inside: Additional longitudinal relaxation rate (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_surface: Additional transverse relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_inside: Additional transverse relaxation rate (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_surface: Additional off-resonance field offset (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_inside: Additional off-resonance field offset (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>position: Spatial offset of obstruction from origin. Field is required. Expected type: StaticArraysCore.MVector{3, Float64}.  default value: [0.0, 0.0, 0.0]</li><li>repeats: Length scale on which the obstructions are repeated (um). Field can be null. Expected type: StaticArraysCore.MVector{3, Float64}.</li><li>use_boundingbox: Use bounding boxes for an initial filtering of possible intersections. Field can be null. Expected type: Bool.  default value: true</li><li>grid_resolution: Resolution of the grid that the volume is split up into (um). Defaults to roughly one grid element per obstruction. Field can be null. Expected type: Float64.</li><li>dwell_time: Average time a particle stays stuck to the surface (ms). Surface property. Field can be null. Expected type: Float64.</li><li>density: Surface density of stuck particles relative to the volume density (um). Surface property. Field can be null. Expected type: Float64.</li><li>permeability: Rate of particle passing through the obstruction in arbitrary units. Surface property. Field can be null. Expected type: Float64.</li><li>relaxation: Rate of signal loss at each collision. The actual signal loss at each collision is e^(-x * sqrt(t)), where x is this rate and t is the timestep. Surface property. Field can be null. Expected type: Float64.</li><li>size_scale: Size of the smallest obstructions. If not set explicitly, this will be determined by the minimum radius or distance between objects (see <code>size_scale</code>). Field can be null. Expected type: Float64.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstructions.jl#L86-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Sphere" href="#MCMRSimulator.Geometries.User.Obstructions.Sphere"><code>MCMRSimulator.Geometries.User.Obstructions.Sphere</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Singular Sphere object that is obtained by indexing a <a href="#MCMRSimulator.Geometries.User.Obstructions.Spheres"><code>Spheres</code></a> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstructions.jl#L94-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Mesh" href="#MCMRSimulator.Geometries.User.Obstructions.Mesh"><code>MCMRSimulator.Geometries.User.Obstructions.Mesh</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:Mesh})(; fields...)</code></pre><p>Creates a set of <a href="#MCMRSimulator.Geometries.User.Obstructions.Triangle"><code>MCMRSimulator.Triangle</code></a> objects. Fields can be set using keyword arguments. The following fields are available:</p><ul><li>triangles: Each triangle is defined by 3 vertices into the mesh. Field is required. Expected type: StaticArraysCore.MVector{3, Int64}.</li><li>vertices: Positions of the corners of the triangular mesh. Field is required. Expected type: Vector{StaticArraysCore.MVector{3, Float64}}.</li><li>myelin: Whether the mesh is myelinated. Field is required. Expected type: Bool.  default value: false</li><li>rotation: Rotation applied to all obstructions in group. Can be set to a matrix or one of :x, :y, or, :z (see <a href="#MCMRSimulator.Methods.get_rotation"><code>MCMRSimulator.get_rotation</code></a>). Field is required. Expected type: StaticArraysCore.SMatrix{3, 3, Float64, 9}.  default value: [1.0 0.0 0.0; 0.0 1.0 0.0; 0.0 0.0 1.0]</li><li>R1_surface: Additional longitudinal relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R1_inside: Additional longitudinal relaxation rate (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_surface: Additional transverse relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_inside: Additional transverse relaxation rate (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_surface: Additional off-resonance field offset (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_inside: Additional off-resonance field offset (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>susceptibility_iso: Isotropic component of the susceptibility (in ppm um). It can be calculated by multiplying the isotropic susceptibility of the simulated tissue by the thickness. Field can be null. Expected type: Float64.  default value: -0.1</li><li>susceptibility_aniso: Anisotropic component of the susceptibility (in ppm um). It can be calculated by multiplying the anisotropic susceptibility of the simulated tissue by the thickness. Field can be null. Expected type: Float64.  default value: -0.1</li><li>lorentz_radius: Only compute field explicitly for triangles with this Lorentz radius. Field can be null. Expected type: Float64.  default value: 5.0</li><li>components: Which component this triangle belongs to. If not provided explicitly, this will be determined based on connectivity. Field can be null. Expected type: Int64.</li><li>repeats: Length scale on which the obstructions are repeated (um). Field can be null. Expected type: StaticArraysCore.MVector{3, Float64}.</li><li>use_boundingbox: Use bounding boxes for an initial filtering of possible intersections. Field can be null. Expected type: Bool.  default value: true</li><li>grid_resolution: Resolution of the grid that the volume is split up into (um). Defaults to roughly one grid element per obstruction. Field can be null. Expected type: Float64.</li><li>dwell_time: Average time a particle stays stuck to the surface (ms). Surface property. Field can be null. Expected type: Float64.</li><li>density: Surface density of stuck particles relative to the volume density (um). Surface property. Field can be null. Expected type: Float64.</li><li>permeability: Rate of particle passing through the obstruction in arbitrary units. Surface property. Field can be null. Expected type: Float64.</li><li>relaxation: Rate of signal loss at each collision. The actual signal loss at each collision is e^(-x * sqrt(t)), where x is this rate and t is the timestep. Surface property. Field can be null. Expected type: Float64.</li><li>size_scale: Size of the smallest obstructions. If not set explicitly, this will be determined by the minimum radius or distance between objects (see <code>size_scale</code>). Field can be null. Expected type: Float64.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstructions.jl#L86-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Triangle" href="#MCMRSimulator.Geometries.User.Obstructions.Triangle"><code>MCMRSimulator.Geometries.User.Obstructions.Triangle</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Singular Triangle object that is obtained by indexing a <a href="#MCMRSimulator.Geometries.User.Obstructions.Mesh"><code>Mesh</code></a> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstructions.jl#L94-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.BendyCylinder" href="#MCMRSimulator.Geometries.User.Obstructions.BendyCylinder"><code>MCMRSimulator.Geometries.User.Obstructions.BendyCylinder</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup{:BendyCylinder})(; fields...)</code></pre><p>Creates a set of <a href="#MCMRSimulator.Geometries.User.Obstructions.Ring"><code>MCMRSimulator.Ring</code></a> objects. Fields can be set using keyword arguments. The following fields are available:</p><ul><li>control_point: Control points defining the path of the cylinder. Field is required. Expected type: StaticArraysCore.MVector{3, Float64}.</li><li>radius: Radius at each control point. Field is required. Expected type: Float64.</li><li>spline_order: Sets the order of the b-spine interpolating between control points. Field is required. Expected type: Int64.  default value: 3</li><li>myelin: Whether the cylinder is myelinated. Field is required. Expected type: Bool.  default value: false</li><li>rotation: Rotation applied to all obstructions in group. Can be set to a matrix or one of :x, :y, or, :z (see <a href="#MCMRSimulator.Methods.get_rotation"><code>MCMRSimulator.get_rotation</code></a>). Field is required. Expected type: StaticArraysCore.SMatrix{3, 3, Float64, 9}.  default value: [1.0 0.0 0.0; 0.0 1.0 0.0; 0.0 0.0 1.0]</li><li>R1_surface: Additional longitudinal relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R1_inside: Additional longitudinal relaxation rate (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_surface: Additional transverse relaxation rate (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>R2_inside: Additional transverse relaxation rate (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_surface: Additional off-resonance field offset (kHz). Surface property. Field is required. Expected type: Float64.  default value: 0.0</li><li>off_resonance_inside: Additional off-resonance field offset (kHz). Inside property. Field is required. Expected type: Float64.  default value: 0.0</li><li>nsamples: Number of mesh vertices along each ring. Field can be null. Expected type: Int64.  default value: 100</li><li>closed: After how many repeats in each dimension does the cylinder connect with itself. If not set the cylinder is not closed. Field can be null. Expected type: StaticArraysCore.MVector{3, Int64}.</li><li>susceptibility_iso: Isotropic component of the susceptibility (in ppm um). It can be calculated by multiplying the isotropic susceptibility of the simulated tissue by the thickness. Field can be null. Expected type: Float64.  default value: -0.1</li><li>susceptibility_aniso: Anisotropic component of the susceptibility (in ppm um). It can be calculated by multiplying the anisotropic susceptibility of the simulated tissue by the thickness. Field can be null. Expected type: Float64.  default value: -0.1</li><li>lorentz_radius: Only compute field explicitly for triangles with this Lorentz radius. Field can be null. Expected type: Float64.  default value: 5.0</li><li>repeats: Length scale on which the obstructions are repeated (um). Field can be null. Expected type: StaticArraysCore.MVector{3, Float64}.</li><li>use_boundingbox: Use bounding boxes for an initial filtering of possible intersections. Field can be null. Expected type: Bool.  default value: true</li><li>grid_resolution: Resolution of the grid that the volume is split up into (um). Defaults to roughly one grid element per obstruction. Field can be null. Expected type: Float64.</li><li>dwell_time: Average time a particle stays stuck to the surface (ms). Surface property. Field can be null. Expected type: Float64.</li><li>density: Surface density of stuck particles relative to the volume density (um). Surface property. Field can be null. Expected type: Float64.</li><li>permeability: Rate of particle passing through the obstruction in arbitrary units. Surface property. Field can be null. Expected type: Float64.</li><li>relaxation: Rate of signal loss at each collision. The actual signal loss at each collision is e^(-x * sqrt(t)), where x is this rate and t is the timestep. Surface property. Field can be null. Expected type: Float64.</li><li>size_scale: Size of the smallest obstructions. If not set explicitly, this will be determined by the minimum radius or distance between objects (see <code>size_scale</code>). Field can be null. Expected type: Float64.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstructions.jl#L86-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Ring" href="#MCMRSimulator.Geometries.User.Obstructions.Ring"><code>MCMRSimulator.Geometries.User.Obstructions.Ring</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Singular Ring object that is obtained by indexing a <a href="#MCMRSimulator.Geometries.User.Obstructions.BendyCylinder"><code>BendyCylinder</code></a> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstructions.jl#L94-L96">source</a></section></article><h3 id="Geometry-helper-functions"><a class="docs-heading-anchor" href="#Geometry-helper-functions">Geometry helper functions</a><a id="Geometry-helper-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Geometry-helper-functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.LoadMesh.load_mesh" href="#MCMRSimulator.Geometries.User.LoadMesh.load_mesh"><code>MCMRSimulator.Geometries.User.LoadMesh.load_mesh</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_mesh(file)</code></pre><p>Loads a <a href="#MCMRSimulator.Geometries.User.Obstructions.Mesh"><code>Mesh</code></a> from a file.</p><p>Currently only PLY files are supported.</p><p><strong>PLY format</strong></p><p>PLY stands for Polygon File Format (http://paulbourke.net/dataformats/ply/). PLY IO is handled by PlyIO.jl (https://github.com/JuliaGeometry/PlyIO.jl).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/load_mesh.jl#L28-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.RandomDistribution.random_positions_radii" href="#MCMRSimulator.Geometries.User.RandomDistribution.random_positions_radii"><code>MCMRSimulator.Geometries.User.RandomDistribution.random_positions_radii</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">random_positions_radii(box_size, target_density, n_dimensions; distribution=Gamma, mean=1., variance=1., max_iter=1000, min_radius=0.1, max_radius=Inf)</code></pre><p>Randomly distributes circles or spheres in space.</p><p>Arguments:</p><ul><li><code>box_size</code>: Size of the infinitely repeating box of random positions</li><li><code>target_density</code>: Final density of the circles/spheres. This density will only be approximately reached</li><li><code>n_dimensions</code>: dimensionality of the space (2 for cicles; 3 for spheres)</li><li><code>distribution</code>: distribution from which the radii are drawn (from <a href="https://juliastats.org/Distributions.jl/stable/">Distributions.jl</a>)</li><li><code>mean</code>: mean of the gamma distribution (ignored if <code>distribution</code> explicitly set)</li><li><code>variance</code>: variance of the gamma distribution (ignored if <code>distribution</code> explicitly set)</li><li><code>max_iter</code>: maximum number of iterations to try to prevent the circles/spheres from overlapping. An error is raised if they still overlap after this number of iterations.</li><li><code>repulsion_strength</code>: strength of the repulsion in each step (defaults to 0.001).</li><li><code>max_iter_repulse</code>: maximum number of iterations that circles/spheres will be repulsed from each other</li><li><code>min_radius</code>: samples from the distribution below this radius will be rejected (in um).</li><li><code>max_radius</code>: samples from the distribution above this radius will be rejected (in um).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/random_distribution.jl#L119-L136">source</a></section></article><h2 id="Querying-simulation-output"><a class="docs-heading-anchor" href="#Querying-simulation-output">Querying simulation output</a><a id="Querying-simulation-output-1"></a><a class="docs-heading-anchor-permalink" href="#Querying-simulation-output" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.position" href="#MCMRSimulator.Spins.position"><code>MCMRSimulator.Spins.position</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">position(s::Spin)</code></pre><p>Returns the position of the spin particle as a vector of length 3.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L270-L274">source</a></section><section><div><pre><code class="language-julia hljs">position.(s::Snapshot)</code></pre><p>Returns all the positions of the spin particles as a vector of length-3 vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L492-L496">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.longitudinal" href="#MCMRSimulator.Spins.longitudinal"><code>MCMRSimulator.Spins.longitudinal</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">longitudinal(spin)
longitudinal(snapshot)</code></pre><p>Returns the longitudinal magnitude of the spin (i.e., magnitude aligned with the magnetic field) for a single particle (<a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a>) or averaged across a group of particles in a [<code>Snapshot</code>]. When orientations for multiple sequences are available an array of longitudinal values is returned with a value for each sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L210-L216">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.transverse" href="#MCMRSimulator.Spins.transverse"><code>MCMRSimulator.Spins.transverse</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transverse(spin)
transverse(snapshot)</code></pre><p>Returns the transverse spin (i.e., magnitude in the plane perpendicular to the magnetic field) for a single particle (<a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a>) or averaged across a group of particles in a [<code>Snapshot</code>]. When orientations for multiple sequences are available an array of transverse values is returned with a value for each sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L219-L225">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.phase" href="#MCMRSimulator.Spins.phase"><code>MCMRSimulator.Spins.phase</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">phase(spin)
phase(snapshot)</code></pre><p>Returns the phase in the x-y plane of the spin for a single particle (<a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a>) or averaged across a group of particles in a [<code>Snapshot</code>]. When orientations for multiple sequences are available  an array of phase values is returned with a value for each sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L228-L234">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.orientation" href="#MCMRSimulator.Spins.orientation"><code>MCMRSimulator.Spins.orientation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">orientation(spin)
orientation(snapshot)</code></pre><p>Returns the spin orientation as a length-3 vector for a single particle (<a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a>) or averaged across a group of particles in a [<code>Snapshot</code>]. When orientations for multiple sequences are available an array of vectors is returned with a value for each sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L237-L243">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.get_sequence" href="#MCMRSimulator.Spins.get_sequence"><code>MCMRSimulator.Spins.get_sequence</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_sequence(spin, sequence_index)
get_sequence(snapshot, sequence_index)</code></pre><p>Extracts the spin orientation corresponding to a specific sequence, where the sequence index uses the order in which the sequences where provided in the <code>Simulation</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L261-L266">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside" href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isinside(obstruction, position)</code></pre><p>Returns true if the <code>position</code> is inside the <code>obstruction</code>. This will be inaccurate if the particle with that position is stuck on the surface of the obstruction.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/obstructions/fixed_obstructions.jl#L75-L80">source</a></section><section><div><pre><code class="language-julia hljs">isinside([geometry, ]spin)</code></pre><p>Returns vector of obstructions that the spin is inside. If <code>geometry</code> is not provided, will return a vector of indices instead. If a non-fixed <code>geometry</code> is provided, will return the number of obstructions that the spin is inside.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L277-L283">source</a></section><section><div><pre><code class="language-julia hljs">isinside(grid, position)</code></pre><p>Get the indices of obstructions that contain the <code>position</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/hit_grids.jl#L208-L212">source</a></section><section><div><pre><code class="language-julia hljs">isinside(obstruction_group, position[, stuck_to])</code></pre><p>Returns a vector of indices with all the obstructions in <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup"><code>FixedObstructionGroup</code></a> containing the <code>position</code> (in order). For obstructions with only a single inside, will return an empty vector (&quot;[]&quot;) if the particle is outside and a &quot;[0]&quot; if inside.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/fixed_obstruction_groups.jl#L122-L127">source</a></section><section><div><pre><code class="language-julia hljs">isinside(geometry, position[, stuck_reflection])</code></pre><p>Returns a vector of pairs of indices with all the obstructions in <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a> containing the <code>position</code> (in order). The first index indicates the index of the <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup"><code>FixedObstructionGroup</code></a> within the <code>geometry</code>. The second index is the index of the specific <code>FixedObstruction</code> within the obstruction group.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/fixed_obstruction_groups.jl#L167-L173">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.stuck" href="#MCMRSimulator.Spins.stuck"><code>MCMRSimulator.Spins.stuck</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stuck(spin)</code></pre><p>Returns true if the spin is stuck on the surface. This can be used to filter a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> using:</p><pre><code class="language-julia hljs">only_stuck = filter(stuck, snapshot)
only_free = filter(s -&gt; !stuck(s), snapshot)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L162-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins.stuck_to" href="#MCMRSimulator.Spins.stuck_to"><code>MCMRSimulator.Spins.stuck_to</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stuck_to(spin)</code></pre><p>Return the indices of the obstruction the spin is stuck to. Will return (0, 0) for a free spin.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L174-L179">source</a></section><section><div><pre><code class="language-julia hljs">stuck_to(spin, geometry)</code></pre><p>Return the internal representation of the obstruction the spin is stuck to. Raises an error if the spin is free.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L184-L189">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Methods.get_time" href="#MCMRSimulator.Methods.get_time"><code>MCMRSimulator.Methods.get_time</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_time(snapshot)
get_time(sequence_component)
get_time(sequence, sequence_index)</code></pre><p>Returns the time in milliseconds that a snapshot was taken or that a sequence component will have effect.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/methods.jl#L15-L21">source</a></section></article><h2 id="Plotting"><a class="docs-heading-anchor" href="#Plotting">Plotting</a><a id="Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Plot.PlotPlane" href="#MCMRSimulator.Plot.PlotPlane"><code>MCMRSimulator.Plot.PlotPlane</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines a finite plane in the 3D space used for plotting.</p><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">PlotPlane(normal=[0, 0, 1], position=[0, 0, 0]; size=10., sizex=&lt;size&gt;, sizey=&lt;size&gt;, ngrid=100)</code></pre><p>Arguments:</p><ul><li><code>normal</code>: length-3 vector with the orientation perpendicular to the plane (default to z-direction).</li><li><code>position</code>: position of plane as a length-3 vector (defaults to origin).</li><li><code>sizex</code>: size of the plane in the x-direction (before rotating to <code>normal</code>).</li><li><code>sizey</code>: size of the plane in the y-direction (before rotating to <code>normal</code>).</li><li><code>size</code>: set default value for <code>sizex</code> and <code>sizey</code>.</li><li><code>ngrid</code>: number of grid elements to split the plane up into for plotting.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/plot.jl#L207-L220">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Plot.plot_snapshot" href="#MCMRSimulator.Plot.plot_snapshot"><code>MCMRSimulator.Plot.plot_snapshot</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot([plot_plane], snapshot; kind=:scatter, kwargs...)
plot!([scene,] [plot_plane], snapshot; kind=:scatter, kwargs...)
plot_snapshot([plot_plane], snapshot; kind=:scatter, kwargs...)
plot_snapshot!([scene,] [plot_plane], snapshot; kind=:scatter, kwargs...)</code></pre><p>Plots a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> in a new plot. </p><p>The spins are plotted in 2D projected onto the <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a> if one is provided. Otherwise, the spins are plotted in 3D (does not work for <code>kind=:image</code>).</p><p>There are three kinds of snapshot plots available:</p><p><strong>Scatter plot</strong></p><p>Default (or set using <code>kind=:scatter</code>). Each spin is plotted as a point with the colour set by the transverse magnetisation. Additional keywords are passed on to <code>Makie.scatter</code> (namely, <code>marker</code>, <code>markersize</code>, <code>strokecolor</code>, <code>strokewidth</code>, <code>glowcolor</code>, <code>glowwidth</code>).</p><p><strong>Dyad plot</strong></p><p>Set using <code>kind=:dyad</code>. Each spin is plotted as a dyad. For a 2D dyad the orienation is set by the transverse magnetisation. For a 3D dyad the full magnetisation is used to set the orienation. Additional keywords are passed on to <code>Makie.arrows</code> (namely, <code>arrowsize</code>, <code>arrowhead</code>, <code>arrowtail</code>, <code>linestyle</code>, <code>lengthscale</code>, <code>quality</code>, <code>markerspace</code>, <code>diffuse</code>, <code>specular</code>, <code>shininess</code>).</p><p><strong>Image</strong></p><p>Set using <code>kind=:image</code>. The average magnetisation is plotted across the <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a>.  The colour in each pixel is set by the average transverse magnetisation of the local spins. Set <code>interpolate=false</code> to disable interpolating the colors. This plot will not work in 3D (i.e., a <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a> is required).</p><p>This function will only work if <a href="https://makie.org"><code>Makie</code></a> is installed and imported.</p><p>Base.Docs.DocStr(svec(&quot;### Generic attributes\n\n- <code>visible::Bool = true</code> sets whether the plot will be rendered or not.\n- <code>overdraw::Bool = false</code> sets whether the plot will draw over other plots. This specifically means ignoring depth checks in GL backends.\n- <code>transparency::Bool = false</code> adjusts how the plot deals with transparency. In GLMakie <code>transparency = true</code> results in using Order Independent Transparency.\n- <code>fxaa::Bool = true</code> adjusts whether the plot is rendered with fxaa (anti-aliasing).\n- <code>inspectable::Bool = true</code> sets whether this plot should be seen by <code>DataInspector</code>.\n- <code>depth_shift::Float32 = 0f0</code> adjusts the depth value of a plot after all other transformations, i.e. in clip space, where <code>0 &lt;= depth &lt;= 1</code>. This only applies to GLMakie and WGLMakie and can be used to adjust render order (like a tunable overdraw).\n- <code>model::Makie.Mat4f</code> sets a model matrix for the plot. This replaces adjustments made with <code>translate!</code>, <code>rotate!</code> and <code>scale!</code>.\n- <code>space::Symbol = :data</code> sets the transformation space for box encompassing the volume plot. See <code>Makie.spaces()</code> for possible inputs.\n- <code>clip_planes::Vector{Plane3f} = Plane3f[]</code>: allows you to specify up to 8 planes behind which plot objects get clipped (i.e. become invisible). By default clip planes are inherited from the parent plot or scene.\n&quot;), nothing, Dict{Symbol, Any}(:typesig =&gt; Tuple{Any}, :module =&gt; MakieCore, :linenumber =&gt; 4, :binding =&gt; MakieCore.generic<em>plot</em>attributes!, :path =&gt; &quot;/builds/ndcn0236/mcmrsimulator.jl/.julia/packages/MakieCore/zO6H4/src/basic_plots.jl&quot;))</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/plot.jl#L85-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Plot.plot_geometry" href="#MCMRSimulator.Plot.plot_geometry"><code>MCMRSimulator.Plot.plot_geometry</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot([plot_plane,] geometry; kwargs...)
plot!([scene,] [plot_plane,] geometry; kwargs...)
plot_geometry([plot_plane,] geometry; kwargs...)
plot_geometry!([scene,] [plot_plane,] geometry; kwargs...)</code></pre><p>Plots a given geometry.  If a <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a> is provided the 2D projection of the geometry onto this plane is plotted. Otherwise, the geometry is plotted in 3D.</p><p>If you want to overlay the off-resonance field, call <a href="#MCMRSimulator.Plot.plot_off_resonance"><code>plot_off_resonance</code></a> first before calling this function.</p><p>This function will only work if a <a href="https://makie.org"><code>Makie</code></a> backend is imported.</p><p><strong>Attributes</strong></p><ul><li><code>color</code>: Set the color of the lines (2D) or patches (3D). In 2D it is set to the theme&#39;s <code>linecolor</code> by default. In 3D each individual obstruction is by default plotted in a different, distinguishable color.</li><li><code>alpha</code>: Set the transparancy in a 3D plot (0 being fully transparent and 1 fully opague).</li><li><code>linewidth</code>: Set the linewidth in 2D plots.</li><li><code>linestyle</code>: Set the linestyle in 2D plots.</li></ul><p>Base.Docs.DocStr(svec(&quot;### 3D shading attributes\n\n- <code>shading = Makie.automatic</code> sets the lighting algorithm used. Options are <code>NoShading</code> (no lighting), <code>FastShading</code> (AmbientLight + PointLight) or <code>MultiLightShading</code> (Multiple lights, GLMakie only). Note that this does not affect RPRMakie.\n- <code>diffuse::Vec3f = Vec3f(1.0)</code> sets how strongly the red, green and blue channel react to diffuse (scattered) light.\n- <code>specular::Vec3f = Vec3f(0.4)</code> sets how strongly the object reflects light in the red, green and blue channels.\n- <code>shininess::Real = 32.0</code> sets how sharp the reflection is.\n- <code>backlight::Float32 = 0f0</code> sets a weight for secondary light calculation with inverted normals.\n- <code>ssao::Bool = false</code> adjusts whether the plot is rendered with ssao (screen space ambient occlusion). Note that this only makes sense in 3D plots and is only applicable with <code>fxaa = true</code>.\n&quot;), nothing, Dict{Symbol, Any}(:typesig =&gt; Tuple{Any}, :module =&gt; MakieCore, :linenumber =&gt; 150, :binding =&gt; MakieCore.shading<em>attributes!, :path =&gt; &quot;/builds/ndcn0236/mcmrsimulator.jl/.julia/packages/MakieCore/zO6H4/src/basic</em>plots.jl&quot;))</p><p>Base.Docs.DocStr(svec(&quot;### Generic attributes\n\n- <code>visible::Bool = true</code> sets whether the plot will be rendered or not.\n- <code>overdraw::Bool = false</code> sets whether the plot will draw over other plots. This specifically means ignoring depth checks in GL backends.\n- <code>transparency::Bool = false</code> adjusts how the plot deals with transparency. In GLMakie <code>transparency = true</code> results in using Order Independent Transparency.\n- <code>fxaa::Bool = true</code> adjusts whether the plot is rendered with fxaa (anti-aliasing).\n- <code>inspectable::Bool = true</code> sets whether this plot should be seen by <code>DataInspector</code>.\n- <code>depth_shift::Float32 = 0f0</code> adjusts the depth value of a plot after all other transformations, i.e. in clip space, where <code>0 &lt;= depth &lt;= 1</code>. This only applies to GLMakie and WGLMakie and can be used to adjust render order (like a tunable overdraw).\n- <code>model::Makie.Mat4f</code> sets a model matrix for the plot. This replaces adjustments made with <code>translate!</code>, <code>rotate!</code> and <code>scale!</code>.\n- <code>space::Symbol = :data</code> sets the transformation space for box encompassing the volume plot. See <code>Makie.spaces()</code> for possible inputs.\n- <code>clip_planes::Vector{Plane3f} = Plane3f[]</code>: allows you to specify up to 8 planes behind which plot objects get clipped (i.e. become invisible). By default clip planes are inherited from the parent plot or scene.\n&quot;), nothing, Dict{Symbol, Any}(:typesig =&gt; Tuple{Any}, :module =&gt; MakieCore, :linenumber =&gt; 4, :binding =&gt; MakieCore.generic<em>plot</em>attributes!, :path =&gt; &quot;/builds/ndcn0236/mcmrsimulator.jl/.julia/packages/MakieCore/zO6H4/src/basic_plots.jl&quot;))</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/plot.jl#L19-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Plot.plot_trajectory" href="#MCMRSimulator.Plot.plot_trajectory"><code>MCMRSimulator.Plot.plot_trajectory</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot([plot_plane], snapshots; kwargs...)
plot!([scene,] [plot_plane], snapshots; kwargs...)
plot_trajectory([plot_plane], snapshots; kwargs...)
plot_trajectory!([scene,] [plot_plane], snapshots; kwargs...)</code></pre><p>Plots the spin trajectory in a vector of <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> on an existing plot scene.</p><p>The spins are plotted in 2D projected onto the <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a> if one is provided. Otherwise, the spins are plotted in 3D. At each location along the trajectory, the colour is set by the transverse magnetisation. Additional keywords are passed on to <code>Makie.lines!</code>.</p><p>This function will only work if <a href="https://makie.org"><code>Makie</code></a> is installed and imported.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/plot.jl#L158-L172">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Plot.plot_off_resonance" href="#MCMRSimulator.Plot.plot_off_resonance"><code>MCMRSimulator.Plot.plot_off_resonance</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_off_resonance([plot_plane,] geometry; kwargs...)
plot_off_resonance!([scene,] [plot_plane,] geometry; kwargs...)</code></pre><p>Plots the off-resonance field generated by a given geometry.  If a <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a> is provided the 2D projection of the geometry onto this plane is plotted. Otherwise, the geometry is plotted in 3D.</p><p>This function will only work if a <a href="https://makie.org"><code>Makie</code></a> backend is imported.</p><p><strong>Attributes</strong></p><ul><li><code>ngrid=400</code> sets the number of points where the off-resonance field is evaluated before producing the image. Setting this to a higher number will produce a more accurate image of the off-resonance field at the cost of more computing power.</li></ul><p>Base.Docs.DocStr(svec(&quot;### Color attributes\n\n- <code>colormap::Union{Symbol, Vector{&lt;:Colorant}} = :viridis</code> sets the colormap that is sampled for numeric <code>color</code>s.\n  <code>PlotUtils.cgrad(...)</code>, <code>Makie.Reverse(any_colormap)</code> can be used as well, or any symbol from ColorBrewer or PlotUtils.\n  To see all available color gradients, you can call <code>Makie.available_gradients()</code>.\n- <code>colorscale::Function = identity</code> color transform function. Can be any function, but only works well together with <code>Colorbar</code> for <code>identity</code>, <code>log</code>, <code>log2</code>, <code>log10</code>, <code>sqrt</code>, <code>logit</code>, <code>Makie.pseudolog10</code> and <code>Makie.Symlog10</code>.\n- <code>colorrange::Tuple{&lt;:Real, &lt;:Real}</code> sets the values representing the start and end points of <code>colormap</code>.\n- <code>nan_color::Union{Symbol, &lt;:Colorant} = RGBAf(0,0,0,0)</code> sets a replacement color for <code>color = NaN</code>.\n- <code>lowclip::Union{Nothing, Symbol, &lt;:Colorant} = nothing</code> sets a color for any value below the colorrange.\n- <code>highclip::Union{Nothing, Symbol, &lt;:Colorant} = nothing</code> sets a color for any value above the colorrange.\n- <code>alpha = 1.0</code> sets the alpha value of the colormap or color attribute. Multiple alphas like in <code>plot(alpha=0.2, color=(:red, 0.5)</code>, will get multiplied.\n&quot;), nothing, Dict{Symbol, Any}(:typesig =&gt; Tuple{Any, Any}, :module =&gt; MakieCore, :linenumber =&gt; 89, :binding =&gt; MakieCore.colormap<em>attributes!, :path =&gt; &quot;/builds/ndcn0236/mcmrsimulator.jl/.julia/packages/MakieCore/zO6H4/src/basic</em>plots.jl&quot;))</p><p>Base.Docs.DocStr(svec(&quot;### Generic attributes\n\n- <code>visible::Bool = true</code> sets whether the plot will be rendered or not.\n- <code>overdraw::Bool = false</code> sets whether the plot will draw over other plots. This specifically means ignoring depth checks in GL backends.\n- <code>transparency::Bool = false</code> adjusts how the plot deals with transparency. In GLMakie <code>transparency = true</code> results in using Order Independent Transparency.\n- <code>fxaa::Bool = true</code> adjusts whether the plot is rendered with fxaa (anti-aliasing).\n- <code>inspectable::Bool = true</code> sets whether this plot should be seen by <code>DataInspector</code>.\n- <code>depth_shift::Float32 = 0f0</code> adjusts the depth value of a plot after all other transformations, i.e. in clip space, where <code>0 &lt;= depth &lt;= 1</code>. This only applies to GLMakie and WGLMakie and can be used to adjust render order (like a tunable overdraw).\n- <code>model::Makie.Mat4f</code> sets a model matrix for the plot. This replaces adjustments made with <code>translate!</code>, <code>rotate!</code> and <code>scale!</code>.\n- <code>space::Symbol = :data</code> sets the transformation space for box encompassing the volume plot. See <code>Makie.spaces()</code> for possible inputs.\n- <code>clip_planes::Vector{Plane3f} = Plane3f[]</code>: allows you to specify up to 8 planes behind which plot objects get clipped (i.e. become invisible). By default clip planes are inherited from the parent plot or scene.\n&quot;), nothing, Dict{Symbol, Any}(:typesig =&gt; Tuple{Any}, :module =&gt; MakieCore, :linenumber =&gt; 4, :binding =&gt; MakieCore.generic<em>plot</em>attributes!, :path =&gt; &quot;/builds/ndcn0236/mcmrsimulator.jl/.julia/packages/MakieCore/zO6H4/src/basic_plots.jl&quot;))</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/plot.jl#L57-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Plot.simulator_movie" href="#MCMRSimulator.Plot.simulator_movie"><code>MCMRSimulator.Plot.simulator_movie</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulator_movie(filename, simulation, times, size; resolution=(1600, 800), trajectory_init=30, signal_init=10000, framerate=50, plane_orientation=:z, kwargs...)</code></pre><p>Writes a movie of the <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> to the given <code>filename</code>.</p><p>Each frame of the movie shows the <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> at given <code>times</code>. <code>size</code> is a tuple with the size of the plotted region in the x- and y-direction. If there is a repeating geometry, then it is strongly recommended to use the size of the repeat for <code>size</code>.</p><p>Keyword arguments:</p><ul><li><code>resolution</code>: pixel resolution of each frame in the movie.</li><li><code>trajectory_init</code>: how many spins to plot on each frame.</li><li><code>signal_init</code>: how many spins to use to evaluate the signal evolution.</li><li><code>framerate</code>: wait time between each subsequent frame in the movie.</li><li><code>plane_orientation</code>: orienation of the plane on which the spins are projected (see <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a>).</li></ul><p>Additional keyword arguments are passed on to <a href="#MCMRSimulator.Plot.plot_snapshot"><code>plot_snapshot</code></a>.</p><p>This function will only work if <a href="https://makie.org"><code>Makie</code></a> is installed and imported.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/plot.jl#L184-L203">source</a></section></article><h2 id="Probing-MCMR-internals"><a class="docs-heading-anchor" href="#Probing-MCMR-internals">Probing MCMR internals</a><a id="Probing-MCMR-internals-1"></a><a class="docs-heading-anchor-permalink" href="#Probing-MCMR-internals" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Constants.gyromagnetic_ratio" href="#MCMRSimulator.Constants.gyromagnetic_ratio"><code>MCMRSimulator.Constants.gyromagnetic_ratio</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>gyromagnetic ratio of a proton (1H) in water in kHz/T</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/constants.jl#L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Methods.get_rotation" href="#MCMRSimulator.Methods.get_rotation"><code>MCMRSimulator.Methods.get_rotation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_rotation(rotation_mat, ndim)</code></pre><p>Returns a (3, <code>ndim</code>) rotation matrix, that is the relevant part of the full 3x3 <code>rotation_mat</code> to map to the x-axis (if <code>ndim</code> is 1) or the x-y plance (if <code>ndim</code> is 2). If <code>ndim</code> is 3, the full rotation matrix <code>rotation_mat</code> is returned.</p><pre><code class="nohighlight hljs">get_rotation(vector, ndim; reference_dimension)</code></pre><p>Returns the (3, <code>ndim</code>) rotation matrix mapping the <code>vector</code> to the <code>reference_dimension</code>. By default, the <code>reference_dimension is the x-direction (if</code>ndim<code>is 1 or 3) or the z-direction (if</code>ndim<code>is 2).</code>vector<code>and</code>reference_dimension` can be a length 3 array or one of the symbols :x, :y, or :z (representing vectors in those cardinal directions).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/methods.jl#L41-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.SequenceParts.get_readouts" href="#MCMRSimulator.SequenceParts.get_readouts"><code>MCMRSimulator.SequenceParts.get_readouts</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_readouts(sequence, start_time; readouts=nothing, nTR=1, skip_TR=0)</code></pre><p>Returns a iterator of the readouts (<a href="#MCMRSimulator.SequenceParts.IndexedReadout"><code>IndexedReadout</code></a> objects) that will be used for the given sequence in the simulator.</p><p>This can be used to identify which readouts will be (or have been) used in the simulation by running: <code>collect(get_readouts(sequence, snapshot.current_time; kwargs...))</code> where <code>snapshot</code> is the starting snapshot (which has a <code>current_time</code> of 0 by default) and <code>kwargs</code> are the keyword arguments used in <a href="#MCMRSimulator.Evolve.readout"><code>readout</code></a> (i.e., <code>readouts,</code>nTR<code>, and</code>skip_TR`).</p><p>By default the readout/ADC objects with the actual sequence definition are used. These can be overriden by <code>readouts</code>, which can be set to a vector of the timings of the readouts within each TR.</p><p><strong>Non-repeating sequences</strong></p><p>This is the behaviour if both <code>nTR</code> and <code>skip_TR</code> are not set by the user. Any readouts before the <code>start_time</code> are ignored. Any readouts after the <code>start_time</code> (whether from the <code>readouts</code> keyword or within the sequence definition) are returned.</p><p><strong>Repeating sequences</strong></p><p>This is the behaviour if either <code>nTR</code> or <code>skip_TR</code> or both are not set by the user. If at <code>start_time</code> any of the readouts in the current TR have already passed, then the readout will only start in the next TR (unless <code>skip_TR</code> is set to -1). We will skip an additional number of TRs given by <code>skip_TR</code> (default: 0). Then readouts will continue for the number of TRs given by <code>nTR</code> (default: 1).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/sequence_parts.jl#L398-L421">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.SequenceParts.IndexedReadout" href="#MCMRSimulator.SequenceParts.IndexedReadout"><code>MCMRSimulator.SequenceParts.IndexedReadout</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">IndexedReadout(time, TR, readout)</code></pre><p>Represents a readout in an MR sequence.</p><p>Generate these for a sequence of interest using <a href="#MCMRSimulator.SequenceParts.get_readouts"><code>get_readouts</code></a>.</p><p>All indices are integers. They refer to:</p><ul><li><code>time</code>: time since beginning of sequence in ms</li><li><code>TR</code>: which TR the simulation is in (defaults to 0 if not set).</li><li><code>readout</code>: which readout within the TR (or total sequence) this is.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/sequence_parts.jl#L113-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Grid.susceptibility_off_resonance" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid.susceptibility_off_resonance"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid.susceptibility_off_resonance</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">susceptibility_off_resonance(susceptibility_grid, position[, inside])</code></pre><p>Computes the susceptibility off-resonance caused by a <code>SusceptibilityGrid</code> at given position.</p><p>The field is computed in ppm. Knowledge of the scanner <code>B0</code> is needed to convert it into KHz.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/susceptibility/grid.jl#L129-L135">source</a></section><section><div><pre><code class="language-julia hljs">susceptibility_off_resonance(simulation, spin)</code></pre><p>Computes the susceptibility off-resonance caused by all susceptibility sources in the <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> affecting the <a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a></p><p>The field is computed in ppm. Knowledge of the scanner <code>B0</code> is needed to convert it into KHz.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/simulations.jl#L195-L201">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup" href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup"><code>MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Parent type of all geometry objects like <a href="#MCMRSimulator.Geometries.User.Obstructions.Cylinders"><code>Cylinders</code></a> or <a href="#MCMRSimulator.Geometries.User.Obstructions.Mesh"><code>Mesh</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstruction_groups.jl#L10-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.IndexedObstruction" href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.IndexedObstruction"><code>MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.IndexedObstruction</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A single instance of an <a href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup"><code>ObstructionGroup</code></a> obtained by indexing.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstruction_groups.jl#L28-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.nvolumes" href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.nvolumes"><code>MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.nvolumes</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nvolumes(group)</code></pre><p>For any <code>ObstructionType</code> with group_volumes, this computes the number of distinct volumes.</p><p>This is mainly used to compute the number of distinct components in a mesh.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstruction_groups.jl#L63-L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Fix.fix" href="#MCMRSimulator.Geometries.User.Fix.fix"><code>MCMRSimulator.Geometries.User.Fix.fix</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fix(user_geometry; permeability=0., density=0., dwell_time=0., relaxation=0.)</code></pre><p>Creates a fixed version of the user-created geometry that will be used internally by the simulator.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/fix.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.FixSusceptibility.fix_susceptibility" href="#MCMRSimulator.Geometries.User.FixSusceptibility.fix_susceptibility"><code>MCMRSimulator.Geometries.User.FixSusceptibility.fix_susceptibility</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fix_susceptibility(geometry)</code></pre><p>Create a new <code>FixedSusceptibility</code> based on the user-defined geometry settings.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/fix_susceptibility.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry" href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FixedGeometry([obstruction_groups...])</code></pre><p>A collection of <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup"><code>FixedObstructionGroup</code></a> objects each reperesenting part of the geometry.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/fixed_obstruction_groups.jl#L94-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup" href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup"><code>MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedObstructionGroup</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A fixed version of <a href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup"><code>ObstructionGroup</code></a> that is used internally within the simulator.</p><p>This is the main internal representation of a group of identical <code>FixedObstruction</code> objects.</p><p>Properties:</p><ul><li><code>obstructions</code>: vector of the actual <code>FixedObstruction</code> objects.</li><li><code>parent_index</code>: Index of this group within the larger <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>.</li><li><code>original_index</code>: Index of this group within the original user-provided geometry.</li><li><code>rotation</code>: rotation from global 3-dimensional space to the 1, 2, or 3-dimensional space of the obstructions.</li><li><code>inv_rotation</code>: inverse of the rotation above</li><li><code>grid</code>: <code>Grid</code> object on which the obstruction intersections have been precomputed. This speeds up the detection of intersections.</li><li><code>bounding_boxes</code>: vector of <a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox"><code>BoundingBox</code></a> objects for each obstruction. These are used to predect whether a spin could intersect with the obstruction.</li><li><code>volume</code>: R1, R2, and off-resonance properties of the spins inside the obstructions.</li><li><code>surface</code>: R1, R2, off-resonance, surface<em>density and dwell</em>time properties of particles stuck to the surface. Also, contains the permeability and surface relaxation to process collsions.</li><li><code>vertices</code>: vector of vertices (only used for a mesh).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/fixed_obstruction_groups.jl#L29-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Properties.surface_relaxation" href="#MCMRSimulator.Geometries.Internal.Properties.surface_relaxation"><code>MCMRSimulator.Geometries.Internal.Properties.surface_relaxation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">surface_relaxation(geometry, reflection)</code></pre><p>Returns the surface_relaxation experienced by the spin hitting the surface represented by a <code>Reflection</code>. The <code>geometry</code> has to be a <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/properties.jl#L81-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Properties.surface_density" href="#MCMRSimulator.Geometries.Internal.Properties.surface_density"><code>MCMRSimulator.Geometries.Internal.Properties.surface_density</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">surface_density(geometry, reflection)</code></pre><p>Returns the surface_density experienced by the spin hitting the surface represented by a <code>Reflection</code>. The <code>geometry</code> has to be a <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/properties.jl#L81-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Properties.dwell_time" href="#MCMRSimulator.Geometries.Internal.Properties.dwell_time"><code>MCMRSimulator.Geometries.Internal.Properties.dwell_time</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dwell_time(geometry, reflection)</code></pre><p>Returns the dwell_time experienced by the spin hitting the surface represented by a <code>Reflection</code>. The <code>geometry</code> has to be a <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/properties.jl#L81-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Properties.permeability" href="#MCMRSimulator.Geometries.Internal.Properties.permeability"><code>MCMRSimulator.Geometries.Internal.Properties.permeability</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">permeability(geometry, reflection)</code></pre><p>Returns the permeability experienced by the spin hitting the surface represented by a <code>Reflection</code>. The <code>geometry</code> has to be a <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/properties.jl#L81-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Properties.GlobalProperties" href="#MCMRSimulator.Properties.GlobalProperties"><code>MCMRSimulator.Properties.GlobalProperties</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GlobalProperties(; R1=0, R2=0, off_resonance=0)</code></pre><p>Stores global MRI and collision properties.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/properties.jl#L17-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Properties.R1" href="#MCMRSimulator.Properties.R1"><code>MCMRSimulator.Properties.R1</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">R1(snapshot, geometry, global_properties)
R1(spins, geometry, global_properties)
R1(positions, geometry, global_properties)</code></pre><p>Returns the R1 experienced by the <a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a> objects given the surface and volume properties of the <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>. Alternatively, the <code>position</code> of the spins can be provided. In that case the spins will be presumed to be free.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L385-L392">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Properties.R2" href="#MCMRSimulator.Properties.R2"><code>MCMRSimulator.Properties.R2</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">R2(snapshot, geometry, global_properties)
R2(spins, geometry, global_properties)
R2(positions, geometry, global_properties)</code></pre><p>Returns the R2 experienced by the <a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a> objects given the surface and volume properties of the <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>. Alternatively, the <code>position</code> of the spins can be provided. In that case the spins will be presumed to be free.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L385-L392">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Properties.off_resonance" href="#MCMRSimulator.Properties.off_resonance"><code>MCMRSimulator.Properties.off_resonance</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">off_resonance(snapshot, geometry, global_properties)
off_resonance(spin(s), geometry, global_properties)
off_resonance(position(s), geometry, global_properties)</code></pre><p>Computes the off-resonance field experienced by each spin in the <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a>.</p><p>A tuple is returned with:</p><ol><li>the off-resonance field due to susceptibility sources in ppm (e.g., myelin/iron).</li><li>the off-resonance field due to other sources in kHz (i.e., <code>off_resonance=...</code> set by the user).</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L416-L426">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.install_cli" href="#MCMRSimulator.CLI.install_cli"><code>MCMRSimulator.CLI.install_cli</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">install_cli()</code></pre><p>Installs the command line interface for </p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/cli/cli.jl#L18-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.run_main" href="#MCMRSimulator.CLI.run_main"><code>MCMRSimulator.CLI.run_main</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_main(args=ARGS; kwargs...)</code></pre><p>Main run command for the command line interface.</p><p>Any keyword arguments are passed on to <code>ArgParse.ArgParseSettings</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/cli/cli.jl#L77-L83">source</a></section></article><h2 id="Internal-modules"><a class="docs-heading-anchor" href="#Internal-modules">Internal modules</a><a id="Internal-modules-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-modules" title="Permalink"></a></h2><p>The internals of these sub-modules are considered private and might change at any time.</p><p>Each of these modules corresponds to a file in the gitlab repository</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.MCMRSimulator" href="#MCMRSimulator.MCMRSimulator"><code>MCMRSimulator.MCMRSimulator</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>This package supports the running of MR Monte Carlo simulations.</p><p>In these simulations hundreds of thousands or millions of <a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a> particles randomly diffuse through some tissue microstructure. At each timepoint these spins are represented as a <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> object. The spin diffusion is constrained by an <a href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup"><code>ObstructionGroup</code></a> (represented internally as <a href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups.FixedGeometry"><code>FixedGeometry</code></a>) The spins of these particles will be evolved based on the Bloch equations with the field strength and relaxation rates set by the local geometry and the effect of one or more <code>MRIBuilder.Sequence</code> objects. All these variables are combined into a single <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> object.  See <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> for how to run the simulation.</p><p>Plotting support for the sequence and resulting signal is also available based on <a href="https://makie.juliaplots.org/stable/">Makie.jl</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/MCMRSimulator.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Constants" href="#MCMRSimulator.Constants"><code>MCMRSimulator.Constants</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines biophysical constants used in simulator.</p><ul><li><code>gyromagnetic_ratio</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/constants.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Methods" href="#MCMRSimulator.Methods"><code>MCMRSimulator.Methods</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines methods shared across multiple sub-modules.</p><ul><li><a href="#MCMRSimulator.Methods.get_time"><code>get_time</code></a></li><li><code>norm_angle</code></li><li><a href="#MCMRSimulator.Methods.get_rotation"><code>MCMRSimulator.get_rotation</code></a></li><li><code>off_resonance</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/methods.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Spins" href="#MCMRSimulator.Spins"><code>MCMRSimulator.Spins</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Types:</p><ul><li><a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a></li><li><a href="#MCMRSimulator.Spins.Spin"><code>Spin</code></a></li><li><a href="#MCMRSimulator.Spins.SpinOrientation"><code>SpinOrientation</code></a></li><li><code>FixedXoshiro</code></li></ul><p>Methods:</p><ul><li><a href="#MCMRSimulator.Spins.longitudinal"><code>longitudinal</code></a></li><li><a href="#MCMRSimulator.Spins.transverse"><code>transverse</code></a></li><li><a href="#MCMRSimulator.Spins.phase"><code>phase</code></a></li><li><a href="#MCMRSimulator.Spins.orientation"><code>orientation</code></a></li><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside"><code>isinside</code></a></li><li><a href="#MCMRSimulator.Spins.stuck"><code>stuck</code></a></li><li><a href="#MCMRSimulator.Spins.stuck_to"><code>stuck_to</code></a></li><li><a href="#MCMRSimulator.Spins.get_sequence"><code>get_sequence</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/spins.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Evolve" href="#MCMRSimulator.Evolve"><code>MCMRSimulator.Evolve</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the functions that run the actual simulation:</p><ul><li><a href="#MCMRSimulator.Evolve.readout"><code>readout</code></a>: get total signal or <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> at any <code>MRIBuilder.ADC</code> objects in the sequences.</li><li><a href="#MCMRSimulator.Evolve.evolve"><code>evolve</code></a>: Return a single <a href="#MCMRSimulator.Spins.Snapshot"><code>Snapshot</code></a> with the state of the simulation at a given time. This snapshot can be used as initialisation for further runs.</li></ul><p>All of these functions call <code>evolve_to_time</code> under the hood to actually run the simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/evolve.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Relax" href="#MCMRSimulator.Relax"><code>MCMRSimulator.Relax</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Implements the Bloch equations to model the spin magnetisation under influence of a sequence during a single timestep.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/relax.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Properties" href="#MCMRSimulator.Properties"><code>MCMRSimulator.Properties</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Basic interface for setting the simulation properties</p><p>For the main interface see <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a>.</p><p>Types:</p><ul><li><a href="#MCMRSimulator.Properties.GlobalProperties"><code>MCMRSimulator.GlobalProperties</code></a></li></ul><p>Methods:</p><ul><li><code>R1</code></li><li><code>R2</code></li><li><code>off_resonance</code></li><li><code>stick_probability</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/properties.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Plot" href="#MCMRSimulator.Plot"><code>MCMRSimulator.Plot</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>This module contains the base plotting functions.</p><p>If <a href="https://makie.org"><code>Makie</code></a> is not installed, none of the plotting functions will work. If a Makie backend is installed and importend, concrete methods will be added to these functions by the MakieMCMRSimulator extension. This makes Makie an optional dependency of MCMRSimulator, which will only be required if you want to use the MCMRSimulator plotting capabilities.</p><p>In addition to these empty plotting functions, this module defines the <a href="#MCMRSimulator.Plot.PlotPlane"><code>PlotPlane</code></a> for any 2D-projections and helper functions to project onto this plane.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/plot.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Subsets" href="#MCMRSimulator.Subsets"><code>MCMRSimulator.Subsets</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Support for selecting a subset of the total signal.</p><p>Types:</p><ul><li><a href="#MCMRSimulator.Subsets.Subset"><code>Subset</code></a></li></ul><p>Functions:</p><ul><li><a href="#MCMRSimulator.Subsets.get_subset"><code>get_subset</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/subsets.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.SequenceParts" href="#MCMRSimulator.SequenceParts"><code>MCMRSimulator.SequenceParts</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Breaks up one or more <code>MRIBuilder.Sequence</code> objects into individual timesteps.</p><p>The main interface is by calling <code>iter_parts</code>, which will result into a vector of some subtypes of <code>SequencePart</code>.</p><p>To just get the readouts call <a href="#MCMRSimulator.SequenceParts.get_readouts"><code>MCMRSimulator.get_readouts</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/sequence_parts.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Simulations" href="#MCMRSimulator.Simulations"><code>MCMRSimulator.Simulations</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the main <a href="#MCMRSimulator.Simulations.Simulation"><code>Simulation</code></a> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/simulations.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.TimeSteps" href="#MCMRSimulator.TimeSteps"><code>MCMRSimulator.TimeSteps</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the main interface to set the <a href="#MCMRSimulator.TimeSteps.TimeStep"><code>TimeStep</code></a> of the simulator.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/timesteps.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI" href="#MCMRSimulator.CLI"><code>MCMRSimulator.CLI</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the command line interface to MCMRSimulator.jl (<code>mcmr</code>).</p><p>Functions:</p><ul><li><a href="#MCMRSimulator.CLI.run_main"><code>MCMRSimulator.run_main</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/cli/cli.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.Geometry" href="#MCMRSimulator.CLI.Geometry"><code>MCMRSimulator.CLI.Geometry</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines command line interface for <code>mcmr geometry</code></p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/cli/geometry.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.CLI.Run" href="#MCMRSimulator.CLI.Run"><code>MCMRSimulator.CLI.Run</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the command line interface to <code>mcmr run</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/cli/run.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries" href="#MCMRSimulator.Geometries"><code>MCMRSimulator.Geometries</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the microstructural environment with which the spins interact.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/geometries.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User" href="#MCMRSimulator.Geometries.User"><code>MCMRSimulator.Geometries.User</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>User interface for defining geometry.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/user.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions" href="#MCMRSimulator.Geometries.User.Obstructions"><code>MCMRSimulator.Geometries.User.Obstructions</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the types and main methods for user-defined geometries.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstructions.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.Fields" href="#MCMRSimulator.Geometries.User.Obstructions.Fields"><code>MCMRSimulator.Geometries.User.Obstructions.Fields</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines a flexible <code>Field</code> interface to set the properties of user-defined geometries.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/fields.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes" href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes"><code>MCMRSimulator.Geometries.User.Obstructions.ObstructionTypes</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the properties of a certain geometry type.</p><p>Types:</p><ul><li><code>ObstructionType</code></li></ul><p>Functions:</p><ul><li><code>fields</code></li><li><code>key_value_pairs</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstruction_types.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups" href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups"><code>MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines <code>ObstructionGroup</code>, which is the parent type of all user-defined geometries.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/obstructions/obstruction_groups.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.RandomDistribution" href="#MCMRSimulator.Geometries.User.RandomDistribution"><code>MCMRSimulator.Geometries.User.RandomDistribution</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines <a href="#MCMRSimulator.Geometries.User.RandomDistribution.random_positions_radii"><code>random_positions_radii</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/random_distribution.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.Fix" href="#MCMRSimulator.Geometries.User.Fix"><code>MCMRSimulator.Geometries.User.Fix</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines <a href="#MCMRSimulator.Geometries.User.Fix.fix"><code>MCMRSimulator.fix</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/fix.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.SizeScales" href="#MCMRSimulator.Geometries.User.SizeScales"><code>MCMRSimulator.Geometries.User.SizeScales</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Computes a default value for the size scale of different geometries used for timestep calculations.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/size_scales.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.FixSusceptibility" href="#MCMRSimulator.Geometries.User.FixSusceptibility"><code>MCMRSimulator.Geometries.User.FixSusceptibility</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines <a href="#MCMRSimulator.Geometries.User.FixSusceptibility.fix_susceptibility"><code>MCMRSimulator.fix_susceptibility</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/fix_susceptibility.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.LoadMesh" href="#MCMRSimulator.Geometries.User.LoadMesh"><code>MCMRSimulator.Geometries.User.LoadMesh</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines <a href="#MCMRSimulator.Geometries.User.LoadMesh.load_mesh"><code>load_mesh</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/load_mesh.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.JSON" href="#MCMRSimulator.Geometries.User.JSON"><code>MCMRSimulator.Geometries.User.JSON</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Supports I/O to and from json</p><p>Functions:</p><ul><li><code>write_geometry</code></li><li><code>read_geometry</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/json.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.ToMesh" href="#MCMRSimulator.Geometries.User.ToMesh"><code>MCMRSimulator.Geometries.User.ToMesh</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Methods that extend the <a href="#MCMRSimulator.Geometries.User.Obstructions.Mesh"><code>Mesh</code></a> constructor to convert different types into meshes.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/to_mesh.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.User.SplitMesh" href="#MCMRSimulator.Geometries.User.SplitMesh"><code>MCMRSimulator.Geometries.User.SplitMesh</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Mesh-specific operations to normalise (i.e., ensure normals point outwards) and split a mesh.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/user/split_mesh.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal" href="#MCMRSimulator.Geometries.Internal"><code>MCMRSimulator.Geometries.Internal</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Internal representation of the tissue geometry.</p><p>All objects are immutable and optimised for both memory usage and computational speed.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/internal.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Properties" href="#MCMRSimulator.Geometries.Internal.Properties"><code>MCMRSimulator.Geometries.Internal.Properties</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Methods to extract properties from the <code>FixedGeometry</code>.</p><p>MRI properties (using <code>MRIProperties</code>):</p><ul><li><code>R1</code></li><li><code>R2</code></li><li><code>off_resonance</code></li></ul><p>Collision properties:</p><ul><li><code>permeability</code></li><li><code>surface_relaxation</code></li><li><code>surface_density</code></li><li><code>dwell_time</code></li></ul><p>Other functions:</p><ul><li><code>max_timestep_sticking</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/properties.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.RayGridIntersection" href="#MCMRSimulator.Geometries.Internal.RayGridIntersection"><code>MCMRSimulator.Geometries.Internal.RayGridIntersection</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines <code>ray_grid_intersections</code>, which computes the intersections between a spin path and some grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/ray_grid_intersection.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.BoundingBoxes" href="#MCMRSimulator.Geometries.Internal.BoundingBoxes"><code>MCMRSimulator.Geometries.Internal.BoundingBoxes</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the bounding box and its interface.</p><p>Types:</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.BoundingBox"><code>BoundingBox</code></a>: N-dimensional box fully containing an obstruction.</li></ul><p>Functions</p><ul><li><a href="#MCMRSimulator.Geometries.Internal.BoundingBoxes.isinside"><code>MCMRSimulator.isinside</code></a>: returns whether point/spin is inside a bounding box (or other obstruction)</li><li><code>could_intersect</code>: returns whether spin trajectory could intersect with obstruction in bounding box</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/bounding_boxes.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Intersections" href="#MCMRSimulator.Geometries.Internal.Intersections"><code>MCMRSimulator.Geometries.Internal.Intersections</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the <code>Intersection</code> between a spin path and the geometry.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/intersections.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions" href="#MCMRSimulator.Geometries.Internal.Obstructions"><code>MCMRSimulator.Geometries.Internal.Obstructions</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines all the base obstructions supported by MCMRSimulator.</p><p>They are all sub-types of <code>FixedObstruction</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/obstructions/obstructions.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions" href="#MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions"><code>MCMRSimulator.Geometries.Internal.Obstructions.FixedObstructions</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Base types for the API with individually fixed obstructions.</p><p>Types:</p><ul><li><code>FixedObstruction</code></li></ul><p>Methods:</p><ul><li><code>detect_intersection</code></li><li><code>has_inside</code></li><li><code>isinside</code></li><li><code>radius</code></li><li><code>BoundingBox</code></li><li><code>obstruction_type</code></li><li><code>random_surface_positions</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/obstructions/fixed_obstructions.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections" href="#MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections"><code>MCMRSimulator.Geometries.Internal.Obstructions.ObstructionIntersections</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the intersection between a spin path and an obstruction.</p><p>Types:</p><ul><li><code>ObstructionIntersection</code></li></ul><p>Attributes:</p><ul><li><code>empty_obstruction_intersections</code></li></ul><p>Methods:</p><ul><li><code>has_intersection</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/obstructions/obstruction_intersections.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.Rounds" href="#MCMRSimulator.Geometries.Internal.Obstructions.Rounds"><code>MCMRSimulator.Geometries.Internal.Obstructions.Rounds</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines cylinders and spheres and how to intersect with them.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/obstructions/rounds.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.Shifts" href="#MCMRSimulator.Geometries.Internal.Obstructions.Shifts"><code>MCMRSimulator.Geometries.Internal.Obstructions.Shifts</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>All base obstructions are assumed to be centered on the origin (except for triangles in the mesh).</p><p>This module defines the <code>Shift</code> from this origin to the actual position in space.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/obstructions/shifts.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.Triangles" href="#MCMRSimulator.Geometries.Internal.Obstructions.Triangles"><code>MCMRSimulator.Geometries.Internal.Obstructions.Triangles</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Triangle within a mesh and how to intersect with them.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/obstructions/triangles.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Obstructions.Walls" href="#MCMRSimulator.Geometries.Internal.Obstructions.Walls"><code>MCMRSimulator.Geometries.Internal.Obstructions.Walls</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Infinite walls and how to intersect with them.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/obstructions/walls.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.FixedObstructionGroups" href="#MCMRSimulator.Geometries.Internal.FixedObstructionGroups"><code>MCMRSimulator.Geometries.Internal.FixedObstructionGroups</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines the fixed versions of <a href="#MCMRSimulator.Geometries.User.Obstructions.ObstructionGroups.ObstructionGroup"><code>MCMRSimulator.ObstructionGroup</code></a> and its methods (including intersection detection).</p><p>Types:</p><ul><li><code>MCMRSimulator.FixedGeometry</code></li><li><code>MCMRSimulator.FixedObstructionGroup</code></li></ul><p>Methods:</p><ul><li><code>has_inside</code></li><li><code>isinside</code></li><li><code>detect_intersection</code></li><li><code>size_scale</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/fixed_obstruction_groups.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Reflections" href="#MCMRSimulator.Geometries.Internal.Reflections"><code>MCMRSimulator.Geometries.Internal.Reflections</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Computes the reflection of the spin off some geometry.</p><p>This is also used internally to represent a bound spin.</p><p>Types:</p><ul><li><code>Reflection</code></li></ul><p>Methods:</p><ul><li><code>direction</code></li><li><code>has_hit</code></li><li><code>previous_hit</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/reflections.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility" href="#MCMRSimulator.Geometries.Internal.Susceptibility"><code>MCMRSimulator.Geometries.Internal.Susceptibility</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Base module for computing the off-resonance field from magnetic susceptibility sources.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/susceptibility/susceptibility.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Base" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Base"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Base</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines parent type and functions for all magnetic susceptibility sources.</p><p>Types:</p><ul><li><code>BaseSusceptibility</code></li></ul><p>Functions:</p><ul><li><code>single_susceptibility</code></li><li><code>single_susceptibility_gradient</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/susceptibility/base.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Cylinder" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Cylinder"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Cylinder</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Off-resonance field due to magnetic susceptibility of an hollow cylinder, which is approximated as being infinitely thin.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/susceptibility/cylinder.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Triangle" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Triangle"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Triangle</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Computes the off-resonance field produced by a triangular mesh.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/susceptibility/triangle.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Annulus" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Annulus"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Annulus</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Off-resonance field due to magnetic susceptibility of an hollow cylinder.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/susceptibility/annulus.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.Susceptibility.Grid" href="#MCMRSimulator.Geometries.Internal.Susceptibility.Grid"><code>MCMRSimulator.Geometries.Internal.Susceptibility.Grid</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines how to compute the off-resonance field for distant magnetic susceptibility sources.</p><p>The contribution from very distant sources are pre-computed on a <code>SusceptibilityGrid</code>. Intermediate sources are represented as point magnetic susceptibility elements (<code>SusceptibilityGridElement</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/susceptibility/grid.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MCMRSimulator.Geometries.Internal.HitGrids" href="#MCMRSimulator.Geometries.Internal.HitGrids"><code>MCMRSimulator.Geometries.Internal.HitGrids</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines a <code>HitGrid</code> used to precompute the locations of each obstruction within a grid.</p><p>This helps limit the number of intersection calculations required for each spin movement.</p></div><a class="docs-sourcelink" target="_blank" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/fc0578c5d29ef10a58724143e470c3caa1287725/src/geometries/internal/hit_grids.jl#L1-L5">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../properties/">« MRI/collision properties</a><a class="docs-footer-nextpage" href="../references/">References »</a><div class="flexbox-break"></div></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 27 November 2024 17:17">Wednesday 27 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

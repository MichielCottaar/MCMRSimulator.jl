<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Geometry · MCMRSimulator.jl</title><meta name="title" content="Geometry · MCMRSimulator.jl"/><meta property="og:title" content="Geometry · MCMRSimulator.jl"/><meta property="twitter:title" content="Geometry · MCMRSimulator.jl"/><meta name="description" content="Documentation for MCMRSimulator.jl: a Monte Carlo MRI simulator in Julia"/><meta property="og:description" content="Documentation for MCMRSimulator.jl: a Monte Carlo MRI simulator in Julia"/><meta property="twitter:description" content="Documentation for MCMRSimulator.jl: a Monte Carlo MRI simulator in Julia"/><meta property="og:url" content="https://open.win.ox.ac.uk/pages/ndcn0236/mcmrsimulator.jl/stable/geometry/"/><meta property="twitter:url" content="https://open.win.ox.ac.uk/pages/ndcn0236/mcmrsimulator.jl/stable/geometry/"/><link rel="canonical" href="https://open.win.ox.ac.uk/pages/ndcn0236/mcmrsimulator.jl/stable/geometry/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MCMRSimulator.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../tutorial_julia/">Tutorial (Julia)</a></li><li><a class="tocitem" href="../tutorial_cli/">Tutorial (CLI)</a></li><li class="is-active"><a class="tocitem" href>Geometry</a></li><li><a class="tocitem" href="../properties/">MRI/collision properties</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Geometry</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Geometry</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl" title="View the repository"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">Repository</span></a><a class="docs-navbar-link" href="https://git.fmrib.ox.ac.uk/ndcn0236/MCMRSimulator.jl/-/tree/main/docs/src/geometry.md" title="Edit source"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="geometry"><a class="docs-heading-anchor" href="#geometry">Obstructions to free diffusion</a><a id="geometry-1"></a><a class="docs-heading-anchor-permalink" href="#geometry" title="Permalink"></a></h1><p>MCMRSimulator.jl comes with a variety of basic components that can be used to represent various components in the tissue microstructure.</p><table><tr><th style="text-align: right">Component:</th><th style="text-align: right">infinite walls</th><th style="text-align: right">hollow cylinder</th><th style="text-align: right">myelinated annuli</th><th style="text-align: right">hollow sphere</th><th style="text-align: right">mesh</th><th style="text-align: right">bendy cylinder</th></tr><tr><td style="text-align: right">Constructor (Julia)</td><td style="text-align: right"><a href="../api/#MCMRSimulator.Geometries.User.Obstructions.Walls"><code>Walls</code></a></td><td style="text-align: right"><a href="../api/#MCMRSimulator.Geometries.User.Obstructions.Cylinders"><code>Cylinders</code></a></td><td style="text-align: right"><a href="../api/#MCMRSimulator.Geometries.User.Obstructions.Annuli"><code>Annuli</code></a></td><td style="text-align: right"><a href="../api/#MCMRSimulator.Geometries.User.Obstructions.Spheres"><code>Spheres</code></a></td><td style="text-align: right"><a href="../api/#MCMRSimulator.Geometries.User.Obstructions.Mesh"><code>Mesh</code></a></td><td style="text-align: right"><a href="../api/#MCMRSimulator.Geometries.User.Obstructions.BendyCylinder"><code>BendyCylinder</code></a></td></tr><tr><td style="text-align: right">Constructor (CLI)</td><td style="text-align: right"><code>mcmr geometry create walls</code></td><td style="text-align: right"><code>mcmr geometry create cylinders</code> or <code>mcmr geometry create-random cylinders</code></td><td style="text-align: right"><code>mcmr geometry create annuli</code> or <code>mcmr geometry create-random annuli</code></td><td style="text-align: right"><code>mcmr geometry create spheres</code> or <code>mcmr geometry create-random spheres</code></td><td style="text-align: right">Generate mesh from tissue samples or generative models (e.g., (<a href="../references/#palomboGenerativeModelRealistic2019">Palombo <em>et al.</em>, 2019</a>), (<a href="../references/#Ginsburger_2019">Ginsburger <em>et al.</em>, 2019</a>), (<a href="../references/#Callaghan_2020">Callaghan <em>et al.</em>, 2020</a>), (<a href="../references/#villarreal-haroCACTUSComputationalFramework2023">Villarreal-Haro <em>et al.</em>, 2023</a>))</td><td style="text-align: right"><code>mcmr geometry create bendy-cylinder</code></td></tr><tr><td style="text-align: right">Hinder diffusion</td><td style="text-align: right">✅</td><td style="text-align: right">✅</td><td style="text-align: right"></td><td style="text-align: right">✅</td><td style="text-align: right">✅</td><td style="text-align: right">✅</td></tr><tr><td style="text-align: right">Surface relaxation</td><td style="text-align: right">✅</td><td style="text-align: right">✅</td><td style="text-align: right"></td><td style="text-align: right">✅</td><td style="text-align: right">✅</td><td style="text-align: right">✅</td></tr><tr><td style="text-align: right">Magnetisation transfer</td><td style="text-align: right">✅</td><td style="text-align: right">✅</td><td style="text-align: right"></td><td style="text-align: right">✅</td><td style="text-align: right">✅</td><td style="text-align: right">✅</td></tr><tr><td style="text-align: right">Generate off-resonance field</td><td style="text-align: right"></td><td style="text-align: right">✅</td><td style="text-align: right">✅</td><td style="text-align: right"></td><td style="text-align: right">✅</td><td style="text-align: right">✅</td></tr><tr><td style="text-align: right">Different relaxation inside</td><td style="text-align: right"></td><td style="text-align: right">✅</td><td style="text-align: right">✅</td><td style="text-align: right">✅</td><td style="text-align: right">✅</td><td style="text-align: right">✅</td></tr><tr><td style="text-align: right">Intrinsic dimensionality</td><td style="text-align: right">1</td><td style="text-align: right">2</td><td style="text-align: right">2</td><td style="text-align: right">3</td><td style="text-align: right">3</td><td style="text-align: right">3</td></tr></table><p>The constructors for these components all have a similar interface. Some expect certain component-specific keyword arguments (e.g., radius for <a href="../api/#MCMRSimulator.Geometries.User.Obstructions.Spheres"><code>Spheres</code></a> and <a href="../api/#MCMRSimulator.Geometries.User.Obstructions.Cylinders"><code>Cylinders</code></a>, or the keywords regarding the myelin-induced off-resonance field produced by <a href="../api/#MCMRSimulator.Geometries.User.Obstructions.Cylinders"><code>Cylinders</code></a> or <a href="../api/#MCMRSimulator.Geometries.User.Obstructions.Annuli"><code>Annuli</code></a>). MRI relaxation properties within the obstruction and collision parameters (stuck spins, magnetisation transfer rate &amp; permeability) can be set using keyword arguments as described in the <a href="../properties/#properties">properties section</a>. Finally, these constructors expect a set of keyword arguments that control their location. These arguments are identicaly across all constructors (although the expected input depends on the dimensionality of the component as listed in the table above):</p><ul><li><code>position</code>: Set the positions for each generated components (not used in <a href="../api/#MCMRSimulator.Geometries.User.Obstructions.Mesh"><code>Mesh</code></a>).</li><li><code>repeats</code>: Set the distance with which all components should be repeated.</li><li><code>rotation</code>: Applies a single rotation to the whole system.</li></ul><p>Components with a lower dimensionality are defined by default along the x-axis (for dimensionality of 1) or the x-y plane (for dimensionality of 2).  In other words, the normal of the <a href="../api/#MCMRSimulator.Geometries.User.Obstructions.Walls"><code>Walls</code></a> point in the x-axis by default, while the <a href="../api/#MCMRSimulator.Geometries.User.Obstructions.Cylinders"><code>Cylinders</code></a> point in the z-axis. Shifts and repeats should only be provided in this lower-dimensional space. The <code>rotation</code> keyword can be used to define these components along other lines/planes (see <a href="../api/#MCMRSimulator.Methods.get_rotation"><code>MCMRSimulator.get_rotation</code></a>).</p><p>From the command line all of these keywords are available as flags, which can be seen by running:</p><pre><code class="language-bash hljs">mcmr geometry create walls/cylinders/annuli/spheres/bendy_cylinder --help</code></pre><p>In Julia, the easiest way to get the documentation for all keywords is to run:</p><pre><code class="nohighlight hljs">?Walls/Cylinders/Annuli/Spheres/Mesh/BendyCylinder</code></pre><p>or by following the links in the table above.</p><p>For example, we can create two base cylinders, which repeat infinitely by running:</p><pre><code class="language-julia hljs">using MCMRSimulator
geometry = Cylinders(radius=sqrt(0.5), position=[[0, 0], [1, 1]], repeats=[2, 2])</code></pre><p><img src="../regular_cylinders.png" alt="Plot showing two cylinders repeating ad infinitum"/></p><p>Alternatively, the same configuration could be produced with a single cylinder by providing a <code>rotation</code>.</p><pre><code class="language-julia hljs">using MCMRSimulator
rotation = [
    sqrt(0.5) sqrt(0.5) 0.
    -sqrt(0.5) sqrt(0.5) 0.
    0. 0. 1.
    ]
geometry = Cylinders(radius=sqrt(0.5), repeats=[sqrt(2), sqrt(2)], rotation=rotation)</code></pre><p><img src="../regular_cylinders2.png" alt="Plot showing single cylinders repeating ad infinitum"/></p><h3 id="Randomly-distributed-cylinders/annuli/spirals"><a class="docs-heading-anchor" href="#Randomly-distributed-cylinders/annuli/spirals">Randomly distributed cylinders/annuli/spirals</a><a id="Randomly-distributed-cylinders/annuli/spirals-1"></a><a class="docs-heading-anchor-permalink" href="#Randomly-distributed-cylinders/annuli/spirals" title="Permalink"></a></h3><p>A random set of positions and radii can be created using <a href="../api/#MCMRSimulator.Geometries.User.RandomDistribution.random_positions_radii"><code>random_positions_radii</code></a>. The user in this case sets a target density (70% in the example below) and over which length scale the configuration should repeat itself (20x20 micrometer in the example below).</p><pre><code class="language-julia hljs">(positions, outer_radii) = random_positions_radii((20, 20), 0.7, 2)</code></pre><p>From the command line this functionality is available by running <code>mcmr geometry create-random cylinders/annuli/spheres</code>.</p><p>These can be used to produce randomly distributed cylinders:</p><pre><code class="language-julia hljs">geometry = Cylinders(radius=outer_radii, position=positions, repeats=(20, 20))</code></pre><p><img src="../random_cylinders.png" alt="Illustrating configuration of random cylinders"/></p><p>When used as initialisation for annuli or spirals, an inner radius will also need to be computed:</p><pre><code class="language-julia hljs">geometry = Annuli(inner=0.8 .* outer_radii, outer=outer_radii, position=positions, repeats=(20, 20))</code></pre><p><img src="../random_annuli.png" alt="Illustrating configuration of random annuli"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial_cli/">« Tutorial (CLI)</a><a class="docs-footer-nextpage" href="../properties/">MRI/collision properties »</a><div class="flexbox-break"></div></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 15 November 2024 12:31">Friday 15 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
